import{c as A,r,u as Ps,j as e,a as je,P as J,b as Y,d as Ts,e as P,f as Ne,g as q,h as Es,X as ae,W as $s}from"./index-CK72GwF3.js";import{u as Is,a as Rs,c as ye,R as Ms,I as Ls,b as be,d as Fs,T as Os,P as zs,W as Vs,C as Gs,e as Us,D as Bs,f as we,O as qs,g as ue,h as re,i as Hs,j as Ce,k as ke,l as Se,m as _e,n as De,o as Ws}from"./dialog-BLK7SoRc.js";import{S as E,d as Ae,E as Q,C as L,e as F,g as O,h as H,a as z,L as R,I as M,B as b,i as Pe,j as Te,k as Ys,l as Zs,T as ne,u as Ks,m as Xs,n as Js,s as Qs,o as ea,t as me,p as xe,R as sa,q as aa,r as ta,v as pe,w as ra}from"./partnerApi-AZjBTfu_.js";import{C as Z}from"./check-Cdai882B.js";const na=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ia=A("circle-alert",na);const la=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],oa=A("circle-check",la);const ca=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],da=A("file-up",ca);const ua=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],ma=A("file",ua);const xa=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],pa=A("grip-vertical",xa);const ha=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],ga=A("list-ordered",ha);const fa=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],va=A("package",fa);const ja=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Na=A("rotate-ccw",ja);const ya=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ee=A("save",ya);const ba=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],$e=A("search",ba);const wa=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ca=A("square-check-big",wa);const ka=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Sa=A("square",ka);const _a=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ie=A("upload",_a);const Da=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],te=A("users",Da);var ee="Tabs",[Aa]=je(ee,[ye]),Re=ye(),[Pa,ie]=Aa(ee),Me=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,onValueChange:n,defaultValue:d,orientation:l="horizontal",dir:u,activationMode:c="automatic",...h}=s,m=Is(u),[g,v]=Ps({prop:i,onChange:n,defaultProp:d??"",caller:ee});return e.jsx(Pa,{scope:t,baseId:Rs(),value:g,onValueChange:v,orientation:l,dir:m,activationMode:c,children:e.jsx(J.div,{dir:m,"data-orientation":l,...h,ref:a})})});Me.displayName=ee;var Le="TabsList",Fe=r.forwardRef((s,a)=>{const{__scopeTabs:t,loop:i=!0,...n}=s,d=ie(Le,t),l=Re(t);return e.jsx(Ms,{asChild:!0,...l,orientation:d.orientation,dir:d.dir,loop:i,children:e.jsx(J.div,{role:"tablist","aria-orientation":d.orientation,...n,ref:a})})});Fe.displayName=Le;var Oe="TabsTrigger",ze=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,disabled:n=!1,...d}=s,l=ie(Oe,t),u=Re(t),c=Ue(l.baseId,i),h=Be(l.baseId,i),m=i===l.value;return e.jsx(Ls,{asChild:!0,...u,focusable:!n,active:m,children:e.jsx(J.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...d,ref:a,onMouseDown:Y(s.onMouseDown,g=>{!n&&g.button===0&&g.ctrlKey===!1?l.onValueChange(i):g.preventDefault()}),onKeyDown:Y(s.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&l.onValueChange(i)}),onFocus:Y(s.onFocus,()=>{const g=l.activationMode!=="manual";!m&&!n&&g&&l.onValueChange(i)})})})});ze.displayName=Oe;var Ve="TabsContent",Ge=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,forceMount:n,children:d,...l}=s,u=ie(Ve,t),c=Ue(u.baseId,i),h=Be(u.baseId,i),m=i===u.value,g=r.useRef(m);return r.useEffect(()=>{const v=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(v)},[]),e.jsx(Ts,{present:n||m,children:({present:v})=>e.jsx(J.div,{"data-state":m?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":c,hidden:!v,id:h,tabIndex:0,...l,ref:a,style:{...s.style,animationDuration:g.current?"0s":void 0},children:v&&d})})});Ge.displayName=Ve;function Ue(s,a){return`${s}-trigger-${a}`}function Be(s,a){return`${s}-content-${a}`}var Ta=Me,qe=Fe,He=ze,We=Ge;const Ea=Ta,Ye=r.forwardRef(({className:s,...a},t)=>e.jsx(qe,{ref:t,className:P("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));Ye.displayName=qe.displayName;const G=r.forwardRef(({className:s,...a},t)=>e.jsx(He,{ref:t,className:P("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...a}));G.displayName=He.displayName;const U=r.forwardRef(({className:s,...a},t)=>e.jsx(We,{ref:t,className:P("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));U.displayName=We.displayName;const K=r.forwardRef(({className:s,checked:a,onCheckedChange:t,...i},n)=>e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",ref:n,checked:a,onChange:d=>t?.(d.target.checked),className:"sr-only peer",...i}),e.jsx("div",{className:P("h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 peer-checked:bg-primary peer-checked:text-primary-foreground flex items-center justify-center",s),children:a&&e.jsx(Z,{className:"h-3 w-3"})})]}));K.displayName="Checkbox";function se({message:s="Loading...",variant:a="page",count:t=4}){return a==="inline"?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),e.jsx("span",{className:"text-sm",children:s})]}):a==="cards"?e.jsx("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4 animate-fade-in",children:Array.from({length:t}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsx(E,{className:"h-4 w-1/2"}),e.jsx(E,{className:"h-8 w-3/4"})]},n))}):a==="list"?e.jsx("div",{className:"space-y-3 animate-fade-in",children:Array.from({length:t}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 flex items-center gap-4",children:[e.jsx(E,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(E,{className:"h-4 w-1/3"}),e.jsx(E,{className:"h-3 w-1/2"})]}),e.jsx(E,{className:"h-8 w-16"})]},n))}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"h-8 w-48"}),e.jsx(E,{className:"h-4 w-64"})]}),e.jsx("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsx(E,{className:"h-4 w-1/2"}),e.jsx(E,{className:"h-8 w-3/4"})]},n))}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsx(E,{className:"h-64 w-full"})})]})}var $a=Symbol("radix.slottable");function Ia(s){const a=({children:t})=>e.jsx(e.Fragment,{children:t});return a.displayName=`${s}.Slottable`,a.__radixId=$a,a}var Ze="AlertDialog",[Ra]=je(Ze,[be]),$=be(),Ke=s=>{const{__scopeAlertDialog:a,...t}=s,i=$(a);return e.jsx(Fs,{...i,...t,modal:!0})};Ke.displayName=Ze;var Ma="AlertDialogTrigger",Xe=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=$(t);return e.jsx(Os,{...n,...i,ref:a})});Xe.displayName=Ma;var La="AlertDialogPortal",Je=s=>{const{__scopeAlertDialog:a,...t}=s,i=$(a);return e.jsx(zs,{...i,...t})};Je.displayName=La;var Fa="AlertDialogOverlay",Qe=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=$(t);return e.jsx(qs,{...n,...i,ref:a})});Qe.displayName=Fa;var B="AlertDialogContent",[Oa,za]=Ra(B),Va=Ia("AlertDialogContent"),es=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,children:i,...n}=s,d=$(t),l=r.useRef(null),u=Ne(a,l),c=r.useRef(null);return e.jsx(Vs,{contentName:B,titleName:ss,docsSlug:"alert-dialog",children:e.jsx(Oa,{scope:t,cancelRef:c,children:e.jsxs(Gs,{role:"alertdialog",...d,...n,ref:u,onOpenAutoFocus:Y(n.onOpenAutoFocus,h=>{h.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[e.jsx(Va,{children:i}),e.jsx(Ua,{contentRef:l})]})})})});es.displayName=B;var ss="AlertDialogTitle",as=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=$(t);return e.jsx(Us,{...n,...i,ref:a})});as.displayName=ss;var ts="AlertDialogDescription",rs=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=$(t);return e.jsx(Bs,{...n,...i,ref:a})});rs.displayName=ts;var Ga="AlertDialogAction",ns=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=$(t);return e.jsx(we,{...n,...i,ref:a})});ns.displayName=Ga;var is="AlertDialogCancel",ls=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,{cancelRef:n}=za(is,t),d=$(t),l=Ne(a,n);return e.jsx(we,{...d,...i,ref:l})});ls.displayName=is;var Ua=({contentRef:s})=>{const a=`\`${B}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${B}\` by passing a \`${ts}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${B}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,s]),null},Ba=Ke,qa=Xe,Ha=Je,os=Qe,cs=es,ds=ns,us=ls,ms=as,xs=rs;const Wa=Ba,Ya=qa,Za=Ha,ps=r.forwardRef(({className:s,...a},t)=>e.jsx(os,{className:P("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));ps.displayName=os.displayName;const hs=r.forwardRef(({className:s,...a},t)=>e.jsxs(Za,{children:[e.jsx(ps,{}),e.jsx(cs,{ref:t,className:P("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));hs.displayName=cs.displayName;const gs=({className:s,...a})=>e.jsx("div",{className:P("flex flex-col space-y-2 text-center sm:text-left",s),...a});gs.displayName="AlertDialogHeader";const fs=({className:s,...a})=>e.jsx("div",{className:P("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});fs.displayName="AlertDialogFooter";const vs=r.forwardRef(({className:s,...a},t)=>e.jsx(ms,{ref:t,className:P("text-lg font-semibold",s),...a}));vs.displayName=ms.displayName;const js=r.forwardRef(({className:s,...a},t)=>e.jsx(xs,{ref:t,className:P("text-sm text-muted-foreground",s),...a}));js.displayName=xs.displayName;const Ns=r.forwardRef(({className:s,...a},t)=>e.jsx(ds,{ref:t,className:P(Ae(),s),...a}));Ns.displayName=ds.displayName;const ys=r.forwardRef(({className:s,...a},t)=>e.jsx(us,{ref:t,className:P(Ae({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));ys.displayName=us.displayName;function Ka(){const[s,a]=r.useState([]),[t,i]=r.useState([]),[n,d]=r.useState(!0),[l,u]=r.useState(null),[c,h]=r.useState(""),[m,g]=r.useState(new Set),[v,N]=r.useState(!1),[j,w]=r.useState(""),{toast:f}=q(),y=async()=>{d(!0),u(null);try{const[p,k]=await Promise.all([Pe(),Te()]);a(p),i(k)}catch(p){u(p instanceof Error?p.message:"Failed to load data")}finally{d(!1)}};r.useEffect(()=>{y()},[]);const x=p=>{g(k=>{const S=new Set(k);return S.has(p)?S.delete(p):S.add(p),S})},C=async()=>{if(!c.trim()){f({variant:"destructive",title:"Error",description:"Please enter a group name"});return}const p=Array.from(m);if(p.length<2){f({variant:"destructive",title:"Error",description:`Select at least 2 products (currently ${p.length} selected)`});return}N(!0);try{await Ys(c.trim(),p),f({title:"Success",description:`Group "${c}" created with ${p.length} products`}),h(""),g(new Set),await y()}catch(k){f({variant:"destructive",title:"Error",description:k instanceof Error?k.message:"Failed to create group"})}finally{N(!1)}},T=s.filter(p=>p.group_id===null).filter(p=>p.product_name.toLowerCase().includes(j.toLowerCase())||p.label&&p.label.toLowerCase().includes(j.toLowerCase())||p.product_id.toLowerCase().includes(j.toLowerCase()));return n?e.jsx(se,{message:"Loading products and groups..."}):l?e.jsx(Q,{message:l,onRetry:y}):e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(L,{className:"h-fit",children:[e.jsxs(F,{className:"pb-3",children:[e.jsxs(O,{className:"text-lg flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Create New Group"]}),e.jsx(H,{children:"Select at least 2 ungrouped products to create a group"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"groupName",children:"Group Name"}),e.jsx(M,{id:"groupName",value:c,onChange:p=>h(p.target.value),placeholder:"Enter group name..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{children:["Select Products (",m.size," selected)"]}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(M,{placeholder:"Search products...",value:j,onChange:p=>w(p.target.value),className:"pl-9"})]}),e.jsx("div",{className:"max-h-[250px] overflow-auto rounded-md border p-2 space-y-1",children:T.length>0?T.map(p=>{const k=`grp-cb-${p.id}`,S=m.has(p.product_id);return e.jsxs("div",{className:`flex items-center space-x-3 rounded-md p-2 cursor-pointer transition-colors ${S?"bg-primary/10":"hover:bg-accent/50"}`,onClick:()=>x(p.product_id),children:[e.jsx(K,{id:k,checked:S,onCheckedChange:()=>x(p.product_id)}),e.jsxs("label",{htmlFor:k,className:"flex-1 cursor-pointer text-sm",children:[e.jsx("span",{className:"font-medium",children:p.label||p.product_name}),p.lever&&e.jsxs("span",{className:"ml-2 text-muted-foreground text-xs",children:["(",p.lever,")"]})]})]},p.id)}):e.jsx("p",{className:"py-4 text-center text-muted-foreground text-sm",children:j?"No products found":"All products are already grouped"})})]}),e.jsxs(b,{onClick:C,disabled:v||m.size<2||!c.trim(),className:"w-full",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),v?"Creating...":`Create Group (${m.size} products)`]})]})]}),e.jsxs(L,{className:"h-fit",children:[e.jsx(F,{className:"pb-3",children:e.jsxs(O,{className:"text-lg flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Existing Groups (",t.length,")"]})}),e.jsx(z,{children:t.length>0?e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto",children:t.map(p=>{const k=s.filter(S=>S.group_id===p.id);return e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3 hover:bg-accent/30 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:p.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[k.length," product",k.length!==1?"s":""]}),k.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:k.map(S=>S.label||S.product_name).join(", ")})]}),e.jsxs(Wa,{children:[e.jsx(Ya,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon",className:"ml-2 shrink-0",children:e.jsx(re,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(hs,{children:[e.jsxs(gs,{children:[e.jsx(vs,{children:"Delete Group"}),e.jsxs(js,{children:['Are you sure you want to delete "',p.name,'"? Products in this group will become ungrouped.']})]}),e.jsxs(fs,{children:[e.jsx(ys,{children:"Cancel"}),e.jsx(Ns,{onClick:async()=>{try{f({title:"Info",description:"Delete functionality coming soon"})}catch{f({variant:"destructive",title:"Error",description:"Failed to delete group"})}},children:"Delete"})]})]})]})]},p.id)})}):e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(te,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No groups created yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select products on the left to create your first group"})]})})]})]})}function Xa(s,a=[]){let t=[];function i(d,l){const u=r.createContext(l);u.displayName=d+"Context";const c=t.length;t=[...t,l];const h=g=>{const{scope:v,children:N,...j}=g,w=v?.[s]?.[c]||u,f=r.useMemo(()=>j,Object.values(j));return e.jsx(w.Provider,{value:f,children:N})};h.displayName=d+"Provider";function m(g,v){const N=v?.[s]?.[c]||u,j=r.useContext(N);if(j)return j;if(l!==void 0)return l;throw new Error(`\`${g}\` must be used within \`${d}\``)}return[h,m]}const n=()=>{const d=t.map(l=>r.createContext(l));return function(u){const c=u?.[s]||d;return r.useMemo(()=>({[`__scope${s}`]:{...u,[s]:c}}),[u,c])}};return n.scopeName=s,[i,Ja(n,...a)]}function Ja(...s){const a=s[0];if(s.length===1)return a;const t=()=>{const i=s.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(d){const l=i.reduce((u,{useScope:c,scopeName:h})=>{const g=c(d)[`__scope${h}`];return{...u,...g}},{});return r.useMemo(()=>({[`__scope${a.scopeName}`]:l}),[l])}};return t.scopeName=a.scopeName,t}var Qa=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bs=Qa.reduce((s,a)=>{const t=Zs(`Primitive.${a}`),i=r.forwardRef((n,d)=>{const{asChild:l,...u}=n,c=l?t:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...u,ref:d})});return i.displayName=`Primitive.${a}`,{...s,[a]:i}},{}),le="Progress",oe=100,[et]=Xa(le),[st,at]=et(le),ws=r.forwardRef((s,a)=>{const{__scopeProgress:t,value:i=null,max:n,getValueLabel:d=tt,...l}=s;(n||n===0)&&!he(n)&&console.error(rt(`${n}`,"Progress"));const u=he(n)?n:oe;i!==null&&!ge(i,u)&&console.error(nt(`${i}`,"Progress"));const c=ge(i,u)?i:null,h=X(c)?d(c,u):void 0;return e.jsx(st,{scope:t,value:c,max:u,children:e.jsx(bs.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":X(c)?c:void 0,"aria-valuetext":h,role:"progressbar","data-state":Ss(c,u),"data-value":c??void 0,"data-max":u,...l,ref:a})})});ws.displayName=le;var Cs="ProgressIndicator",ks=r.forwardRef((s,a)=>{const{__scopeProgress:t,...i}=s,n=at(Cs,t);return e.jsx(bs.div,{"data-state":Ss(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...i,ref:a})});ks.displayName=Cs;function tt(s,a){return`${Math.round(s/a*100)}%`}function Ss(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function X(s){return typeof s=="number"}function he(s){return X(s)&&!isNaN(s)&&s>0}function ge(s,a){return X(s)&&!isNaN(s)&&s<=a&&s>=0}function rt(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${oe}\`.`}function nt(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${oe} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var _s=ws,it=ks;const Ds=r.forwardRef(({className:s,value:a,...t},i)=>e.jsx(_s,{ref:i,className:P("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:e.jsx(it,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));Ds.displayName=_s.displayName;function lt(){const[s,a]=r.useState(null),[t,i]=r.useState(!1),[n,d]=r.useState(0),[l,u]=r.useState(null),c=r.useRef(null),{toast:h}=q(),m=N=>{const j=N.target.files?.[0];if(j){const w=[".csv",".zip"],f=j.name.toLowerCase().slice(j.name.lastIndexOf("."));if(!w.includes(f)){h({variant:"destructive",title:"Invalid file type",description:"Please upload a CSV or ZIP file"});return}a(j),u(null),d(0)}},g=async()=>{if(s){i(!0),u(null),d(0);try{const N=await Ks(s,j=>{d(j)});u(N),h({title:"Upload Complete",description:`Rows ${N.rows_read}, inserted ${N.transactions_inserted}, discovered ${N.products_discovered}`})}catch(N){h({variant:"destructive",title:"Upload Failed",description:N instanceof Error?N.message:"Failed to upload file"})}finally{i(!1)}}},v=()=>{a(null),u(null),d(0),c.current&&(c.current.value="")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Upload Transactions"}),e.jsx(H,{children:"Upload CSV or ZIP files containing transaction data"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("input",{type:"file",ref:c,onChange:m,accept:".csv,.zip",className:"hidden"}),s?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ma,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:v,disabled:t,children:"Remove"}),e.jsxs(b,{size:"sm",onClick:g,disabled:t,children:[e.jsx(da,{className:"mr-2 h-4 w-4"}),t?"Uploading...":"Upload"]})]})]}),t&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Uploading..."}),e.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),e.jsx(Ds,{value:n,className:"h-2"}),n===100&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Processing file on server..."})]})]}):e.jsxs("div",{onClick:()=>c.current?.click(),className:"flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-border p-12 transition-colors hover:border-primary/50 hover:bg-accent/50",children:[e.jsx(Ie,{className:"h-10 w-10 text-muted-foreground"}),e.jsx("p",{className:"mt-4 font-medium",children:"Click to upload"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"CSV or ZIP files (max 50MB)"})]})]})]}),l&&e.jsxs(L,{children:[e.jsx(F,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[l.transactions_skipped>0?e.jsx(ne,{className:"h-5 w-5 text-warning"}):e.jsx(oa,{className:"h-5 w-5 text-primary"}),"Upload Result"]})}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Processed"}),e.jsx("p",{className:"text-2xl font-bold",children:l.rows_read})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Products Discovered"}),e.jsx("p",{className:"text-2xl font-bold",children:l.products_discovered})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inserted"}),e.jsx("p",{className:"text-2xl font-bold",children:l.transactions_inserted})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Untracked"}),e.jsx("p",{className:"text-2xl font-bold",children:l.transactions_untracked})]})]})})]})]})}function fe(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(s)}function ot(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(!1),[l,u]=r.useState(null),{toast:c}=q(),[h,m]=r.useState(new Date().getFullYear().toString()),[g,v]=r.useState(""),[N,j]=r.useState(""),w=async()=>{i(!0),u(null);try{const x=await Xs();a(Array.isArray(x)?x:[])}catch(x){u(x instanceof Error?x.message:"Failed to load initial cash data")}finally{i(!1)}};r.useEffect(()=>{w()},[]);const f=async()=>{const x=parseInt(h,10),C=parseFloat(g);if(isNaN(x)||x<2e3||x>2100){c({variant:"destructive",title:"Invalid year"});return}if(isNaN(C)){c({variant:"destructive",title:"Invalid amount"});return}d(!0);try{await Qs(x,C,N||void 0),c({title:"Saved",description:`Initial cash for ${x} set to ${fe(C)}`}),v(""),j(""),w()}catch(I){c({variant:"destructive",title:"Error",description:I instanceof Error?I.message:"Failed to save"})}finally{d(!1)}},y=async x=>{if(confirm(`Delete initial cash for ${x}?`))try{await Js(x),c({title:"Deleted",description:`Initial cash for ${x} removed`}),w()}catch(C){c({variant:"destructive",title:"Error",description:C instanceof Error?C.message:"Failed to delete"})}};return t?e.jsx(se,{message:"Loading balance settings..."}):l?e.jsx(Q,{message:l,onRetry:w}):e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Initial Cash (Caixa Inicial)"}),e.jsx(H,{children:"Define the starting cash balance for each year. This is added to the first month's revenue in Balance calculations."})]}),e.jsxs(z,{className:"space-y-6",children:[s.length>0&&e.jsx("div",{className:"rounded-lg border divide-y",children:s.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:x.year}),e.jsx("span",{className:"ml-4 text-lg font-mono",children:fe(x.amount)}),x.note&&e.jsxs("span",{className:"ml-4 text-sm text-muted-foreground",children:["(",x.note,")"]})]}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>y(x.year),children:e.jsx(re,{className:"h-4 w-4 text-destructive"})})]},x.year))}),s.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground py-4 text-center",children:"No initial cash defined yet. Add one below."}),e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Add or Update Initial Cash"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"ic-year",children:"Year"}),e.jsx(M,{id:"ic-year",type:"number",min:"2000",max:"2100",value:h,onChange:x=>m(x.target.value)})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"ic-amount",children:"Amount ($)"}),e.jsx(M,{id:"ic-amount",type:"number",step:"0.01",placeholder:"0.00",value:g,onChange:x=>v(x.target.value)})]}),e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx(R,{htmlFor:"ic-note",children:"Note (optional)"}),e.jsx(M,{id:"ic-note",placeholder:"e.g. Carried from 2025",value:N,onChange:x=>j(x.target.value)})]}),e.jsx("div",{children:e.jsxs(b,{onClick:f,disabled:n,className:"w-full",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),n?"Saving...":"Save"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"If a year already exists, it will be updated with the new value."})]})]})]})})}const ct=Es("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ve({className:s,variant:a,...t}){return e.jsx("div",{className:P(ct({variant:a}),s),...t})}function dt(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(null),[l,u]=r.useState(""),[c,h]=r.useState(new Set),[m,g]=r.useState(new Set),[v,N]=r.useState(!1),[j,w]=r.useState(null),[f,y]=r.useState(""),{toast:x}=q(),C=async()=>{i(!0),d(null);try{const o=await ea();a(o),g(new Set)}catch(o){d(o instanceof Error?o.message:"Failed to load products")}finally{i(!1)}};r.useEffect(()=>{C()},[]);const I=async o=>{h(_=>new Set(_).add(o.product_id));try{o.is_tracked?(await xe(o.product_id),x({title:"Success",description:`"${o.product_name}" is no longer tracked`})):(await me(o.product_id),x({title:"Success",description:`"${o.product_name}" is now being tracked`})),await C()}catch(_){x({variant:"destructive",title:"Error",description:_ instanceof Error?_.message:"Failed to update tracking"})}finally{h(_=>{const D=new Set(_);return D.delete(o.product_id),D})}},T=o=>{g(_=>{const D=new Set(_);return D.has(o)?D.delete(o):D.add(o),D})},p=r.useMemo(()=>s.filter(o=>o.product_name.toLowerCase().includes(l.toLowerCase())||o.lever&&o.lever.toLowerCase().includes(l.toLowerCase())||o.product_id.toLowerCase().includes(l.toLowerCase())),[s,l]),k=()=>{g(new Set(p.map(o=>o.product_id)))},S=()=>{g(new Set)},ce=async o=>{if(m.size===0)return;N(!0);const _=s.filter(W=>m.has(W.product_id));let D=0,V=0;for(const W of _){if(W.is_tracked===o){D++;continue}try{o?await me(W.product_id):await xe(W.product_id),D++}catch{V++}}x({title:V>0?"Partial Success":"Success",description:`${D} product${D!==1?"s":""} ${o?"tracked":"untracked"}${V>0?`, ${V} failed`:""}`,variant:V>0?"destructive":"default"}),await C(),N(!1)},de=s.filter(o=>o.is_tracked).length,As=s.length-de;return t?e.jsx(se,{message:"Loading products..."}):n?e.jsx(Q,{message:n,onRetry:C}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(F,{className:"pb-3",children:[e.jsx(O,{children:"Product Tracking"}),e.jsx(H,{children:"Manage which products are tracked in reports and analytics. Products are automatically discovered when you upload CSV files."})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"font-medium",children:[de," Tracked"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"font-medium",children:[As," Not Tracked"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ia,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium",children:[s.length," Total"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(M,{placeholder:"Search by product name, lever, or ID...",value:l,onChange:o=>u(o.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:k,disabled:v,className:"whitespace-nowrap",children:[e.jsx(Ca,{className:"h-4 w-4 mr-1"}),"Select All"]}),m.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:S,disabled:v,children:[e.jsx(Sa,{className:"h-4 w-4 mr-1"}),"Clear"]}),e.jsxs(b,{variant:"default",size:"sm",onClick:()=>ce(!0),disabled:v,className:"whitespace-nowrap",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Track (",m.size,")"]}),e.jsxs(b,{variant:"secondary",size:"sm",onClick:()=>ce(!1),disabled:v,className:"whitespace-nowrap",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Untrack (",m.size,")"]})]})]})]}),e.jsx("div",{className:"max-h-[calc(100vh-350px)] min-h-[200px] overflow-auto rounded-md border scrollbar-thin",children:p.length>0?e.jsx("div",{className:"divide-y",children:p.map(o=>{const _=c.has(o.product_id),D=m.has(o.product_id),V=`prod-sel-${o.id}`;return e.jsxs("div",{className:`flex items-center gap-3 p-3 transition-colors ${D?"bg-primary/5":"hover:bg-accent/50"}`,children:[e.jsx(K,{id:V,checked:D,onCheckedChange:()=>T(o.product_id),disabled:v}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(K,{id:`track-${o.id}`,checked:o.is_tracked,disabled:_||v,onCheckedChange:()=>I(o)})}),e.jsxs("div",{className:"flex-1 cursor-pointer min-w-0",onClick:()=>T(o.product_id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:o.product_name}),o.is_tracked?e.jsx(ve,{variant:"default",className:"text-xs bg-green-600 shrink-0",children:"Tracked"}):e.jsx(ve,{variant:"secondary",className:"text-xs shrink-0",children:"Not Tracked"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Lever:"})," ",o.lever||"N/A"]}),e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",o.product_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Last seen:"})," ",new Date(o.last_seen_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(b,{size:"sm",variant:"ghost",disabled:_||v,onClick:()=>{w(o),y(o.product_name)},title:"Edit label",children:e.jsx(Hs,{className:"h-3 w-3"})}),e.jsx(b,{size:"sm",variant:o.is_tracked?"outline":"default",disabled:_||v,onClick:()=>I(o),children:_?"...":o.is_tracked?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Stop"]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Track"]})})]})]},o.id)})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:l?"No products found matching search":"No products discovered yet. Upload a CSV to discover products."})})})]})]}),e.jsx(Ce,{open:!!j,onOpenChange:o=>!o&&w(null),children:e.jsxs(ke,{children:[e.jsx(Se,{children:e.jsx(_e,{children:"Edit Product Label"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Original Name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j?.product_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"edit-label",children:"Display Label"}),e.jsx(M,{id:"edit-label",value:f,onChange:o=>y(o.target.value),placeholder:"Enter custom label..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This label will be shown in reports and dashboards instead of the original name."})]})]}),e.jsxs(De,{children:[e.jsx(b,{variant:"outline",onClick:()=>w(null),children:"Cancel"}),e.jsx(b,{onClick:async()=>{j&&(x({title:"Info",description:j.is_tracked?"Label editing will be available after tracking the product.":"Track this product first to set a custom label."}),w(null))},children:"Save Label"})]})]})})]})}function ut(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(!1),[l,u]=r.useState(null),[c,h]=r.useState(null),{toast:m}=q(),g=async()=>{i(!0),u(null);try{const[f,y,x]=await Promise.all([aa(),Pe(),Te()]);if(f.value&&f.value.length>0)a(f.value);else{const C=x.map(T=>T.name),I=y.filter(T=>!T.group_id).map(T=>T.label||T.product_name);a([...C,...I])}}catch(f){u(f instanceof Error?f.message:"Failed to load sort order")}finally{i(!1)}};r.useEffect(()=>{g()},[]);const v=f=>{h(f)},N=(f,y)=>{if(f.preventDefault(),c===null||c===y)return;const x=[...s],[C]=x.splice(c,1);x.splice(y,0,C),a(x),h(y)},j=()=>{h(null)},w=async()=>{d(!0);try{await ta(s),m({title:"Success",description:"Sort order saved"})}catch(f){m({variant:"destructive",title:"Error",description:f instanceof Error?f.message:"Failed to save sort order"})}finally{d(!1)}};return t?e.jsx(se,{message:"Loading sort order..."}):l?e.jsx(Q,{message:l,onRetry:g}):e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Sort Order"}),e.jsx(H,{children:"Drag items to reorder how they appear in reports"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border divide-y",children:s.map((f,y)=>e.jsxs("div",{draggable:!0,onDragStart:()=>v(y),onDragOver:x=>N(x,y),onDragEnd:j,className:`flex items-center gap-3 p-3 cursor-move transition-colors ${c===y?"bg-accent":"hover:bg-accent/50"}`,children:[e.jsx(pa,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-sm text-muted-foreground w-6",children:y+1}),e.jsx("span",{className:"flex-1 font-medium",children:f})]},`${f}-${y}`))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:w,disabled:n,children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),n?"Saving...":"Save Order"]}),e.jsxs(b,{variant:"outline",onClick:g,children:[e.jsx(sa,{className:"mr-2 h-4 w-4"}),"Reset"]})]})]})]})}function mt({open:s,onOpenChange:a,title:t,description:i,children:n,footer:d}){return e.jsx(Ce,{open:s,onOpenChange:a,children:e.jsxs(ke,{className:"sm:max-w-[500px]",children:[e.jsxs(Se,{children:[e.jsx(_e,{children:t}),i&&e.jsx(Ws,{children:i})]}),e.jsx("div",{className:"py-4",children:n}),d&&e.jsx(De,{children:d})]})})}function xt(){const[s,a]=r.useState(null),[t,i]=r.useState(""),[n,d]=r.useState(!1),{toast:l}=q(),u=[{id:"clear_transactions",title:"Clear Transactions",description:"Delete all transaction records. This cannot be undone.",confirmText:"DELETE",action:async()=>{await pe("transactions")}},{id:"clear_audit",title:"Clear Audit Logs",description:"Delete all audit log entries. This cannot be undone.",confirmText:"DELETE",action:async()=>{await pe("audit_logs")}},{id:"reset_all",title:"Reset All Data",description:"Delete ALL data including products, groups, and transactions. This is a complete factory reset.",confirmText:"RESET",action:async()=>{await ra()}}],c=async()=>{if(s){if(t!==s.confirmText){l({variant:"destructive",title:"Confirmation failed",description:`Please type "${s.confirmText}" to confirm`});return}d(!0);try{await s.action(),l({title:"Success",description:`${s.title} completed`}),h()}catch(m){l({variant:"destructive",title:"Error",description:m instanceof Error?m.message:"Action failed"})}finally{d(!1)}}},h=()=>{a(null),i("")};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{className:"border-destructive/30",children:[e.jsxs(F,{children:[e.jsxs(O,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ne,{className:"h-5 w-5"}),"Danger Zone"]}),e.jsx(H,{children:"Irreversible actions that affect your data. Use with extreme caution."})]}),e.jsx(z,{className:"space-y-4",children:u.map(m=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-destructive/20 bg-destructive/5 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description})]}),e.jsxs(b,{variant:"destructive",size:"sm",onClick:()=>a(m),children:[m.id==="reset_all"?e.jsx(Na,{className:"mr-2 h-4 w-4"}):e.jsx(re,{className:"mr-2 h-4 w-4"}),"Execute"]})]},m.id))})]}),e.jsx(mt,{open:!!s,onOpenChange:m=>!m&&h(),title:`Confirm: ${s?.title}`,description:"This action cannot be undone. Please read carefully.",footer:e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:h,disabled:n,children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:c,disabled:n||t!==s?.confirmText,children:n?"Executing...":"Confirm"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg bg-destructive/10 p-4",children:e.jsxs("p",{className:"text-sm text-destructive",children:[e.jsx("strong",{children:"Warning:"})," ",s?.description]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{htmlFor:"confirm",children:["Type ",e.jsx("strong",{children:s?.confirmText})," to confirm"]}),e.jsx(M,{id:"confirm",value:t,onChange:m=>i(m.target.value),placeholder:s?.confirmText,className:"font-mono"})]})]})})]})}function vt(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage groups, upload data, and configure settings"})]}),e.jsxs(Ea,{defaultValue:"groups",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Ye,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:max-w-[900px] sm:grid-cols-6",children:[e.jsxs(G,{value:"groups",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(te,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Groups"})]}),e.jsxs(G,{value:"products",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(va,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Products"})]}),e.jsxs(G,{value:"upload",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(Ie,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload"})]}),e.jsxs(G,{value:"balance",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx($s,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Balance"})]}),e.jsxs(G,{value:"sort",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(ga,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Sort"})]}),e.jsxs(G,{value:"danger",className:"flex items-center gap-2 px-3 sm:px-4 text-destructive data-[state=active]:text-destructive",children:[e.jsx(ne,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Danger"})]})]})}),e.jsx(U,{value:"groups",className:"mt-6",children:e.jsx(Ka,{})}),e.jsx(U,{value:"products",className:"mt-6",children:e.jsx(dt,{})}),e.jsx(U,{value:"upload",className:"mt-6",children:e.jsx(lt,{})}),e.jsx(U,{value:"balance",className:"mt-6",children:e.jsx(ot,{})}),e.jsx(U,{value:"sort",className:"mt-6",children:e.jsx(ut,{})}),e.jsx(U,{value:"danger",className:"mt-6",children:e.jsx(xt,{})})]})]})}export{vt as default};

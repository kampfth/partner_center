const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SalesChart-BMBYjh2v.js","assets/index-BY_mdGhs.js","assets/index-CuyZ33k3.css","assets/CategoricalChart-DSZmQz6l.js","assets/CartesianChart-DSGBupBU.js","assets/Area-C16rOM5p.js"])))=>i.map(i=>d[i]);
import{c as v,r as n,j as e,_ as H}from"./index-BY_mdGhs.js";import{f as W,E as q,B,L as U,I as z,C as M,a as b,b as R,S as c,c as O}from"./partnerApi-Bnkl2dro.js";import{f as d,s as C}from"./format-DiB1zjxr.js";const Q=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],V=v("activity",Q);const G=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],J=v("calendar-days",G);const K=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],X=v("dollar-sign",K);const Y=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Z=v("shopping-cart",Y);const ee=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],te=v("trending-up",ee),se=n.lazy(()=>H(()=>import("./SalesChart-BMBYjh2v.js"),__vite__mapDeps([0,1,2,3,4,5])));function N(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}function f(){return e.jsx(M,{className:"overflow-hidden",children:e.jsxs(b,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsx(c,{className:"h-3 w-16 sm:w-20"}),e.jsx(c,{className:"h-4 w-4 rounded shrink-0"})]}),e.jsx(c,{className:"h-6 sm:h-7 w-20 sm:w-24"}),e.jsx(c,{className:"h-3 w-14 sm:w-16 mt-1"})]})})}function p({title:a,value:u,icon:l,subtitle:w}){return e.jsx(M,{className:"overflow-hidden",children:e.jsxs(b,{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-muted-foreground uppercase tracking-wider truncate",children:a}),e.jsx(l,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground shrink-0",strokeWidth:1.5})]}),e.jsx("div",{className:"text-lg sm:text-2xl font-semibold tracking-tight tabular-nums truncate",children:u}),w&&e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1 truncate",children:w})]})})}function ae({product:a,rank:u}){const l=a.units_sold>0?a.total_amount/a.units_sold:0;return e.jsxs("div",{className:"flex items-center gap-3 py-2.5 border-b border-border/20 last:border-0",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-secondary text-xs font-medium text-muted-foreground",children:u}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a.display_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.units_sold.toLocaleString()," units"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold tabular-nums",children:N(a.total_amount)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["avg ",N(l)]})]})]})}function ie(){const[a,u]=n.useState(null),[l,w]=n.useState(null),[o,x]=n.useState(""),[m,y]=n.useState(""),[i,$]=n.useState(null),[D,E]=n.useState(!0),[j,A]=n.useState(!0),[F,L]=n.useState(null);n.useEffect(()=>{async function t(){try{const s=await O();if(u(s.min_date),w(s.max_date),s.max_date){const r=new Date(s.max_date),g=d(C(r),"yyyy-MM-dd");x(g),y(s.max_date)}else{const r=new Date;x(d(C(r),"yyyy-MM-dd")),y(d(r,"yyyy-MM-dd"))}}catch(s){console.error("Failed to load date range:",s);const r=new Date;x(d(C(r),"yyyy-MM-dd")),y(d(r,"yyyy-MM-dd"))}finally{A(!1)}}t()},[]);const _=n.useCallback(async()=>{if(!(!o||!m)){E(!0),L(null);try{const t=await W(o,m);$(t)}catch(t){L(t instanceof Error?t.message:"Failed to load data")}finally{E(!1)}}},[o,m]);n.useEffect(()=>{!j&&o&&m&&_()},[_,j,o,m]);const h=n.useMemo(()=>{if(!i)return null;const t=i.summary.reduce((k,S)=>k+S.total_amount,0),s=i.summary.reduce((k,S)=>k+S.units_sold,0),r=s>0?t/s:0,g=i.daily.length,T=g>0?t/g:0;return{totalSales:t,totalUnits:s,avgPerUnit:r,avgPerDay:T,daysWithData:g}},[i]),P=n.useMemo(()=>i?.daily?i.daily.map(t=>({date:d(new Date(t.date),"MMM dd"),sales:t.total_amount,transactions:t.total_units})):[],[i]),I=t=>{if(!l)return;const s=new Date(l),r=new Date(s);r.setDate(r.getDate()-t+1),a&&r<new Date(a)?x(a):x(d(r,"yyyy-MM-dd")),y(l)};return F?e.jsx(q,{message:F,onRetry:_}):e.jsxs("div",{className:"space-y-5 fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Sales overview"})]}),l&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last Sale"}),e.jsx("p",{className:"text-sm font-medium",children:d(new Date(l),"MMM d, yyyy")})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[e.jsx("div",{className:"flex gap-2",children:[7,30,90].map(t=>e.jsxs(B,{variant:"secondary",size:"sm",onClick:()=>I(t),className:"bg-secondary/80 hover:bg-secondary border border-border/50",disabled:!l,children:[t,"d"]},t))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(U,{htmlFor:"start",className:"text-xs text-muted-foreground",children:"From"}),e.jsx(z,{id:"start",type:"date",value:o,min:a||void 0,max:l||void 0,onChange:t=>x(t.target.value)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(U,{htmlFor:"end",className:"text-xs text-muted-foreground",children:"To"}),e.jsx(z,{id:"end",type:"date",value:m,min:a||void 0,max:l||void 0,onChange:t=>y(t.target.value)})]})]})]})]}),e.jsx("div",{className:"grid gap-2 sm:gap-3 grid-cols-2 sm:grid-cols-3 lg:grid-cols-5",children:D||j?e.jsxs(e.Fragment,{children:[e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{})]}):h?e.jsxs(e.Fragment,{children:[e.jsx(p,{title:"Total Sales",value:N(h.totalSales),icon:X}),e.jsx(p,{title:"Units Sold",value:h.totalUnits.toLocaleString(),icon:Z}),e.jsx(p,{title:"Avg/Day",value:N(h.avgPerDay),icon:V}),e.jsx(p,{title:"Avg/Unit",value:N(h.avgPerUnit),icon:te}),e.jsx(p,{title:"Period",value:`${h.daysWithData}d`,icon:J,subtitle:o&&m?`${d(new Date(o),"MMM d")} â€“ ${d(new Date(m),"MMM d")}`:""})]}):null}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(M,{children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-base font-semibold",children:"Daily Sales"})}),e.jsx(b,{className:"pt-0",children:D||j?e.jsx(R,{}):P.length>0?e.jsx(n.Suspense,{fallback:e.jsx(R,{}),children:e.jsx(se,{data:P})}):e.jsx("p",{className:"py-12 text-center text-sm text-muted-foreground",children:"No data for selected period"})})]}),e.jsxs(M,{children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-base font-semibold",children:"Top Products"})}),e.jsx(b,{className:"pt-0",children:D||j?e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(t=>e.jsxs("div",{className:"flex items-center gap-3 py-2.5",children:[e.jsx(c,{className:"w-6 h-6 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{className:"h-4 w-28 mb-1"}),e.jsx(c,{className:"h-3 w-16"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(c,{className:"h-4 w-16 mb-1"}),e.jsx(c,{className:"h-3 w-12"})]})]},t))}):i?.summary&&i.summary.length>0?e.jsx("div",{children:i.summary.sort((t,s)=>s.total_amount-t.total_amount).slice(0,5).map((t,s)=>e.jsx(ae,{product:t,rank:s+1},t.product_id||t.group_id||t.display_name))}):e.jsx("p",{className:"py-12 text-center text-sm text-muted-foreground",children:"No products found"})})]})]})]})}export{ie as default};

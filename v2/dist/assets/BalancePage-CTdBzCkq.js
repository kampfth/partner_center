import{c as _t,r as l,j as e,i as fo,k as Be,u as ne,R as Mt,a as Se,l as Ot,f as K,m as oe,P as D,V as xo,A as Dt,b as A,n as go,o as kt,p as vo,D as Lt,C as Ft,q as Bt,e as U,d as Vt,s as M,h as yo,g as bo}from"./index-Cq-jti8V.js";import{C as fe,e as xe,g as ge,a as ve,B as q,D as bt,E as wo,S as Xe,L as se,I as Ze,q as No,F as jo,G as Co,H as So,J as To,K as Eo,M as Ro,N as Ao}from"./partnerApi-C2kaexa2.js";import{u as it,a as Te,p as Io,q as Po,r as _o,F as Mo,g as Me,i as wt,h as Nt,c as Ht,I as Oo,R as Do,j as jt,k as Ct,l as St,m as Tt,o as Et,n as Rt}from"./dialog-YGZ-RHeF.js";import{C as ko}from"./check--JfdwnBW.js";const Lo=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ct=_t("chevron-down",Lo);const Fo=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Bo=_t("chevron-up",Fo);function At(t,[o,n]){return Math.min(n,Math.max(o,t))}function Vo(t){const o=Ho(t),n=l.forwardRef((r,s)=>{const{children:i,...c}=r,d=l.Children.toArray(i),a=d.find(Go);if(a){const u=a.props.children,h=d.map(y=>y===a?l.Children.count(u)>1?l.Children.only(null):l.isValidElement(u)?u.props.children:null:y);return e.jsx(o,{...c,ref:s,children:l.isValidElement(u)?l.cloneElement(u,void 0,h):null})}return e.jsx(o,{...c,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function Ho(t){const o=l.forwardRef((n,r)=>{const{children:s,...i}=n;if(l.isValidElement(s)){const c=Uo(s),d=Wo(i,s.props);return s.type!==l.Fragment&&(d.ref=r?fo(r,c):c),l.cloneElement(s,d)}return l.Children.count(s)>1?l.Children.only(null):null});return o.displayName=`${t}.SlotClone`,o}var $o=Symbol("radix.slottable");function Go(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===$o}function Wo(t,o){const n={...o};for(const r in o){const s=t[r],i=o[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...d)=>{const a=i(...d);return s(...d),a}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Uo(t){let o=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning;return n?t.ref:(o=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function zo(t){const o=l.useRef({value:t,previous:t});return l.useMemo(()=>(o.current.value!==t&&(o.current.previous=o.current.value,o.current.value=t),o.current.previous),[t])}var Ko=[" ","Enter","ArrowUp","ArrowDown"],Yo=[" ","Enter"],pe="Select",[Ve,He,qo]=Ot(pe),[ye]=Se(pe,[qo,Be]),$e=Be(),[Jo,ae]=ye(pe),[Xo,Zo]=ye(pe),$t=t=>{const{__scopeSelect:o,children:n,open:r,defaultOpen:s,onOpenChange:i,value:c,defaultValue:d,onValueChange:a,dir:u,name:h,autoComplete:y,disabled:N,required:E,form:b}=t,m=$e(o),[x,C]=l.useState(null),[p,w]=l.useState(null),[L,g]=l.useState(!1),v=it(u),[S,T]=ne({prop:r,defaultProp:s??!1,onChange:i,caller:pe}),[R,F]=ne({prop:c,defaultProp:d,onChange:a,caller:pe}),I=l.useRef(null),V=x?b||!!x.closest("form"):!0,[H,J]=l.useState(new Set),X=Array.from(H).map($=>$.props.value).join(";");return e.jsx(Mt,{...m,children:e.jsxs(Jo,{required:E,scope:o,trigger:x,onTriggerChange:C,valueNode:p,onValueNodeChange:w,valueNodeHasChildren:L,onValueNodeHasChildrenChange:g,contentId:Te(),value:R,onValueChange:F,open:S,onOpenChange:T,dir:v,triggerPointerDownPosRef:I,disabled:N,children:[e.jsx(Ve.Provider,{scope:o,children:e.jsx(Xo,{scope:t.__scopeSelect,onNativeOptionAdd:l.useCallback($=>{J(Y=>new Set(Y).add($))},[]),onNativeOptionRemove:l.useCallback($=>{J(Y=>{const Z=new Set(Y);return Z.delete($),Z})},[]),children:n})}),V?e.jsxs(mn,{"aria-hidden":!0,required:E,tabIndex:-1,name:h,autoComplete:y,value:R,onChange:$=>F($.target.value),disabled:N,form:b,children:[R===void 0?e.jsx("option",{value:""}):null,Array.from(H)]},X):null]})})};$t.displayName=pe;var Gt="SelectTrigger",Wt=l.forwardRef((t,o)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=$e(n),c=ae(Gt,n),d=c.disabled||r,a=K(o,c.onTriggerChange),u=He(n),h=l.useRef("touch"),[y,N,E]=fn(m=>{const x=u().filter(w=>!w.disabled),C=x.find(w=>w.value===c.value),p=xn(x,m,C);p!==void 0&&c.onValueChange(p.value)}),b=m=>{d||(c.onOpenChange(!0),E()),m&&(c.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return e.jsx(Dt,{asChild:!0,...i,children:e.jsx(D.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":hn(c.value)?"":void 0,...s,ref:a,onClick:A(s.onClick,m=>{m.currentTarget.focus(),h.current!=="mouse"&&b(m)}),onPointerDown:A(s.onPointerDown,m=>{h.current=m.pointerType;const x=m.target;x.hasPointerCapture(m.pointerId)&&x.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(b(m),m.preventDefault())}),onKeyDown:A(s.onKeyDown,m=>{const x=y.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&N(m.key),!(x&&m.key===" ")&&Ko.includes(m.key)&&(b(),m.preventDefault())})})})});Wt.displayName=Gt;var Ut="SelectValue",zt=l.forwardRef((t,o)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:c="",...d}=t,a=ae(Ut,n),{onValueNodeHasChildrenChange:u}=a,h=i!==void 0,y=K(o,a.onValueNodeChange);return oe(()=>{u(h)},[u,h]),e.jsx(D.span,{...d,ref:y,style:{pointerEvents:"none"},children:hn(a.value)?e.jsx(e.Fragment,{children:c}):i})});zt.displayName=Ut;var Qo="SelectIcon",Kt=l.forwardRef((t,o)=>{const{__scopeSelect:n,children:r,...s}=t;return e.jsx(D.span,{"aria-hidden":!0,...s,ref:o,children:r||"▼"})});Kt.displayName=Qo;var er="SelectPortal",Yt=t=>e.jsx(go,{asChild:!0,...t});Yt.displayName=er;var me="SelectContent",qt=l.forwardRef((t,o)=>{const n=ae(me,t.__scopeSelect),[r,s]=l.useState();if(oe(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?kt.createPortal(e.jsx(Jt,{scope:t.__scopeSelect,children:e.jsx(Ve.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),i):null}return e.jsx(Xt,{...t,ref:o})});qt.displayName=me;var Q=10,[Jt,le]=ye(me),tr="SelectContentImpl",nr=Vo("SelectContent.RemoveScroll"),Xt=l.forwardRef((t,o)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:c,side:d,sideOffset:a,align:u,alignOffset:h,arrowPadding:y,collisionBoundary:N,collisionPadding:E,sticky:b,hideWhenDetached:m,avoidCollisions:x,...C}=t,p=ae(me,n),[w,L]=l.useState(null),[g,v]=l.useState(null),S=K(o,j=>L(j)),[T,R]=l.useState(null),[F,I]=l.useState(null),V=He(n),[H,J]=l.useState(!1),X=l.useRef(!1);l.useEffect(()=>{if(w)return Io(w)},[w]),Po();const $=l.useCallback(j=>{const[_,...W]=V().map(B=>B.ref.current),[P]=W.slice(-1),O=document.activeElement;for(const B of j)if(B===O||(B?.scrollIntoView({block:"nearest"}),B===_&&g&&(g.scrollTop=0),B===P&&g&&(g.scrollTop=g.scrollHeight),B?.focus(),document.activeElement!==O))return},[V,g]),Y=l.useCallback(()=>$([T,w]),[$,T,w]);l.useEffect(()=>{H&&Y()},[H,Y]);const{onOpenChange:Z,triggerPointerDownPosRef:te}=p;l.useEffect(()=>{if(w){let j={x:0,y:0};const _=P=>{j={x:Math.abs(Math.round(P.pageX)-(te.current?.x??0)),y:Math.abs(Math.round(P.pageY)-(te.current?.y??0))}},W=P=>{j.x<=10&&j.y<=10?P.preventDefault():w.contains(P.target)||Z(!1),document.removeEventListener("pointermove",_),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",_),document.addEventListener("pointerup",W,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",W,{capture:!0})}}},[w,Z,te]),l.useEffect(()=>{const j=()=>Z(!1);return window.addEventListener("blur",j),window.addEventListener("resize",j),()=>{window.removeEventListener("blur",j),window.removeEventListener("resize",j)}},[Z]);const[ce,re]=fn(j=>{const _=V().filter(O=>!O.disabled),W=_.find(O=>O.ref.current===document.activeElement),P=xn(_,j,W);P&&setTimeout(()=>P.ref.current.focus())}),be=l.useCallback((j,_,W)=>{const P=!X.current&&!W;(p.value!==void 0&&p.value===_||P)&&(R(j),P&&(X.current=!0))},[p.value]),we=l.useCallback(()=>w?.focus(),[w]),f=l.useCallback((j,_,W)=>{const P=!X.current&&!W;(p.value!==void 0&&p.value===_||P)&&I(j)},[p.value]),G=r==="popper"?nt:Zt,z=G===nt?{side:d,sideOffset:a,align:u,alignOffset:h,arrowPadding:y,collisionBoundary:N,collisionPadding:E,sticky:b,hideWhenDetached:m,avoidCollisions:x}:{};return e.jsx(Jt,{scope:n,content:w,viewport:g,onViewportChange:v,itemRefCallback:be,selectedItem:T,onItemLeave:we,itemTextRefCallback:f,focusSelectedItem:Y,selectedItemText:F,position:r,isPositioned:H,searchRef:ce,children:e.jsx(_o,{as:nr,allowPinchZoom:!0,children:e.jsx(Mo,{asChild:!0,trapped:p.open,onMountAutoFocus:j=>{j.preventDefault()},onUnmountAutoFocus:A(s,j=>{p.trigger?.focus({preventScroll:!0}),j.preventDefault()}),children:e.jsx(Lt,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:j=>j.preventDefault(),onDismiss:()=>p.onOpenChange(!1),children:e.jsx(G,{role:"listbox",id:p.contentId,"data-state":p.open?"open":"closed",dir:p.dir,onContextMenu:j=>j.preventDefault(),...C,...z,onPlaced:()=>J(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:A(C.onKeyDown,j=>{const _=j.ctrlKey||j.altKey||j.metaKey;if(j.key==="Tab"&&j.preventDefault(),!_&&j.key.length===1&&re(j.key),["ArrowUp","ArrowDown","Home","End"].includes(j.key)){let P=V().filter(O=>!O.disabled).map(O=>O.ref.current);if(["ArrowUp","End"].includes(j.key)&&(P=P.slice().reverse()),["ArrowUp","ArrowDown"].includes(j.key)){const O=j.target,B=P.indexOf(O);P=P.slice(B+1)}setTimeout(()=>$(P)),j.preventDefault()}})})})})})})});Xt.displayName=tr;var or="SelectItemAlignedPosition",Zt=l.forwardRef((t,o)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=ae(me,n),c=le(me,n),[d,a]=l.useState(null),[u,h]=l.useState(null),y=K(o,S=>h(S)),N=He(n),E=l.useRef(!1),b=l.useRef(!0),{viewport:m,selectedItem:x,selectedItemText:C,focusSelectedItem:p}=c,w=l.useCallback(()=>{if(i.trigger&&i.valueNode&&d&&u&&m&&x&&C){const S=i.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),R=i.valueNode.getBoundingClientRect(),F=C.getBoundingClientRect();if(i.dir!=="rtl"){const O=F.left-T.left,B=R.left-O,de=S.left-B,ue=S.width+de,Ye=Math.max(ue,T.width),qe=window.innerWidth-Q,Je=At(B,[Q,Math.max(Q,qe-Ye)]);d.style.minWidth=ue+"px",d.style.left=Je+"px"}else{const O=T.right-F.right,B=window.innerWidth-R.right-O,de=window.innerWidth-S.right-B,ue=S.width+de,Ye=Math.max(ue,T.width),qe=window.innerWidth-Q,Je=At(B,[Q,Math.max(Q,qe-Ye)]);d.style.minWidth=ue+"px",d.style.right=Je+"px"}const I=N(),V=window.innerHeight-Q*2,H=m.scrollHeight,J=window.getComputedStyle(u),X=parseInt(J.borderTopWidth,10),$=parseInt(J.paddingTop,10),Y=parseInt(J.borderBottomWidth,10),Z=parseInt(J.paddingBottom,10),te=X+$+H+Z+Y,ce=Math.min(x.offsetHeight*5,te),re=window.getComputedStyle(m),be=parseInt(re.paddingTop,10),we=parseInt(re.paddingBottom,10),f=S.top+S.height/2-Q,G=V-f,z=x.offsetHeight/2,j=x.offsetTop+z,_=X+$+j,W=te-_;if(_<=f){const O=I.length>0&&x===I[I.length-1].ref.current;d.style.bottom="0px";const B=u.clientHeight-m.offsetTop-m.offsetHeight,de=Math.max(G,z+(O?we:0)+B+Y),ue=_+de;d.style.height=ue+"px"}else{const O=I.length>0&&x===I[0].ref.current;d.style.top="0px";const de=Math.max(f,X+m.offsetTop+(O?be:0)+z)+W;d.style.height=de+"px",m.scrollTop=_-f+m.offsetTop}d.style.margin=`${Q}px 0`,d.style.minHeight=ce+"px",d.style.maxHeight=V+"px",r?.(),requestAnimationFrame(()=>E.current=!0)}},[N,i.trigger,i.valueNode,d,u,m,x,C,i.dir,r]);oe(()=>w(),[w]);const[L,g]=l.useState();oe(()=>{u&&g(window.getComputedStyle(u).zIndex)},[u]);const v=l.useCallback(S=>{S&&b.current===!0&&(w(),p?.(),b.current=!1)},[w,p]);return e.jsx(sr,{scope:n,contentWrapper:d,shouldExpandOnScrollRef:E,onScrollButtonChange:v,children:e.jsx("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:L},children:e.jsx(D.div,{...s,ref:y,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Zt.displayName=or;var rr="SelectPopperPosition",nt=l.forwardRef((t,o)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Q,...i}=t,c=$e(n);return e.jsx(Ft,{...c,...i,ref:o,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});nt.displayName=rr;var[sr,dt]=ye(me,{}),ot="SelectViewport",Qt=l.forwardRef((t,o)=>{const{__scopeSelect:n,nonce:r,...s}=t,i=le(ot,n),c=dt(ot,n),d=K(o,i.onViewportChange),a=l.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(Ve.Slot,{scope:n,children:e.jsx(D.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:A(s.onScroll,u=>{const h=u.currentTarget,{contentWrapper:y,shouldExpandOnScrollRef:N}=c;if(N?.current&&y){const E=Math.abs(a.current-h.scrollTop);if(E>0){const b=window.innerHeight-Q*2,m=parseFloat(y.style.minHeight),x=parseFloat(y.style.height),C=Math.max(m,x);if(C<b){const p=C+E,w=Math.min(b,p),L=p-w;y.style.height=w+"px",y.style.bottom==="0px"&&(h.scrollTop=L>0?L:0,y.style.justifyContent="flex-end")}}}a.current=h.scrollTop})})})]})});Qt.displayName=ot;var en="SelectGroup",[ar,lr]=ye(en),ir=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=Te();return e.jsx(ar,{scope:n,id:s,children:e.jsx(D.div,{role:"group","aria-labelledby":s,...r,ref:o})})});ir.displayName=en;var tn="SelectLabel",nn=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=lr(tn,n);return e.jsx(D.div,{id:s.id,...r,ref:o})});nn.displayName=tn;var Oe="SelectItem",[cr,on]=ye(Oe),rn=l.forwardRef((t,o)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...c}=t,d=ae(Oe,n),a=le(Oe,n),u=d.value===r,[h,y]=l.useState(i??""),[N,E]=l.useState(!1),b=K(o,p=>a.itemRefCallback?.(p,r,s)),m=Te(),x=l.useRef("touch"),C=()=>{s||(d.onValueChange(r),d.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(cr,{scope:n,value:r,disabled:s,textId:m,isSelected:u,onItemTextChange:l.useCallback(p=>{y(w=>w||(p?.textContent??"").trim())},[]),children:e.jsx(Ve.ItemSlot,{scope:n,value:r,disabled:s,textValue:h,children:e.jsx(D.div,{role:"option","aria-labelledby":m,"data-highlighted":N?"":void 0,"aria-selected":u&&N,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...c,ref:b,onFocus:A(c.onFocus,()=>E(!0)),onBlur:A(c.onBlur,()=>E(!1)),onClick:A(c.onClick,()=>{x.current!=="mouse"&&C()}),onPointerUp:A(c.onPointerUp,()=>{x.current==="mouse"&&C()}),onPointerDown:A(c.onPointerDown,p=>{x.current=p.pointerType}),onPointerMove:A(c.onPointerMove,p=>{x.current=p.pointerType,s?a.onItemLeave?.():x.current==="mouse"&&p.currentTarget.focus({preventScroll:!0})}),onPointerLeave:A(c.onPointerLeave,p=>{p.currentTarget===document.activeElement&&a.onItemLeave?.()}),onKeyDown:A(c.onKeyDown,p=>{a.searchRef?.current!==""&&p.key===" "||(Yo.includes(p.key)&&C(),p.key===" "&&p.preventDefault())})})})})});rn.displayName=Oe;var Ne="SelectItemText",sn=l.forwardRef((t,o)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,c=ae(Ne,n),d=le(Ne,n),a=on(Ne,n),u=Zo(Ne,n),[h,y]=l.useState(null),N=K(o,C=>y(C),a.onItemTextChange,C=>d.itemTextRefCallback?.(C,a.value,a.disabled)),E=h?.textContent,b=l.useMemo(()=>e.jsx("option",{value:a.value,disabled:a.disabled,children:E},a.value),[a.disabled,a.value,E]),{onNativeOptionAdd:m,onNativeOptionRemove:x}=u;return oe(()=>(m(b),()=>x(b)),[m,x,b]),e.jsxs(e.Fragment,{children:[e.jsx(D.span,{id:a.textId,...i,ref:N}),a.isSelected&&c.valueNode&&!c.valueNodeHasChildren?kt.createPortal(i.children,c.valueNode):null]})});sn.displayName=Ne;var an="SelectItemIndicator",ln=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t;return on(an,n).isSelected?e.jsx(D.span,{"aria-hidden":!0,...r,ref:o}):null});ln.displayName=an;var rt="SelectScrollUpButton",cn=l.forwardRef((t,o)=>{const n=le(rt,t.__scopeSelect),r=dt(rt,t.__scopeSelect),[s,i]=l.useState(!1),c=K(o,r.onScrollButtonChange);return oe(()=>{if(n.viewport&&n.isPositioned){let d=function(){const u=a.scrollTop>0;i(u)};const a=n.viewport;return d(),a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[n.viewport,n.isPositioned]),s?e.jsx(un,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:a}=n;d&&a&&(d.scrollTop=d.scrollTop-a.offsetHeight)}}):null});cn.displayName=rt;var st="SelectScrollDownButton",dn=l.forwardRef((t,o)=>{const n=le(st,t.__scopeSelect),r=dt(st,t.__scopeSelect),[s,i]=l.useState(!1),c=K(o,r.onScrollButtonChange);return oe(()=>{if(n.viewport&&n.isPositioned){let d=function(){const u=a.scrollHeight-a.clientHeight,h=Math.ceil(a.scrollTop)<u;i(h)};const a=n.viewport;return d(),a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[n.viewport,n.isPositioned]),s?e.jsx(un,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:a}=n;d&&a&&(d.scrollTop=d.scrollTop+a.offsetHeight)}}):null});dn.displayName=st;var un=l.forwardRef((t,o)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=le("SelectScrollButton",n),c=l.useRef(null),d=He(n),a=l.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return l.useEffect(()=>()=>a(),[a]),oe(()=>{d().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),e.jsx(D.div,{"aria-hidden":!0,...s,ref:o,style:{flexShrink:0,...s.style},onPointerDown:A(s.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(r,50))}),onPointerMove:A(s.onPointerMove,()=>{i.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(r,50))}),onPointerLeave:A(s.onPointerLeave,()=>{a()})})}),dr="SelectSeparator",pn=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t;return e.jsx(D.div,{"aria-hidden":!0,...r,ref:o})});pn.displayName=dr;var at="SelectArrow",ur=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=$e(n),i=ae(at,n),c=le(at,n);return i.open&&c.position==="popper"?e.jsx(Bt,{...s,...r,ref:o}):null});ur.displayName=at;var pr="SelectBubbleInput",mn=l.forwardRef(({__scopeSelect:t,value:o,...n},r)=>{const s=l.useRef(null),i=K(r,s),c=zo(o);return l.useEffect(()=>{const d=s.current;if(!d)return;const a=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(a,"value").set;if(c!==o&&h){const y=new Event("change",{bubbles:!0});h.call(d,o),d.dispatchEvent(y)}},[c,o]),e.jsx(D.select,{...n,style:{...xo,...n.style},ref:i,defaultValue:o})});mn.displayName=pr;function hn(t){return t===""||t===void 0}function fn(t){const o=vo(t),n=l.useRef(""),r=l.useRef(0),s=l.useCallback(c=>{const d=n.current+c;o(d),(function a(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>a(""),1e3))})(d)},[o]),i=l.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function xn(t,o,n){const s=o.length>1&&Array.from(o).every(u=>u===o[0])?o[0]:o,i=n?t.indexOf(n):-1;let c=mr(t,Math.max(i,0));s.length===1&&(c=c.filter(u=>u!==n));const a=c.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return a!==n?a:void 0}function mr(t,o){return t.map((n,r)=>t[(o+r)%t.length])}var hr=$t,gn=Wt,fr=zt,xr=Kt,gr=Yt,vn=qt,vr=Qt,yn=nn,bn=rn,yr=sn,br=ln,wn=cn,Nn=dn,jn=pn;const Ee=hr,Re=fr,je=l.forwardRef(({className:t,children:o,...n},r)=>e.jsxs(gn,{ref:r,className:U("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[o,e.jsx(xr,{asChild:!0,children:e.jsx(ct,{className:"h-4 w-4 opacity-50"})})]}));je.displayName=gn.displayName;const Cn=l.forwardRef(({className:t,...o},n)=>e.jsx(wn,{ref:n,className:U("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(Bo,{className:"h-4 w-4"})}));Cn.displayName=wn.displayName;const Sn=l.forwardRef(({className:t,...o},n)=>e.jsx(Nn,{ref:n,className:U("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(ct,{className:"h-4 w-4"})}));Sn.displayName=Nn.displayName;const Ce=l.forwardRef(({className:t,children:o,position:n="popper",...r},s)=>e.jsx(gr,{children:e.jsxs(vn,{ref:s,className:U("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[e.jsx(Cn,{}),e.jsx(vr,{className:U("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),e.jsx(Sn,{})]})}));Ce.displayName=vn.displayName;const wr=l.forwardRef(({className:t,...o},n)=>e.jsx(yn,{ref:n,className:U("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...o}));wr.displayName=yn.displayName;const he=l.forwardRef(({className:t,children:o,...n},r)=>e.jsxs(bn,{ref:r,className:U("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(br,{children:e.jsx(ko,{className:"h-4 w-4"})})}),e.jsx(yr,{children:o})]}));he.displayName=bn.displayName;const Nr=l.forwardRef(({className:t,...o},n)=>e.jsx(jn,{ref:n,className:U("-mx-1 my-1 h-px bg-muted",t),...o}));Nr.displayName=jn.displayName;const Tn=l.forwardRef(({className:t,...o},n)=>e.jsx("textarea",{className:U("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...o}));Tn.displayName="Textarea";var Qe,Ge="HoverCard",[En]=Se(Ge,[Be]),We=Be(),[jr,ut]=En(Ge),Rn=t=>{const{__scopeHoverCard:o,children:n,open:r,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=t,a=We(o),u=l.useRef(0),h=l.useRef(0),y=l.useRef(!1),N=l.useRef(!1),[E,b]=ne({prop:r,defaultProp:s??!1,onChange:i,caller:Ge}),m=l.useCallback(()=>{clearTimeout(h.current),u.current=window.setTimeout(()=>b(!0),c)},[c,b]),x=l.useCallback(()=>{clearTimeout(u.current),!y.current&&!N.current&&(h.current=window.setTimeout(()=>b(!1),d))},[d,b]),C=l.useCallback(()=>b(!1),[b]);return l.useEffect(()=>()=>{clearTimeout(u.current),clearTimeout(h.current)},[]),e.jsx(jr,{scope:o,open:E,onOpenChange:b,onOpen:m,onClose:x,onDismiss:C,hasSelectionRef:y,isPointerDownOnContentRef:N,children:e.jsx(Mt,{...a,children:n})})};Rn.displayName=Ge;var An="HoverCardTrigger",In=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,...r}=t,s=ut(An,n),i=We(n);return e.jsx(Dt,{asChild:!0,...i,children:e.jsx(D.a,{"data-state":s.open?"open":"closed",...r,ref:o,onPointerEnter:A(t.onPointerEnter,ke(s.onOpen)),onPointerLeave:A(t.onPointerLeave,ke(s.onClose)),onFocus:A(t.onFocus,s.onOpen),onBlur:A(t.onBlur,s.onClose),onTouchStart:A(t.onTouchStart,c=>c.preventDefault())})})});In.displayName=An;var Cr="HoverCardPortal",[gs,Sr]=En(Cr,{forceMount:void 0}),De="HoverCardContent",Pn=l.forwardRef((t,o)=>{const n=Sr(De,t.__scopeHoverCard),{forceMount:r=n.forceMount,...s}=t,i=ut(De,t.__scopeHoverCard);return e.jsx(Vt,{present:r||i.open,children:e.jsx(Tr,{"data-state":i.open?"open":"closed",...s,onPointerEnter:A(t.onPointerEnter,ke(i.onOpen)),onPointerLeave:A(t.onPointerLeave,ke(i.onClose)),ref:o})})});Pn.displayName=De;var Tr=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=t,a=ut(De,n),u=We(n),h=l.useRef(null),y=K(o,h),[N,E]=l.useState(!1);return l.useEffect(()=>{if(N){const b=document.body;return Qe=b.style.userSelect||b.style.webkitUserSelect,b.style.userSelect="none",b.style.webkitUserSelect="none",()=>{b.style.userSelect=Qe,b.style.webkitUserSelect=Qe}}},[N]),l.useEffect(()=>{if(h.current){const b=()=>{E(!1),a.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(a.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",b),()=>{document.removeEventListener("pointerup",b),a.hasSelectionRef.current=!1,a.isPointerDownOnContentRef.current=!1}}},[a.isPointerDownOnContentRef,a.hasSelectionRef]),l.useEffect(()=>{h.current&&Ar(h.current).forEach(m=>m.setAttribute("tabindex","-1"))}),e.jsx(Lt,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:A(i,b=>{b.preventDefault()}),onDismiss:a.onDismiss,children:e.jsx(Ft,{...u,...d,onPointerDown:A(d.onPointerDown,b=>{b.currentTarget.contains(b.target)&&E(!0),a.hasSelectionRef.current=!1,a.isPointerDownOnContentRef.current=!0}),ref:y,style:{...d.style,userSelect:N?"text":void 0,WebkitUserSelect:N?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Er="HoverCardArrow",Rr=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,...r}=t,s=We(n);return e.jsx(Bt,{...s,...r,ref:o})});Rr.displayName=Er;function ke(t){return o=>o.pointerType==="touch"?void 0:t()}function Ar(t){const o=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;n.nextNode();)o.push(n.currentNode);return o}var Ir=Rn,Pr=In,_n=Pn;const _r=Ir,Mr=Pr,Mn=l.forwardRef(({className:t,align:o="center",sideOffset:n=4,...r},s)=>e.jsx(_n,{ref:s,align:o,sideOffset:n,className:U("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));Mn.displayName=_n.displayName;function k(t){return Number.isFinite(t)?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t):"$0.00"}function On(t){return Number.isFinite(t)?`${t.toFixed(2)}%`:"0.00%"}const Dn=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];function Or(t){const o=t.split("-");if(o.length!==2)return null;const n=Number(o[1]);return!Number.isFinite(n)||n<1||n>12?null:n-1}function Ae(t){const o=t.split("-");if(o.length!==2)return t;const n=Number(o[1]);return!Number.isFinite(n)||n<1||n>12?t:Dn[n-1]}function et(t,o,n){if(o.length===0)return"future";let r=null;for(let s=o.length-1;s>=0;s--){const i=o[s];if((n.autoRevenue?.byMonth?.[i]??0)>0){r=i;break}}return r?t===r?"current":t<r?"closed":"future":"future"}function Dr(t){const o={};for(const n of t)o[n.name]||(o[n.name]={byMonth:{},ids:[],yearTotal:0}),o[n.name].byMonth[n.year_month]=(o[n.name].byMonth[n.year_month]??0)+Number(n.amount??0),o[n.name].yearTotal+=Number(n.amount??0),o[n.name].ids.push(n.id);return o}function kr(t,o){const n={};for(const r of o)n[r.id]={byMonth:{},idsByMonth:{},yearTotal:0,withdrawalIds:[]};for(const r of t){const s=r.partner_id;if(!s)continue;let i=null;for(const c of o)if(c.id===s||c.id.toLowerCase()===s.toLowerCase()){i=c.id;break}if(i&&n[i]){const c=Number(r.amount)||0;n[i].byMonth[r.year_month]=(n[i].byMonth[r.year_month]||0)+c,n[i].yearTotal+=c,n[i].withdrawalIds.push(r.id),n[i].idsByMonth[r.year_month]||(n[i].idsByMonth[r.year_month]=[]),n[i].idsByMonth[r.year_month].push(r.id)}}return n}function Lr(t,o){const n=Array.isArray(t.autoRevenue?.byLine)?t.autoRevenue.byLine:[],r=Array.isArray(o?.value)?o.value:[],s=new Map;for(const a of n)s.set(a.key,a);const i=[],c=new Set;for(const a of r){const u=String(a??"").trim();if(!u||c.has(u))continue;const h=s.get(u);h&&(i.push({key:u,label:u.toUpperCase(),byMonth:h.byMonth||{},total:h.yearTotal||0,isGroup:h.type==="Group"}),c.add(u))}const d=n.filter(a=>!c.has(a.key)).sort((a,u)=>(u.yearTotal||0)-(a.yearTotal||0));for(const a of d)i.push({key:a.key,label:a.key.toUpperCase(),byMonth:a.byMonth||{},total:a.yearTotal||0,isGroup:a.type==="Group"});return i}function Fr({data:t,sortOrder:o,onAddExpense:n,onEditExpense:r,onDeleteExpense:s,onAddWithdrawal:i,onEditWithdrawal:c,onDeleteWithdrawal:d}){const a=Array.isArray(t.months)?t.months:[],u=Array.isArray(t.fixedExpenses)?t.fixedExpenses:[],h=Array.isArray(t.variableExpenses)?t.variableExpenses:[],y=Array.isArray(t.withdrawals)?t.withdrawals:[],N=Array.isArray(t.partners)?t.partners:[],E=[...u,...h],b=Dr(E),m=kr(y,N),x=Lr(t,o),C=x.reduce((v,S)=>v+S.total,0),p=t.computed?.yearTotals?.totalExpenses||0,w=t.computed?.yearTotals?.totalWithdrawals||0,g=(t.initialCash||0)+C-p-w;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(fe,{className:"bg-gradient-to-br from-card to-muted/20",children:[e.jsx(xe,{className:"py-0 h-[54px] justify-center",children:e.jsx(ge,{className:"text-base",children:"SUMMARY"})}),e.jsxs(ve,{className:"py-2",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Revenue"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(C)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Expenses"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(p+w)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Net"}),e.jsx("p",{className:`text-lg font-bold tabular-nums ${g>=0?"text-green-600":"text-red-600"}`,children:k(g)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Per Partner"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(N.length>0?g/N.length:0)})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["% Expense/Revenue: ",e.jsx("span",{className:"font-semibold",children:On(C>0?(p+w)/C*100:0)})]})]})]}),e.jsxs(fe,{children:[e.jsx(xe,{className:"py-2",children:e.jsx(ge,{className:"text-base",children:"PRODUCTS"})}),e.jsx(ve,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/40",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Product"}),a.map(v=>{const S=et(v,a,t);return e.jsx("th",{className:`py-1.5 px-1 text-right text-xs font-medium uppercase tracking-wide ${S==="current"?"italic text-foreground":"text-muted-foreground"} ${S==="closed"?"bg-green-50 dark:bg-green-950/20 font-bold":""}`,children:Ae(v)},v)}),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+2,className:"py-6 text-center text-muted-foreground",children:"No products found. Configure Sort Order in Admin."})}):e.jsxs(e.Fragment,{children:[x.map(v=>e.jsxs("tr",{className:v.isGroup?"bg-muted/30":"hover:bg-muted/20",children:[e.jsx("td",{className:`py-1.5 px-2 ${v.isGroup?"font-semibold":"font-medium"}`,children:v.label}),a.map(S=>{const T=et(S,a,t);return e.jsx("td",{className:`py-1.5 px-1 text-right tabular-nums ${T==="current"?"italic":""} ${T==="closed"?"bg-green-50 dark:bg-green-950/20 font-bold":""}`,children:v.byMonth[S]?k(v.byMonth[S]):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},S)}),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:v.total>0?k(v.total):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})})]},v.key)),e.jsxs("tr",{className:"border-t-2 border-border bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2 font-bold text-sm",children:"TOTAL"}),a.map(v=>{const S=x.reduce((R,F)=>R+(F.byMonth[v]||0),0),T=et(v,a,t);return e.jsx("td",{className:`py-2 px-1 text-right font-bold tabular-nums ${T==="current"?"italic":""} ${T==="closed"?"bg-green-50 dark:bg-green-950/20":""}`,children:S>0?k(S):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},v)}),e.jsx("td",{className:"py-2 px-2 text-right font-bold tabular-nums",children:k(C)})]})]})})]})})})]}),e.jsxs(fe,{children:[e.jsxs(xe,{className:"py-0 h-12 flex flex-row items-center justify-between space-y-0",children:[e.jsx(ge,{className:"text-base",children:"EXPENSES"}),e.jsxs(q,{size:"sm",variant:"outline",onClick:n,children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Add"]})]}),e.jsx(ve,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/40 border-b",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase",children:"Name"}),a.map(v=>e.jsx("th",{className:"py-1.5 px-1 text-right text-xs font-medium text-muted-foreground uppercase",children:Ae(v)},v)),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase",children:"Total"}),e.jsx("th",{className:"py-1.5 px-1 w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:Object.keys(b).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+3,className:"py-4 text-center text-muted-foreground text-xs",children:"No expenses."})}):Object.entries(b).map(([v,S])=>{const T=E.find(R=>R.name===v);return e.jsxs("tr",{className:"hover:bg-muted/20",children:[e.jsx("td",{className:"py-1.5 px-2 font-medium",children:v.toUpperCase()}),a.map(R=>e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:S.byMonth[R]?k(S.byMonth[R]):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},R)),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:k(S.yearTotal)}),e.jsx("td",{className:"py-1.5 px-1",children:T&&e.jsxs("div",{className:"flex items-center gap-0.5 justify-end",children:[e.jsx(q,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>r(T),children:e.jsx(wt,{className:"h-3 w-3"})}),e.jsx(q,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>s(T.id),children:e.jsx(Nt,{className:"h-3 w-3"})})]})})]},v)})})]})})})]}),e.jsxs(fe,{children:[e.jsxs(xe,{className:"py-2 flex flex-row items-center justify-between space-y-0",children:[e.jsx(ge,{className:"text-base",children:"WITHDRAWALS"}),e.jsxs(q,{size:"sm",variant:"outline",onClick:i,children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Add"]})]}),e.jsx(ve,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/40",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase",children:"Partner"}),a.map(v=>e.jsx("th",{className:"py-1.5 px-1 text-right text-xs font-medium text-muted-foreground uppercase",children:Ae(v)},v)),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+2,className:"py-4 text-center text-muted-foreground text-xs",children:"No partners configured."})}):N.map(v=>{const S=m[v.id]||{byMonth:{},idsByMonth:{},yearTotal:0};return e.jsxs("tr",{className:"hover:bg-muted/20",children:[e.jsx("td",{className:"py-1.5 px-2 font-medium",children:v.name.toUpperCase()}),a.map(T=>{const R=S.byMonth[T],F=S.idsByMonth[T]||[];if(!R)return e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},T);const I=F.length>0?y.find(V=>V.id===F[0]):null;return e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:e.jsxs(_r,{openDelay:100,closeDelay:100,children:[e.jsx(Mr,{asChild:!0,children:e.jsx("span",{className:"cursor-pointer hover:text-primary hover:underline transition-colors",children:k(R)})}),e.jsx(Mn,{className:"w-auto p-2",align:"center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground mr-2",children:[Ae(T),": ",k(R)]}),I&&e.jsxs(e.Fragment,{children:[e.jsxs(q,{variant:"outline",size:"sm",className:"h-7 px-2",onClick:()=>c(I),children:[e.jsx(wt,{className:"h-3 w-3 mr-1"}),"Edit"]}),e.jsxs(q,{variant:"destructive",size:"sm",className:"h-7 px-2",onClick:()=>d(I.id),children:[e.jsx(Nt,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})})]})},T)}),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:S.yearTotal>0?k(S.yearTotal):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})})]},v.id)})})]})})})]})]})}var Ue="Collapsible",[Br,kn]=Se(Ue),[Vr,pt]=Br(Ue),Ln=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,open:r,defaultOpen:s,disabled:i,onOpenChange:c,...d}=t,[a,u]=ne({prop:r,defaultProp:s??!1,onChange:c,caller:Ue});return e.jsx(Vr,{scope:n,disabled:i,contentId:Te(),open:a,onOpenToggle:l.useCallback(()=>u(h=>!h),[u]),children:e.jsx(D.div,{"data-state":ht(a),"data-disabled":i?"":void 0,...d,ref:o})})});Ln.displayName=Ue;var Fn="CollapsibleTrigger",Bn=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,...r}=t,s=pt(Fn,n);return e.jsx(D.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":ht(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:o,onClick:A(t.onClick,s.onOpenToggle)})});Bn.displayName=Fn;var mt="CollapsibleContent",Vn=l.forwardRef((t,o)=>{const{forceMount:n,...r}=t,s=pt(mt,t.__scopeCollapsible);return e.jsx(Vt,{present:n||s.open,children:({present:i})=>e.jsx(Hr,{...r,ref:o,present:i})})});Vn.displayName=mt;var Hr=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,present:r,children:s,...i}=t,c=pt(mt,n),[d,a]=l.useState(r),u=l.useRef(null),h=K(o,u),y=l.useRef(0),N=y.current,E=l.useRef(0),b=E.current,m=c.open||d,x=l.useRef(m),C=l.useRef(void 0);return l.useEffect(()=>{const p=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(p)},[]),oe(()=>{const p=u.current;if(p){C.current=C.current||{transitionDuration:p.style.transitionDuration,animationName:p.style.animationName},p.style.transitionDuration="0s",p.style.animationName="none";const w=p.getBoundingClientRect();y.current=w.height,E.current=w.width,x.current||(p.style.transitionDuration=C.current.transitionDuration,p.style.animationName=C.current.animationName),a(r)}},[c.open,r]),e.jsx(D.div,{"data-state":ht(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!m,...i,ref:h,style:{"--radix-collapsible-content-height":N?`${N}px`:void 0,"--radix-collapsible-content-width":b?`${b}px`:void 0,...t.style},children:m&&s})});function ht(t){return t?"open":"closed"}var $r=Ln,Gr=Bn,Wr=Vn,ee="Accordion",Ur=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ft,zr,Kr]=Ot(ee),[ze]=Se(ee,[Kr,kn]),xt=kn(),Hn=M.forwardRef((t,o)=>{const{type:n,...r}=t,s=r,i=r;return e.jsx(ft.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?e.jsx(Xr,{...i,ref:o}):e.jsx(Jr,{...s,ref:o})})});Hn.displayName=ee;var[$n,Yr]=ze(ee),[Gn,qr]=ze(ee,{collapsible:!1}),Jr=M.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...c}=t,[d,a]=ne({prop:n,defaultProp:r??"",onChange:s,caller:ee});return e.jsx($n,{scope:t.__scopeAccordion,value:M.useMemo(()=>d?[d]:[],[d]),onItemOpen:a,onItemClose:M.useCallback(()=>i&&a(""),[i,a]),children:e.jsx(Gn,{scope:t.__scopeAccordion,collapsible:i,children:e.jsx(Wn,{...c,ref:o})})})}),Xr=M.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=ne({prop:n,defaultProp:r??[],onChange:s,caller:ee}),a=M.useCallback(h=>d((y=[])=>[...y,h]),[d]),u=M.useCallback(h=>d((y=[])=>y.filter(N=>N!==h)),[d]);return e.jsx($n,{scope:t.__scopeAccordion,value:c,onItemOpen:a,onItemClose:u,children:e.jsx(Gn,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(Wn,{...i,ref:o})})})}),[Zr,Ke]=ze(ee),Wn=M.forwardRef((t,o)=>{const{__scopeAccordion:n,disabled:r,dir:s,orientation:i="vertical",...c}=t,d=M.useRef(null),a=K(d,o),u=zr(n),y=it(s)==="ltr",N=A(t.onKeyDown,E=>{if(!Ur.includes(E.key))return;const b=E.target,m=u().filter(T=>!T.ref.current?.disabled),x=m.findIndex(T=>T.ref.current===b),C=m.length;if(x===-1)return;E.preventDefault();let p=x;const w=0,L=C-1,g=()=>{p=x+1,p>L&&(p=w)},v=()=>{p=x-1,p<w&&(p=L)};switch(E.key){case"Home":p=w;break;case"End":p=L;break;case"ArrowRight":i==="horizontal"&&(y?g():v());break;case"ArrowDown":i==="vertical"&&g();break;case"ArrowLeft":i==="horizontal"&&(y?v():g());break;case"ArrowUp":i==="vertical"&&v();break}const S=p%C;m[S].ref.current?.focus()});return e.jsx(Zr,{scope:n,disabled:r,direction:s,orientation:i,children:e.jsx(ft.Slot,{scope:n,children:e.jsx(D.div,{...c,"data-orientation":i,ref:a,onKeyDown:r?void 0:N})})})}),Le="AccordionItem",[Qr,gt]=ze(Le),Un=M.forwardRef((t,o)=>{const{__scopeAccordion:n,value:r,...s}=t,i=Ke(Le,n),c=Yr(Le,n),d=xt(n),a=Te(),u=r&&c.value.includes(r)||!1,h=i.disabled||t.disabled;return e.jsx(Qr,{scope:n,open:u,disabled:h,triggerId:a,children:e.jsx($r,{"data-orientation":i.orientation,"data-state":Xn(u),...d,...s,ref:o,disabled:h,open:u,onOpenChange:y=>{y?c.onItemOpen(r):c.onItemClose(r)}})})});Un.displayName=Le;var zn="AccordionHeader",Kn=M.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=gt(zn,n);return e.jsx(D.h3,{"data-orientation":s.orientation,"data-state":Xn(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:o})});Kn.displayName=zn;var lt="AccordionTrigger",Yn=M.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=gt(lt,n),c=qr(lt,n),d=xt(n);return e.jsx(ft.ItemSlot,{scope:n,children:e.jsx(Gr,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...r,ref:o})})});Yn.displayName=lt;var qn="AccordionContent",Jn=M.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=gt(qn,n),c=xt(n);return e.jsx(Wr,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...r,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});Jn.displayName=qn;function Xn(t){return t?"open":"closed"}var es=Hn,ts=Un,ns=Kn,Zn=Yn,Qn=Jn;const os=es,Ie=l.forwardRef(({className:t,...o},n)=>e.jsx(ts,{ref:n,className:U("border-b",t),...o}));Ie.displayName="AccordionItem";const Pe=l.forwardRef(({className:t,children:o,...n},r)=>e.jsx(ns,{className:"flex",children:e.jsxs(Zn,{ref:r,className:U("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[o,e.jsx(ct,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Pe.displayName=Zn.displayName;const _e=l.forwardRef(({className:t,children:o,...n},r)=>e.jsx(Qn,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:e.jsx("div",{className:U("pb-4 pt-0",t),children:o})}));_e.displayName=Qn.displayName;var eo="Toggle",vt=l.forwardRef((t,o)=>{const{pressed:n,defaultPressed:r,onPressedChange:s,...i}=t,[c,d]=ne({prop:n,onChange:s,defaultProp:r??!1,caller:eo});return e.jsx(D.button,{type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":t.disabled?"":void 0,...i,ref:o,onClick:A(t.onClick,()=>{t.disabled||d(!c)})})});vt.displayName=eo;var to=vt,ie="ToggleGroup",[no]=Se(ie,[Ht]),oo=Ht(),yt=M.forwardRef((t,o)=>{const{type:n,...r}=t;if(n==="single"){const s=r;return e.jsx(rs,{...s,ref:o})}if(n==="multiple"){const s=r;return e.jsx(ss,{...s,ref:o})}throw new Error(`Missing prop \`type\` expected on \`${ie}\``)});yt.displayName=ie;var[ro,so]=no(ie),rs=M.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=ne({prop:n,defaultProp:r??"",onChange:s,caller:ie});return e.jsx(ro,{scope:t.__scopeToggleGroup,type:"single",value:M.useMemo(()=>c?[c]:[],[c]),onItemActivate:d,onItemDeactivate:M.useCallback(()=>d(""),[d]),children:e.jsx(ao,{...i,ref:o})})}),ss=M.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=ne({prop:n,defaultProp:r??[],onChange:s,caller:ie}),a=M.useCallback(h=>d((y=[])=>[...y,h]),[d]),u=M.useCallback(h=>d((y=[])=>y.filter(N=>N!==h)),[d]);return e.jsx(ro,{scope:t.__scopeToggleGroup,type:"multiple",value:c,onItemActivate:a,onItemDeactivate:u,children:e.jsx(ao,{...i,ref:o})})});yt.displayName=ie;var[as,ls]=no(ie),ao=M.forwardRef((t,o)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:s=!0,orientation:i,dir:c,loop:d=!0,...a}=t,u=oo(n),h=it(c),y={role:"group",dir:h,...a};return e.jsx(as,{scope:n,rovingFocus:s,disabled:r,children:s?e.jsx(Do,{asChild:!0,...u,orientation:i,dir:h,loop:d,children:e.jsx(D.div,{...y,ref:o})}):e.jsx(D.div,{...y,ref:o})})}),Fe="ToggleGroupItem",lo=M.forwardRef((t,o)=>{const n=so(Fe,t.__scopeToggleGroup),r=ls(Fe,t.__scopeToggleGroup),s=oo(t.__scopeToggleGroup),i=n.value.includes(t.value),c=r.disabled||t.disabled,d={...t,pressed:i,disabled:c},a=M.useRef(null);return r.rovingFocus?e.jsx(Oo,{asChild:!0,...s,focusable:!c,active:i,ref:a,children:e.jsx(It,{...d,ref:o})}):e.jsx(It,{...d,ref:o})});lo.displayName=Fe;var It=M.forwardRef((t,o)=>{const{__scopeToggleGroup:n,value:r,...s}=t,i=so(Fe,n),c={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},d=i.type==="single"?c:void 0;return e.jsx(vt,{...d,...s,ref:o,onPressedChange:a=>{a?i.onItemActivate(r):i.onItemDeactivate(r)}})}),io=yt,co=lo;const uo=yo("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),is=l.forwardRef(({className:t,variant:o,size:n,...r},s)=>e.jsx(to,{ref:s,className:U(uo({variant:o,size:n,className:t})),...r}));is.displayName=to.displayName;const po=l.createContext({size:"default",variant:"default"}),mo=l.forwardRef(({className:t,variant:o,size:n,children:r,...s},i)=>e.jsx(io,{ref:i,className:U("flex items-center justify-center gap-1",t),...s,children:e.jsx(po.Provider,{value:{variant:o,size:n},children:r})}));mo.displayName=io.displayName;const ho=l.forwardRef(({className:t,children:o,variant:n,size:r,...s},i)=>{const c=l.useContext(po);return e.jsx(co,{ref:i,className:U(uo({variant:c.variant||n,size:c.size||r}),t),...s,children:o})});ho.displayName=co.displayName;function cs(t){const o=Or(t);return o===null?t:Dn[o]}function tt(t){const o={};for(const n of t)o[n.year_month]=(o[n.year_month]??0)+Number(n.amount??0);return o}function ds(t,o){const n=Array.isArray(t.autoRevenue?.byLine)?t.autoRevenue.byLine:[],r=Array.isArray(o?.value)?o.value:[],s=new Map;for(const a of n)s.set(a.key,a);const i=[],c=new Set;for(const a of r){const u=String(a??"").trim();if(!u||c.has(u))continue;const h=s.get(u);h&&(i.push({key:u,label:u.toUpperCase(),byMonth:h.byMonth||{},total:h.yearTotal||0,isGroup:h.type==="Group"}),c.add(u))}const d=n.filter(a=>!c.has(a.key)).sort((a,u)=>(u.yearTotal||0)-(a.yearTotal||0));for(const a of d)i.push({key:a.key,label:a.key.toUpperCase(),byMonth:a.byMonth||{},total:a.yearTotal||0,isGroup:a.type==="Group"});return i}function us({data:t,sortOrder:o,activeMonth:n,onChangeMonth:r,onAddExpense:s,onAddWithdrawal:i}){const c=Array.isArray(t.months)?t.months:[],d=Array.isArray(t.fixedExpenses)?t.fixedExpenses:[],a=Array.isArray(t.variableExpenses)?t.variableExpenses:[],u=Array.isArray(t.withdrawals)?t.withdrawals:[],h=Array.isArray(t.partners)?t.partners:[],y=[...c,"TOTAL"],N=ds(t,o),E=tt(d),b=tt(a),m=n==="TOTAL",x=N.reduce((g,v)=>g+v.total,0),C=t.computed?.yearTotals?.totalExpenses||0,p=t.computed?.yearTotals?.totalWithdrawals||0,w=t.initialCash||0,L=w+x-C-p;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(fe,{children:[e.jsx(xe,{className:"py-2",children:e.jsx(ge,{className:"text-sm",children:"MONTH"})}),e.jsx(ve,{className:"py-2",children:e.jsx(mo,{type:"single",value:n,onValueChange:g=>g&&r(g),className:"flex flex-wrap justify-start gap-1",children:y.map(g=>e.jsx(ho,{value:g,className:"h-8 px-2 text-xs",children:g==="TOTAL"?"TOTAL":cs(g)},g))})})]}),e.jsxs(fe,{className:"bg-gradient-to-br from-card to-muted/20",children:[e.jsx(xe,{className:"py-2",children:e.jsx(ge,{className:"text-sm",children:"SUMMARY"})}),e.jsxs(ve,{className:"py-2 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"INITIAL CASH"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(w)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"REVENUE"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(x)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"EXPENSES"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(C+p)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"NET"}),e.jsx("p",{className:`text-sm font-bold tabular-nums ${L>=0?"text-green-600":"text-red-600"}`,children:k(L)})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["% Expense/Revenue: ",e.jsx("span",{className:"font-semibold",children:On(x>0?(C+p)/x*100:0)})]})]})]}),e.jsxs(os,{type:"multiple",defaultValue:["products"],className:"w-full",children:[e.jsxs(Ie,{value:"products",children:[e.jsx(Pe,{className:"py-2 text-sm",children:"PRODUCTS"}),e.jsx(_e,{children:e.jsx("div",{className:"space-y-1",children:N.length===0?e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:"No products. Configure Sort Order."}):N.map(g=>{const v=m?g.total:g.byMonth[n]||0;return e.jsxs("div",{className:`flex items-center justify-between py-1.5 border-b border-border/30 ${g.isGroup?"bg-muted/30":""}`,children:[e.jsx("span",{className:`text-xs ${g.isGroup?"font-semibold":"font-medium"}`,children:g.label}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:v>0?k(v):e.jsx("span",{className:"text-muted-foreground/50",children:"—"})})]},g.key)})})})]}),e.jsxs(Ie,{value:"expenses",children:[e.jsx(Pe,{className:"py-2 text-sm",children:"EXPENSES"}),e.jsxs(_e,{children:[e.jsxs(q,{size:"sm",onClick:s,className:"h-8 mb-2 w-full",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),"Add Expense"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"FIXED"}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:k(m?Object.values(E).reduce((g,v)=>g+v,0):E[n]||0)})]}),e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"VARIABLE"}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:k(m?Object.values(b).reduce((g,v)=>g+v,0):b[n]||0)})]})]})]})]}),e.jsxs(Ie,{value:"withdrawals",children:[e.jsx(Pe,{className:"py-2 text-sm",children:"WITHDRAWALS"}),e.jsxs(_e,{children:[e.jsxs(q,{size:"sm",onClick:i,className:"h-8 mb-2 w-full",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),"Add Withdrawal"]}),e.jsx("div",{className:"space-y-1",children:h.length===0?e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:"No partners."}):h.map(g=>{const v=u.filter(R=>R.partner_id===g.id),S=tt(v),T=m?Object.values(S).reduce((R,F)=>R+F,0):S[n]||0;return e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs font-medium",children:g.name.toUpperCase()}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:T>0?k(T):e.jsx("span",{className:"text-muted-foreground/50",children:"—"})})]},g.id)})})]})]})]})]})}function ps({data:t,sortOrder:o,mobileMonth:n,onChangeMobileMonth:r,onAddExpense:s,onEditExpense:i,onDeleteExpense:c,onAddWithdrawal:d,onEditWithdrawal:a,onDeleteWithdrawal:u}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"block lg:hidden",children:e.jsx(us,{data:t,sortOrder:o,activeMonth:n,onChangeMonth:r,onAddExpense:s,onAddWithdrawal:d})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(Fr,{data:t,sortOrder:o,onAddExpense:s,onEditExpense:i,onDeleteExpense:c,onAddWithdrawal:d,onEditWithdrawal:a,onDeleteWithdrawal:u})})]})}const Pt=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];function vs(){const[t,o]=l.useState([]),[n,r]=l.useState(new Date().getFullYear()),[s,i]=l.useState(null),[c,d]=l.useState(null),[a,u]=l.useState("TOTAL"),[h,y]=l.useState(!0),[N,E]=l.useState(!0),[b,m]=l.useState(null),{toast:x}=bo(),[C,p]=l.useState(!1),[w,L]=l.useState(null),[g,v]=l.useState({yearMonth:"",category:"fixed",name:"",amount:""}),[S,T]=l.useState(!1),[R,F]=l.useState(null),[I,V]=l.useState({yearMonth:"",amount:"",note:""});l.useEffect(()=>{let f=!0;async function G(){try{const[z,j]=await Promise.all([No().catch(()=>({value:[]})),jo().catch(()=>({years:[]}))]);if(!f)return;d(z??{value:[]});const _=Array.isArray(j?.years)?j.years:[];o(_);const W=_.length>0?_[_.length-1]:new Date().getFullYear();r(W);try{const P=await bt(W);f&&i(P)}catch(P){f&&m(P instanceof Error?P.message:"Failed to load balance")}}catch(z){console.warn("Balance init failed",z),f&&m("Failed to initialize balance page")}finally{f&&(y(!1),E(!1))}}return G(),()=>{f=!1}},[]);const H=l.useCallback(async f=>{if(!N){y(!0),m(null);try{const z=await bt(f??n);i(z);const j=Array.isArray(z?.months)?z.months:[];j.length&&a!=="TOTAL"&&!j.includes(a)&&u("TOTAL")}catch(G){m(G instanceof Error?G.message:"Failed to load balance")}finally{y(!1)}}},[n,a,N]);l.useEffect(()=>{N||H(n)},[n]);const J=async()=>{try{await Co({yearMonth:g.yearMonth,category:g.category,name:g.name,amount:parseFloat(g.amount)}),x({title:"Expense created successfully"}),p(!1),ce(),H()}catch(f){x({title:"Error",description:f instanceof Error?f.message:"Failed to create expense",variant:"destructive"})}},X=async()=>{if(w)try{await So({id:w.id,yearMonth:g.yearMonth,category:g.category,name:g.name,amount:parseFloat(g.amount)}),x({title:"Expense updated successfully"}),p(!1),L(null),ce(),H()}catch(f){x({title:"Error",description:f instanceof Error?f.message:"Failed to update expense",variant:"destructive"})}},$=async f=>{if(confirm("Are you sure you want to delete this expense?"))try{await To(f),x({title:"Expense deleted successfully"}),H()}catch(G){x({title:"Error",description:G instanceof Error?G.message:"Failed to delete expense",variant:"destructive"})}},Y=async()=>{try{await Eo({yearMonth:I.yearMonth,amount:parseFloat(I.amount),note:I.note||void 0}),x({title:"Withdrawal created successfully"}),T(!1),re(),H()}catch(f){x({title:"Error",description:f instanceof Error?f.message:"Failed to create withdrawal",variant:"destructive"})}},Z=async()=>{if(R)try{await Ro({id:R.id,yearMonth:I.yearMonth,amount:parseFloat(I.amount),note:I.note||void 0}),x({title:"Withdrawal updated successfully"}),T(!1),F(null),re(),H()}catch(f){x({title:"Error",description:f instanceof Error?f.message:"Failed to update withdrawal",variant:"destructive"})}},te=async f=>{if(confirm("Are you sure you want to delete this withdrawal?"))try{await Ao(f),x({title:"Withdrawal deleted successfully"}),H()}catch(G){x({title:"Error",description:G instanceof Error?G.message:"Failed to delete withdrawal",variant:"destructive"})}},ce=()=>{v({yearMonth:"",category:"fixed",name:"",amount:""}),L(null)},re=()=>{V({yearMonth:"",amount:"",note:""}),F(null)},be=f=>{L(f),v({yearMonth:f.year_month,category:f.category,name:f.name,amount:f.amount.toString()}),p(!0)},we=f=>{F(f),V({yearMonth:f.year_month,amount:f.amount.toString(),note:f.note||""}),T(!0)};return b?e.jsx(wo,{message:b,onRetry:H}):h||!s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Xe,{className:"h-8 w-48"}),e.jsx(Xe,{className:"h-10 w-32"})]}),e.jsx(Xe,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Balance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly revenue, expenses, withdrawals, and totals."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{htmlFor:"year-select",className:"text-xs text-muted-foreground",children:"Year"}),e.jsxs(Ee,{value:n.toString(),onValueChange:f=>r(parseInt(f,10)),disabled:t.length===0,children:[e.jsx(je,{id:"year-select",className:"w-28",children:e.jsx(Re,{placeholder:t.length?"Select":"No data"})}),e.jsx(Ce,{children:t.map(f=>e.jsx(he,{value:f.toString(),children:f},f))})]})]})]}),e.jsx(ps,{data:s,sortOrder:c,mobileMonth:a,onChangeMobileMonth:u,onAddExpense:()=>{ce(),p(!0)},onEditExpense:be,onDeleteExpense:$,onAddWithdrawal:()=>{re(),T(!0)},onEditWithdrawal:we,onDeleteWithdrawal:te}),e.jsx(jt,{open:C,onOpenChange:p,children:e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsx(Tt,{children:w?"Edit Expense":"Add Expense"}),e.jsx(Et,{children:"Add or edit an expense for a specific month."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-month",children:"Month"}),e.jsxs(Ee,{value:g.yearMonth,onValueChange:f=>v({...g,yearMonth:f}),children:[e.jsx(je,{id:"exp-month",children:e.jsx(Re,{placeholder:"Select month"})}),e.jsx(Ce,{children:s.months.map(f=>e.jsxs(he,{value:f,children:[Pt[parseInt(f.split("-")[1],10)-1]," ",f.split("-")[0]]},f))})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-category",children:"Category"}),e.jsxs(Ee,{value:g.category,onValueChange:f=>v({...g,category:f}),children:[e.jsx(je,{id:"exp-category",children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(he,{value:"fixed",children:"Fixed"}),e.jsx(he,{value:"variable",children:"Variable"})]})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-name",children:"Name"}),e.jsx(Ze,{id:"exp-name",value:g.name,onChange:f=>v({...g,name:f.target.value}),placeholder:"Expense name"})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-amount",children:"Amount"}),e.jsx(Ze,{id:"exp-amount",type:"number",step:"0.01",value:g.amount,onChange:f=>v({...g,amount:f.target.value}),placeholder:"0.00"})]})]}),e.jsxs(Rt,{children:[e.jsx(q,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(q,{onClick:w?X:J,disabled:!g.yearMonth||!g.name||!g.amount,children:w?"Update":"Create"})]})]})}),e.jsx(jt,{open:S,onOpenChange:T,children:e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsx(Tt,{children:R?"Edit Withdrawal":"Add Withdrawal"}),e.jsx(Et,{children:"Add or edit a shared withdrawal for both partners for a specific month."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-month",children:"Month"}),e.jsxs(Ee,{value:I.yearMonth,onValueChange:f=>V({...I,yearMonth:f}),children:[e.jsx(je,{id:"with-month",children:e.jsx(Re,{placeholder:"Select month"})}),e.jsx(Ce,{children:s.months.map(f=>e.jsxs(he,{value:f,children:[Pt[parseInt(f.split("-")[1],10)-1]," ",f.split("-")[0]]},f))})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-amount",children:"Amount"}),e.jsx(Ze,{id:"with-amount",type:"number",step:"0.01",value:I.amount,onChange:f=>V({...I,amount:f.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-note",children:"Note (optional)"}),e.jsx(Tn,{id:"with-note",value:I.note,onChange:f=>V({...I,note:f.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(Rt,{children:[e.jsx(q,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(q,{onClick:R?Z:Y,disabled:!I.yearMonth||!I.amount,children:R?"Update":"Create"})]})]})})]})}export{vs as default};

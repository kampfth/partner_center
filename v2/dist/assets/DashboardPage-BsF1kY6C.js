const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SalesChart-Bt5XWg4y.js","assets/index-G2r7wkM-.js","assets/index-Nf6Oz29D.css","assets/CategoricalChart-Dwmj6Dm8.js","assets/AreaChart-DcgwErCz.js","assets/CartesianChart-JuJIGBjc.js"])))=>i.map(i=>d[i]);
import{c as M,r as n,j as e,C as P,S as c,_ as W}from"./index-G2r7wkM-.js";import{f as A,E as H,B as q,L as R,I as $,C as N,a as v,b as B}from"./partnerApi-d6DAV4oQ.js";import{f as i,s as C}from"./format-DiB1zjxr.js";const O=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Q=M("calendar-days",O);const V=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],G=M("dollar-sign",V);const J=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],K=M("shopping-cart",J);const X=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Y=M("trending-up",X),Z=n.lazy(()=>W(()=>import("./SalesChart-Bt5XWg4y.js"),__vite__mapDeps([0,1,2,3,4,5])));function b(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}function g(){return e.jsx(N,{children:e.jsxs(v,{className:"p-4 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(c,{className:"h-3 w-20"}),e.jsx(c,{className:"h-4 w-4 rounded"})]}),e.jsx(c,{className:"h-7 w-24"}),e.jsx(c,{className:"h-3 w-16 mt-1.5"})]})})}function p({title:a,value:u,icon:l,subtitle:f}){return e.jsx(N,{children:e.jsxs(v,{className:"p-4 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:a}),e.jsx(l,{className:"h-4 w-4 text-muted-foreground",strokeWidth:1.5})]}),e.jsx("div",{className:"text-2xl font-semibold tracking-tight tabular-nums",children:u}),f&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1.5",children:f})]})})}function ee({product:a,rank:u}){const l=a.units_sold>0?a.total_amount/a.units_sold:0;return e.jsxs("div",{className:"flex items-center gap-3 py-2.5 border-b border-border/20 last:border-0",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-secondary text-xs font-medium text-muted-foreground",children:u}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a.display_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.units_sold.toLocaleString()," units"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold tabular-nums",children:b(a.total_amount)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["avg ",b(l)]})]})]})}function ne(){const[a,u]=n.useState(null),[l,f]=n.useState(null),[o,x]=n.useState(""),[m,y]=n.useState(""),[d,z]=n.useState(null),[D,E]=n.useState(!0),[j,I]=n.useState(!0),[F,L]=n.useState(null);n.useEffect(()=>{async function t(){try{const s=await B();if(u(s.min_date),f(s.max_date),s.max_date){const r=new Date(s.max_date),_=i(C(r),"yyyy-MM-dd");x(_),y(s.max_date)}else{const r=new Date;x(i(C(r),"yyyy-MM-dd")),y(i(r,"yyyy-MM-dd"))}}catch(s){console.error("Failed to load date range:",s);const r=new Date;x(i(C(r),"yyyy-MM-dd")),y(i(r,"yyyy-MM-dd"))}finally{I(!1)}}t()},[]);const w=n.useCallback(async()=>{if(!(!o||!m)){E(!0),L(null);try{const t=await A(o,m);z(t)}catch(t){L(t instanceof Error?t.message:"Failed to load data")}finally{E(!1)}}},[o,m]);n.useEffect(()=>{!j&&o&&m&&w()},[w,j,o,m]);const h=n.useMemo(()=>{if(!d)return null;const t=d.summary.reduce((S,k)=>S+k.total_amount,0),s=d.summary.reduce((S,k)=>S+k.units_sold,0),r=s>0?t/s:0,_=d.daily.length;return{totalSales:t,totalUnits:s,avgPerUnit:r,daysWithData:_}},[d]),U=n.useMemo(()=>d?.daily?d.daily.map(t=>({date:i(new Date(t.date),"MMM dd"),sales:t.total_amount,transactions:t.total_units})):[],[d]),T=t=>{if(!l)return;const s=new Date(l),r=new Date(s);r.setDate(r.getDate()-t+1),a&&r<new Date(a)?x(a):x(i(r,"yyyy-MM-dd")),y(l)};return F?e.jsx(H,{message:F,onRetry:w}):e.jsxs("div",{className:"space-y-5 fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Sales overview"})]}),l&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last Sale"}),e.jsx("p",{className:"text-sm font-medium",children:i(new Date(l),"MMM d, yyyy")})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[e.jsx("div",{className:"flex gap-2",children:[7,30,90].map(t=>e.jsxs(q,{variant:"secondary",size:"sm",onClick:()=>T(t),className:"bg-secondary/80 hover:bg-secondary border border-border/50",disabled:!l,children:[t,"d"]},t))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(R,{htmlFor:"start",className:"text-xs text-muted-foreground",children:"From"}),e.jsx($,{id:"start",type:"date",value:o,min:a||void 0,max:l||void 0,onChange:t=>x(t.target.value)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(R,{htmlFor:"end",className:"text-xs text-muted-foreground",children:"To"}),e.jsx($,{id:"end",type:"date",value:m,min:a||void 0,max:l||void 0,onChange:t=>y(t.target.value)})]})]})]})]}),e.jsx("div",{className:"grid gap-3 grid-cols-2 lg:grid-cols-4",children:D||j?e.jsxs(e.Fragment,{children:[e.jsx(g,{}),e.jsx(g,{}),e.jsx(g,{}),e.jsx(g,{})]}):h?e.jsxs(e.Fragment,{children:[e.jsx(p,{title:"Total Sales",value:b(h.totalSales),icon:G,subtitle:`${h.daysWithData} days`}),e.jsx(p,{title:"Units Sold",value:h.totalUnits.toLocaleString(),icon:K}),e.jsx(p,{title:"Avg/Unit",value:b(h.avgPerUnit),icon:Y}),e.jsx(p,{title:"Period",value:`${h.daysWithData}d`,icon:Q,subtitle:o&&m?`${i(new Date(o),"MMM d")} â€“ ${i(new Date(m),"MMM d")}`:""})]}):null}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(N,{children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-base font-semibold",children:"Daily Sales"})}),e.jsx(v,{className:"pt-0",children:D||j?e.jsx(P,{}):U.length>0?e.jsx(n.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(Z,{data:U})}):e.jsx("p",{className:"py-12 text-center text-sm text-muted-foreground",children:"No data for selected period"})})]}),e.jsxs(N,{children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-base font-semibold",children:"Top Products"})}),e.jsx(v,{className:"pt-0",children:D||j?e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(t=>e.jsxs("div",{className:"flex items-center gap-3 py-2.5",children:[e.jsx(c,{className:"w-6 h-6 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(c,{className:"h-4 w-28 mb-1"}),e.jsx(c,{className:"h-3 w-16"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(c,{className:"h-4 w-16 mb-1"}),e.jsx(c,{className:"h-3 w-12"})]})]},t))}):d?.summary&&d.summary.length>0?e.jsx("div",{children:d.summary.sort((t,s)=>s.total_amount-t.total_amount).slice(0,5).map((t,s)=>e.jsx(ee,{product:t,rank:s+1},t.product_id||t.group_id||t.display_name))}):e.jsx("p",{className:"py-12 text-center text-sm text-muted-foreground",children:"No products found"})})]})]})]})}export{ne as default};

import{c as it,r as l,j as e,h as ho,i as Be,u as oe,R as _t,a as Se,k as Mt,l as z,m as re,P as O,V as fo,A as Ot,b as A,n as xo,o as Dt,p as go,D as kt,q as Lt,s as Ft,e as G,d as Bt,t as P,g as vo,f as yo,S as Xe}from"./index-m1y0idD7.js";import{C as xe,c as ge,d as ve,a as ye,B as q,o as bo,y as wo,z as No,E as jo,L as se,I as Ze,A as Co,D as So,F as To,G as Eo,H as Ro,J as Ao}from"./partnerApi-CpOYvPTw.js";import{u as ct,a as Te,h as Po,i as Io,j as _o,F as Mo,P as Me,T as wt,c as Vt,I as Oo,R as Do,D as Nt,b as jt,d as Ct,e as St,f as Tt,g as Et}from"./dialog-BdBAfi3J.js";import{C as ko}from"./check-CaptvDUB.js";const Lo=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dt=it("chevron-down",Lo);const Fo=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Bo=it("chevron-up",Fo);const Vo=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Rt=it("pen",Vo);function At(t,[o,n]){return Math.min(n,Math.max(o,t))}function Ho(t){const o=$o(t),n=l.forwardRef((r,s)=>{const{children:i,...c}=r,d=l.Children.toArray(i),a=d.find(Wo);if(a){const u=a.props.children,p=d.map(b=>b===a?l.Children.count(u)>1?l.Children.only(null):l.isValidElement(u)?u.props.children:null:b);return e.jsx(o,{...c,ref:s,children:l.isValidElement(u)?l.cloneElement(u,void 0,p):null})}return e.jsx(o,{...c,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function $o(t){const o=l.forwardRef((n,r)=>{const{children:s,...i}=n;if(l.isValidElement(s)){const c=zo(s),d=Uo(i,s.props);return s.type!==l.Fragment&&(d.ref=r?ho(r,c):c),l.cloneElement(s,d)}return l.Children.count(s)>1?l.Children.only(null):null});return o.displayName=`${t}.SlotClone`,o}var Go=Symbol("radix.slottable");function Wo(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Go}function Uo(t,o){const n={...o};for(const r in o){const s=t[r],i=o[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...d)=>{const a=i(...d);return s(...d),a}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function zo(t){let o=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning;return n?t.ref:(o=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=o&&"isReactWarning"in o&&o.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Ko(t){const o=l.useRef({value:t,previous:t});return l.useMemo(()=>(o.current.value!==t&&(o.current.previous=o.current.value,o.current.value=t),o.current.previous),[t])}var Yo=[" ","Enter","ArrowUp","ArrowDown"],qo=[" ","Enter"],pe="Select",[Ve,He,Jo]=Mt(pe),[be]=Se(pe,[Jo,Be]),$e=Be(),[Xo,ae]=be(pe),[Zo,Qo]=be(pe),Ht=t=>{const{__scopeSelect:o,children:n,open:r,defaultOpen:s,onOpenChange:i,value:c,defaultValue:d,onValueChange:a,dir:u,name:p,autoComplete:b,disabled:j,required:T,form:f}=t,h=$e(o),[y,w]=l.useState(null),[m,g]=l.useState(null),[I,C]=l.useState(!1),v=ct(u),[N,R]=oe({prop:r,defaultProp:s??!1,onChange:i,caller:pe}),[E,L]=oe({prop:c,defaultProp:d,onChange:a,caller:pe}),H=l.useRef(null),D=y?f||!!y.closest("form"):!0,[te,J]=l.useState(new Set),X=Array.from(te).map($=>$.props.value).join(";");return e.jsx(_t,{...h,children:e.jsxs(Xo,{required:T,scope:o,trigger:y,onTriggerChange:w,valueNode:m,onValueNodeChange:g,valueNodeHasChildren:I,onValueNodeHasChildrenChange:C,contentId:Te(),value:E,onValueChange:L,open:N,onOpenChange:R,dir:v,triggerPointerDownPosRef:H,disabled:j,children:[e.jsx(Ve.Provider,{scope:o,children:e.jsx(Zo,{scope:t.__scopeSelect,onNativeOptionAdd:l.useCallback($=>{J(K=>new Set(K).add($))},[]),onNativeOptionRemove:l.useCallback($=>{J(K=>{const Z=new Set(K);return Z.delete($),Z})},[]),children:n})}),D?e.jsxs(pn,{"aria-hidden":!0,required:T,tabIndex:-1,name:p,autoComplete:b,value:E,onChange:$=>L($.target.value),disabled:j,form:f,children:[E===void 0?e.jsx("option",{value:""}):null,Array.from(te)]},X):null]})})};Ht.displayName=pe;var $t="SelectTrigger",Gt=l.forwardRef((t,o)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=$e(n),c=ae($t,n),d=c.disabled||r,a=z(o,c.onTriggerChange),u=He(n),p=l.useRef("touch"),[b,j,T]=hn(h=>{const y=u().filter(g=>!g.disabled),w=y.find(g=>g.value===c.value),m=fn(y,h,w);m!==void 0&&c.onValueChange(m.value)}),f=h=>{d||(c.onOpenChange(!0),T()),h&&(c.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return e.jsx(Ot,{asChild:!0,...i,children:e.jsx(O.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":mn(c.value)?"":void 0,...s,ref:a,onClick:A(s.onClick,h=>{h.currentTarget.focus(),p.current!=="mouse"&&f(h)}),onPointerDown:A(s.onPointerDown,h=>{p.current=h.pointerType;const y=h.target;y.hasPointerCapture(h.pointerId)&&y.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(f(h),h.preventDefault())}),onKeyDown:A(s.onKeyDown,h=>{const y=b.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&j(h.key),!(y&&h.key===" ")&&Yo.includes(h.key)&&(f(),h.preventDefault())})})})});Gt.displayName=$t;var Wt="SelectValue",Ut=l.forwardRef((t,o)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:c="",...d}=t,a=ae(Wt,n),{onValueNodeHasChildrenChange:u}=a,p=i!==void 0,b=z(o,a.onValueNodeChange);return re(()=>{u(p)},[u,p]),e.jsx(O.span,{...d,ref:b,style:{pointerEvents:"none"},children:mn(a.value)?e.jsx(e.Fragment,{children:c}):i})});Ut.displayName=Wt;var er="SelectIcon",zt=l.forwardRef((t,o)=>{const{__scopeSelect:n,children:r,...s}=t;return e.jsx(O.span,{"aria-hidden":!0,...s,ref:o,children:r||"▼"})});zt.displayName=er;var tr="SelectPortal",Kt=t=>e.jsx(xo,{asChild:!0,...t});Kt.displayName=tr;var me="SelectContent",Yt=l.forwardRef((t,o)=>{const n=ae(me,t.__scopeSelect),[r,s]=l.useState();if(re(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?Dt.createPortal(e.jsx(qt,{scope:t.__scopeSelect,children:e.jsx(Ve.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),i):null}return e.jsx(Jt,{...t,ref:o})});Yt.displayName=me;var Q=10,[qt,le]=be(me),nr="SelectContentImpl",or=Ho("SelectContent.RemoveScroll"),Jt=l.forwardRef((t,o)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:c,side:d,sideOffset:a,align:u,alignOffset:p,arrowPadding:b,collisionBoundary:j,collisionPadding:T,sticky:f,hideWhenDetached:h,avoidCollisions:y,...w}=t,m=ae(me,n),[g,I]=l.useState(null),[C,v]=l.useState(null),N=z(o,S=>I(S)),[R,E]=l.useState(null),[L,H]=l.useState(null),D=He(n),[te,J]=l.useState(!1),X=l.useRef(!1);l.useEffect(()=>{if(g)return Po(g)},[g]),Io();const $=l.useCallback(S=>{const[B,...U]=D().map(V=>V.ref.current),[_]=U.slice(-1),M=document.activeElement;for(const V of S)if(V===M||(V?.scrollIntoView({block:"nearest"}),V===B&&C&&(C.scrollTop=0),V===_&&C&&(C.scrollTop=C.scrollHeight),V?.focus(),document.activeElement!==M))return},[D,C]),K=l.useCallback(()=>$([R,g]),[$,R,g]);l.useEffect(()=>{te&&K()},[te,K]);const{onOpenChange:Z,triggerPointerDownPosRef:Y}=m;l.useEffect(()=>{if(g){let S={x:0,y:0};const B=_=>{S={x:Math.abs(Math.round(_.pageX)-(Y.current?.x??0)),y:Math.abs(Math.round(_.pageY)-(Y.current?.y??0))}},U=_=>{S.x<=10&&S.y<=10?_.preventDefault():g.contains(_.target)||Z(!1),document.removeEventListener("pointermove",B),Y.current=null};return Y.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",U,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",U,{capture:!0})}}},[g,Z,Y]),l.useEffect(()=>{const S=()=>Z(!1);return window.addEventListener("blur",S),window.addEventListener("resize",S),()=>{window.removeEventListener("blur",S),window.removeEventListener("resize",S)}},[Z]);const[ce,he]=hn(S=>{const B=D().filter(M=>!M.disabled),U=B.find(M=>M.ref.current===document.activeElement),_=fn(B,S,U);_&&setTimeout(()=>_.ref.current.focus())}),we=l.useCallback((S,B,U)=>{const _=!X.current&&!U;(m.value!==void 0&&m.value===B||_)&&(E(S),_&&(X.current=!0))},[m.value]),x=l.useCallback(()=>g?.focus(),[g]),F=l.useCallback((S,B,U)=>{const _=!X.current&&!U;(m.value!==void 0&&m.value===B||_)&&H(S)},[m.value]),W=r==="popper"?nt:Xt,ne=W===nt?{side:d,sideOffset:a,align:u,alignOffset:p,arrowPadding:b,collisionBoundary:j,collisionPadding:T,sticky:f,hideWhenDetached:h,avoidCollisions:y}:{};return e.jsx(qt,{scope:n,content:g,viewport:C,onViewportChange:v,itemRefCallback:we,selectedItem:R,onItemLeave:x,itemTextRefCallback:F,focusSelectedItem:K,selectedItemText:L,position:r,isPositioned:te,searchRef:ce,children:e.jsx(_o,{as:or,allowPinchZoom:!0,children:e.jsx(Mo,{asChild:!0,trapped:m.open,onMountAutoFocus:S=>{S.preventDefault()},onUnmountAutoFocus:A(s,S=>{m.trigger?.focus({preventScroll:!0}),S.preventDefault()}),children:e.jsx(kt,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:S=>S.preventDefault(),onDismiss:()=>m.onOpenChange(!1),children:e.jsx(W,{role:"listbox",id:m.contentId,"data-state":m.open?"open":"closed",dir:m.dir,onContextMenu:S=>S.preventDefault(),...w,...ne,onPlaced:()=>J(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:A(w.onKeyDown,S=>{const B=S.ctrlKey||S.altKey||S.metaKey;if(S.key==="Tab"&&S.preventDefault(),!B&&S.key.length===1&&he(S.key),["ArrowUp","ArrowDown","Home","End"].includes(S.key)){let _=D().filter(M=>!M.disabled).map(M=>M.ref.current);if(["ArrowUp","End"].includes(S.key)&&(_=_.slice().reverse()),["ArrowUp","ArrowDown"].includes(S.key)){const M=S.target,V=_.indexOf(M);_=_.slice(V+1)}setTimeout(()=>$(_)),S.preventDefault()}})})})})})})});Jt.displayName=nr;var rr="SelectItemAlignedPosition",Xt=l.forwardRef((t,o)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=ae(me,n),c=le(me,n),[d,a]=l.useState(null),[u,p]=l.useState(null),b=z(o,N=>p(N)),j=He(n),T=l.useRef(!1),f=l.useRef(!0),{viewport:h,selectedItem:y,selectedItemText:w,focusSelectedItem:m}=c,g=l.useCallback(()=>{if(i.trigger&&i.valueNode&&d&&u&&h&&y&&w){const N=i.trigger.getBoundingClientRect(),R=u.getBoundingClientRect(),E=i.valueNode.getBoundingClientRect(),L=w.getBoundingClientRect();if(i.dir!=="rtl"){const M=L.left-R.left,V=E.left-M,de=N.left-V,ue=N.width+de,Ye=Math.max(ue,R.width),qe=window.innerWidth-Q,Je=At(V,[Q,Math.max(Q,qe-Ye)]);d.style.minWidth=ue+"px",d.style.left=Je+"px"}else{const M=R.right-L.right,V=window.innerWidth-E.right-M,de=window.innerWidth-N.right-V,ue=N.width+de,Ye=Math.max(ue,R.width),qe=window.innerWidth-Q,Je=At(V,[Q,Math.max(Q,qe-Ye)]);d.style.minWidth=ue+"px",d.style.right=Je+"px"}const H=j(),D=window.innerHeight-Q*2,te=h.scrollHeight,J=window.getComputedStyle(u),X=parseInt(J.borderTopWidth,10),$=parseInt(J.paddingTop,10),K=parseInt(J.borderBottomWidth,10),Z=parseInt(J.paddingBottom,10),Y=X+$+te+Z+K,ce=Math.min(y.offsetHeight*5,Y),he=window.getComputedStyle(h),we=parseInt(he.paddingTop,10),x=parseInt(he.paddingBottom,10),F=N.top+N.height/2-Q,W=D-F,ne=y.offsetHeight/2,S=y.offsetTop+ne,B=X+$+S,U=Y-B;if(B<=F){const M=H.length>0&&y===H[H.length-1].ref.current;d.style.bottom="0px";const V=u.clientHeight-h.offsetTop-h.offsetHeight,de=Math.max(W,ne+(M?x:0)+V+K),ue=B+de;d.style.height=ue+"px"}else{const M=H.length>0&&y===H[0].ref.current;d.style.top="0px";const de=Math.max(F,X+h.offsetTop+(M?we:0)+ne)+U;d.style.height=de+"px",h.scrollTop=B-F+h.offsetTop}d.style.margin=`${Q}px 0`,d.style.minHeight=ce+"px",d.style.maxHeight=D+"px",r?.(),requestAnimationFrame(()=>T.current=!0)}},[j,i.trigger,i.valueNode,d,u,h,y,w,i.dir,r]);re(()=>g(),[g]);const[I,C]=l.useState();re(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const v=l.useCallback(N=>{N&&f.current===!0&&(g(),m?.(),f.current=!1)},[g,m]);return e.jsx(ar,{scope:n,contentWrapper:d,shouldExpandOnScrollRef:T,onScrollButtonChange:v,children:e.jsx("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I},children:e.jsx(O.div,{...s,ref:b,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Xt.displayName=rr;var sr="SelectPopperPosition",nt=l.forwardRef((t,o)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Q,...i}=t,c=$e(n);return e.jsx(Lt,{...c,...i,ref:o,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});nt.displayName=sr;var[ar,ut]=be(me,{}),ot="SelectViewport",Zt=l.forwardRef((t,o)=>{const{__scopeSelect:n,nonce:r,...s}=t,i=le(ot,n),c=ut(ot,n),d=z(o,i.onViewportChange),a=l.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(Ve.Slot,{scope:n,children:e.jsx(O.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:A(s.onScroll,u=>{const p=u.currentTarget,{contentWrapper:b,shouldExpandOnScrollRef:j}=c;if(j?.current&&b){const T=Math.abs(a.current-p.scrollTop);if(T>0){const f=window.innerHeight-Q*2,h=parseFloat(b.style.minHeight),y=parseFloat(b.style.height),w=Math.max(h,y);if(w<f){const m=w+T,g=Math.min(f,m),I=m-g;b.style.height=g+"px",b.style.bottom==="0px"&&(p.scrollTop=I>0?I:0,b.style.justifyContent="flex-end")}}}a.current=p.scrollTop})})})]})});Zt.displayName=ot;var Qt="SelectGroup",[lr,ir]=be(Qt),cr=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=Te();return e.jsx(lr,{scope:n,id:s,children:e.jsx(O.div,{role:"group","aria-labelledby":s,...r,ref:o})})});cr.displayName=Qt;var en="SelectLabel",tn=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=ir(en,n);return e.jsx(O.div,{id:s.id,...r,ref:o})});tn.displayName=en;var Oe="SelectItem",[dr,nn]=be(Oe),on=l.forwardRef((t,o)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...c}=t,d=ae(Oe,n),a=le(Oe,n),u=d.value===r,[p,b]=l.useState(i??""),[j,T]=l.useState(!1),f=z(o,m=>a.itemRefCallback?.(m,r,s)),h=Te(),y=l.useRef("touch"),w=()=>{s||(d.onValueChange(r),d.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(dr,{scope:n,value:r,disabled:s,textId:h,isSelected:u,onItemTextChange:l.useCallback(m=>{b(g=>g||(m?.textContent??"").trim())},[]),children:e.jsx(Ve.ItemSlot,{scope:n,value:r,disabled:s,textValue:p,children:e.jsx(O.div,{role:"option","aria-labelledby":h,"data-highlighted":j?"":void 0,"aria-selected":u&&j,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...c,ref:f,onFocus:A(c.onFocus,()=>T(!0)),onBlur:A(c.onBlur,()=>T(!1)),onClick:A(c.onClick,()=>{y.current!=="mouse"&&w()}),onPointerUp:A(c.onPointerUp,()=>{y.current==="mouse"&&w()}),onPointerDown:A(c.onPointerDown,m=>{y.current=m.pointerType}),onPointerMove:A(c.onPointerMove,m=>{y.current=m.pointerType,s?a.onItemLeave?.():y.current==="mouse"&&m.currentTarget.focus({preventScroll:!0})}),onPointerLeave:A(c.onPointerLeave,m=>{m.currentTarget===document.activeElement&&a.onItemLeave?.()}),onKeyDown:A(c.onKeyDown,m=>{a.searchRef?.current!==""&&m.key===" "||(qo.includes(m.key)&&w(),m.key===" "&&m.preventDefault())})})})})});on.displayName=Oe;var Ne="SelectItemText",rn=l.forwardRef((t,o)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,c=ae(Ne,n),d=le(Ne,n),a=nn(Ne,n),u=Qo(Ne,n),[p,b]=l.useState(null),j=z(o,w=>b(w),a.onItemTextChange,w=>d.itemTextRefCallback?.(w,a.value,a.disabled)),T=p?.textContent,f=l.useMemo(()=>e.jsx("option",{value:a.value,disabled:a.disabled,children:T},a.value),[a.disabled,a.value,T]),{onNativeOptionAdd:h,onNativeOptionRemove:y}=u;return re(()=>(h(f),()=>y(f)),[h,y,f]),e.jsxs(e.Fragment,{children:[e.jsx(O.span,{id:a.textId,...i,ref:j}),a.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Dt.createPortal(i.children,c.valueNode):null]})});rn.displayName=Ne;var sn="SelectItemIndicator",an=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t;return nn(sn,n).isSelected?e.jsx(O.span,{"aria-hidden":!0,...r,ref:o}):null});an.displayName=sn;var rt="SelectScrollUpButton",ln=l.forwardRef((t,o)=>{const n=le(rt,t.__scopeSelect),r=ut(rt,t.__scopeSelect),[s,i]=l.useState(!1),c=z(o,r.onScrollButtonChange);return re(()=>{if(n.viewport&&n.isPositioned){let d=function(){const u=a.scrollTop>0;i(u)};const a=n.viewport;return d(),a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[n.viewport,n.isPositioned]),s?e.jsx(dn,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:a}=n;d&&a&&(d.scrollTop=d.scrollTop-a.offsetHeight)}}):null});ln.displayName=rt;var st="SelectScrollDownButton",cn=l.forwardRef((t,o)=>{const n=le(st,t.__scopeSelect),r=ut(st,t.__scopeSelect),[s,i]=l.useState(!1),c=z(o,r.onScrollButtonChange);return re(()=>{if(n.viewport&&n.isPositioned){let d=function(){const u=a.scrollHeight-a.clientHeight,p=Math.ceil(a.scrollTop)<u;i(p)};const a=n.viewport;return d(),a.addEventListener("scroll",d),()=>a.removeEventListener("scroll",d)}},[n.viewport,n.isPositioned]),s?e.jsx(dn,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:a}=n;d&&a&&(d.scrollTop=d.scrollTop+a.offsetHeight)}}):null});cn.displayName=st;var dn=l.forwardRef((t,o)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=le("SelectScrollButton",n),c=l.useRef(null),d=He(n),a=l.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return l.useEffect(()=>()=>a(),[a]),re(()=>{d().find(p=>p.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),e.jsx(O.div,{"aria-hidden":!0,...s,ref:o,style:{flexShrink:0,...s.style},onPointerDown:A(s.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(r,50))}),onPointerMove:A(s.onPointerMove,()=>{i.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(r,50))}),onPointerLeave:A(s.onPointerLeave,()=>{a()})})}),ur="SelectSeparator",un=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t;return e.jsx(O.div,{"aria-hidden":!0,...r,ref:o})});un.displayName=ur;var at="SelectArrow",pr=l.forwardRef((t,o)=>{const{__scopeSelect:n,...r}=t,s=$e(n),i=ae(at,n),c=le(at,n);return i.open&&c.position==="popper"?e.jsx(Ft,{...s,...r,ref:o}):null});pr.displayName=at;var mr="SelectBubbleInput",pn=l.forwardRef(({__scopeSelect:t,value:o,...n},r)=>{const s=l.useRef(null),i=z(r,s),c=Ko(o);return l.useEffect(()=>{const d=s.current;if(!d)return;const a=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(a,"value").set;if(c!==o&&p){const b=new Event("change",{bubbles:!0});p.call(d,o),d.dispatchEvent(b)}},[c,o]),e.jsx(O.select,{...n,style:{...fo,...n.style},ref:i,defaultValue:o})});pn.displayName=mr;function mn(t){return t===""||t===void 0}function hn(t){const o=go(t),n=l.useRef(""),r=l.useRef(0),s=l.useCallback(c=>{const d=n.current+c;o(d),(function a(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>a(""),1e3))})(d)},[o]),i=l.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function fn(t,o,n){const s=o.length>1&&Array.from(o).every(u=>u===o[0])?o[0]:o,i=n?t.indexOf(n):-1;let c=hr(t,Math.max(i,0));s.length===1&&(c=c.filter(u=>u!==n));const a=c.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return a!==n?a:void 0}function hr(t,o){return t.map((n,r)=>t[(o+r)%t.length])}var fr=Ht,xn=Gt,xr=Ut,gr=zt,vr=Kt,gn=Yt,yr=Zt,vn=tn,yn=on,br=rn,wr=an,bn=ln,wn=cn,Nn=un;const Ee=fr,Re=xr,je=l.forwardRef(({className:t,children:o,...n},r)=>e.jsxs(xn,{ref:r,className:G("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[o,e.jsx(gr,{asChild:!0,children:e.jsx(dt,{className:"h-4 w-4 opacity-50"})})]}));je.displayName=xn.displayName;const jn=l.forwardRef(({className:t,...o},n)=>e.jsx(bn,{ref:n,className:G("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(Bo,{className:"h-4 w-4"})}));jn.displayName=bn.displayName;const Cn=l.forwardRef(({className:t,...o},n)=>e.jsx(wn,{ref:n,className:G("flex cursor-default items-center justify-center py-1",t),...o,children:e.jsx(dt,{className:"h-4 w-4"})}));Cn.displayName=wn.displayName;const Ce=l.forwardRef(({className:t,children:o,position:n="popper",...r},s)=>e.jsx(vr,{children:e.jsxs(gn,{ref:s,className:G("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[e.jsx(jn,{}),e.jsx(yr,{className:G("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:o}),e.jsx(Cn,{})]})}));Ce.displayName=gn.displayName;const Nr=l.forwardRef(({className:t,...o},n)=>e.jsx(vn,{ref:n,className:G("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...o}));Nr.displayName=vn.displayName;const fe=l.forwardRef(({className:t,children:o,...n},r)=>e.jsxs(yn,{ref:r,className:G("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(wr,{children:e.jsx(ko,{className:"h-4 w-4"})})}),e.jsx(br,{children:o})]}));fe.displayName=yn.displayName;const jr=l.forwardRef(({className:t,...o},n)=>e.jsx(Nn,{ref:n,className:G("-mx-1 my-1 h-px bg-muted",t),...o}));jr.displayName=Nn.displayName;const Sn=l.forwardRef(({className:t,...o},n)=>e.jsx("textarea",{className:G("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...o}));Sn.displayName="Textarea";var Qe,Ge="HoverCard",[Tn]=Se(Ge,[Be]),We=Be(),[Cr,pt]=Tn(Ge),En=t=>{const{__scopeHoverCard:o,children:n,open:r,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=t,a=We(o),u=l.useRef(0),p=l.useRef(0),b=l.useRef(!1),j=l.useRef(!1),[T,f]=oe({prop:r,defaultProp:s??!1,onChange:i,caller:Ge}),h=l.useCallback(()=>{clearTimeout(p.current),u.current=window.setTimeout(()=>f(!0),c)},[c,f]),y=l.useCallback(()=>{clearTimeout(u.current),!b.current&&!j.current&&(p.current=window.setTimeout(()=>f(!1),d))},[d,f]),w=l.useCallback(()=>f(!1),[f]);return l.useEffect(()=>()=>{clearTimeout(u.current),clearTimeout(p.current)},[]),e.jsx(Cr,{scope:o,open:T,onOpenChange:f,onOpen:h,onClose:y,onDismiss:w,hasSelectionRef:b,isPointerDownOnContentRef:j,children:e.jsx(_t,{...a,children:n})})};En.displayName=Ge;var Rn="HoverCardTrigger",An=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,...r}=t,s=pt(Rn,n),i=We(n);return e.jsx(Ot,{asChild:!0,...i,children:e.jsx(O.a,{"data-state":s.open?"open":"closed",...r,ref:o,onPointerEnter:A(t.onPointerEnter,ke(s.onOpen)),onPointerLeave:A(t.onPointerLeave,ke(s.onClose)),onFocus:A(t.onFocus,s.onOpen),onBlur:A(t.onBlur,s.onClose),onTouchStart:A(t.onTouchStart,c=>c.preventDefault())})})});An.displayName=Rn;var Sr="HoverCardPortal",[vs,Tr]=Tn(Sr,{forceMount:void 0}),De="HoverCardContent",Pn=l.forwardRef((t,o)=>{const n=Tr(De,t.__scopeHoverCard),{forceMount:r=n.forceMount,...s}=t,i=pt(De,t.__scopeHoverCard);return e.jsx(Bt,{present:r||i.open,children:e.jsx(Er,{"data-state":i.open?"open":"closed",...s,onPointerEnter:A(t.onPointerEnter,ke(i.onOpen)),onPointerLeave:A(t.onPointerLeave,ke(i.onClose)),ref:o})})});Pn.displayName=De;var Er=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=t,a=pt(De,n),u=We(n),p=l.useRef(null),b=z(o,p),[j,T]=l.useState(!1);return l.useEffect(()=>{if(j){const f=document.body;return Qe=f.style.userSelect||f.style.webkitUserSelect,f.style.userSelect="none",f.style.webkitUserSelect="none",()=>{f.style.userSelect=Qe,f.style.webkitUserSelect=Qe}}},[j]),l.useEffect(()=>{if(p.current){const f=()=>{T(!1),a.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(a.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",f),()=>{document.removeEventListener("pointerup",f),a.hasSelectionRef.current=!1,a.isPointerDownOnContentRef.current=!1}}},[a.isPointerDownOnContentRef,a.hasSelectionRef]),l.useEffect(()=>{p.current&&Pr(p.current).forEach(h=>h.setAttribute("tabindex","-1"))}),e.jsx(kt,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:A(i,f=>{f.preventDefault()}),onDismiss:a.onDismiss,children:e.jsx(Lt,{...u,...d,onPointerDown:A(d.onPointerDown,f=>{f.currentTarget.contains(f.target)&&T(!0),a.hasSelectionRef.current=!1,a.isPointerDownOnContentRef.current=!0}),ref:b,style:{...d.style,userSelect:j?"text":void 0,WebkitUserSelect:j?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Rr="HoverCardArrow",Ar=l.forwardRef((t,o)=>{const{__scopeHoverCard:n,...r}=t,s=We(n);return e.jsx(Ft,{...s,...r,ref:o})});Ar.displayName=Rr;function ke(t){return o=>o.pointerType==="touch"?void 0:t()}function Pr(t){const o=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;n.nextNode();)o.push(n.currentNode);return o}var Ir=En,_r=An,In=Pn;const Mr=Ir,Or=_r,_n=l.forwardRef(({className:t,align:o="center",sideOffset:n=4,...r},s)=>e.jsx(In,{ref:s,align:o,sideOffset:n,className:G("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));_n.displayName=In.displayName;function k(t){return Number.isFinite(t)?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t):"$0.00"}function Mn(t){return Number.isFinite(t)?`${t.toFixed(2)}%`:"0.00%"}const On=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];function Dr(t){const o=t.split("-");if(o.length!==2)return null;const n=Number(o[1]);return!Number.isFinite(n)||n<1||n>12?null:n-1}function Ae(t){const o=t.split("-");if(o.length!==2)return t;const n=Number(o[1]);return!Number.isFinite(n)||n<1||n>12?t:On[n-1]}function et(t,o,n){if(o.length===0)return"future";let r=null;for(let s=o.length-1;s>=0;s--){const i=o[s];if((n.autoRevenue?.byMonth?.[i]??0)>0){r=i;break}}return r?t===r?"current":t<r?"closed":"future":"future"}function kr(t){const o={};for(const n of t)o[n.name]||(o[n.name]={byMonth:{},ids:[],yearTotal:0}),o[n.name].byMonth[n.year_month]=(o[n.name].byMonth[n.year_month]??0)+Number(n.amount??0),o[n.name].yearTotal+=Number(n.amount??0),o[n.name].ids.push(n.id);return o}function Lr(t,o){const n={};for(const r of o)n[r.id]={byMonth:{},idsByMonth:{},yearTotal:0,withdrawalIds:[]};for(const r of t){const s=r.partner_id;if(!s)continue;let i=null;for(const c of o)if(c.id===s||c.id.toLowerCase()===s.toLowerCase()){i=c.id;break}if(i&&n[i]){const c=Number(r.amount)||0;n[i].byMonth[r.year_month]=(n[i].byMonth[r.year_month]||0)+c,n[i].yearTotal+=c,n[i].withdrawalIds.push(r.id),n[i].idsByMonth[r.year_month]||(n[i].idsByMonth[r.year_month]=[]),n[i].idsByMonth[r.year_month].push(r.id)}}return n}function Fr(t,o){const n=Array.isArray(t.autoRevenue?.byLine)?t.autoRevenue.byLine:[],r=Array.isArray(o?.value)?o.value:[],s=new Map;for(const a of n)s.set(a.key,a);const i=[],c=new Set;for(const a of r){const u=String(a??"").trim();if(!u||c.has(u))continue;const p=s.get(u);p&&(i.push({key:u,label:u.toUpperCase(),byMonth:p.byMonth||{},total:p.yearTotal||0,isGroup:p.type==="Group"}),c.add(u))}const d=n.filter(a=>!c.has(a.key)).sort((a,u)=>(u.yearTotal||0)-(a.yearTotal||0));for(const a of d)i.push({key:a.key,label:a.key.toUpperCase(),byMonth:a.byMonth||{},total:a.yearTotal||0,isGroup:a.type==="Group"});return i}function Br({data:t,sortOrder:o,onAddExpense:n,onEditExpense:r,onDeleteExpense:s,onAddWithdrawal:i,onEditWithdrawal:c,onDeleteWithdrawal:d}){const a=Array.isArray(t.months)?t.months:[],u=Array.isArray(t.fixedExpenses)?t.fixedExpenses:[],p=Array.isArray(t.variableExpenses)?t.variableExpenses:[],b=Array.isArray(t.withdrawals)?t.withdrawals:[],j=Array.isArray(t.partners)?t.partners:[],T=[...u,...p],f=kr(T),h=Lr(b,j),y=Fr(t,o),w=y.reduce((v,N)=>v+N.total,0),m=t.computed?.yearTotals?.totalExpenses||0,g=t.computed?.yearTotals?.totalWithdrawals||0,C=(t.initialCash||0)+w-m-g;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(xe,{className:"bg-gradient-to-br from-card to-muted/20",children:[e.jsx(ge,{className:"py-0 h-[54px] justify-center",children:e.jsx(ve,{className:"text-base",children:"SUMMARY"})}),e.jsxs(ye,{className:"py-2",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Revenue"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(w)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Expenses"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(m+g)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Net"}),e.jsx("p",{className:`text-lg font-bold tabular-nums ${C>=0?"text-green-600":"text-red-600"}`,children:k(C)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Per Partner"}),e.jsx("p",{className:"text-lg font-bold tabular-nums",children:k(j.length>0?C/j.length:0)})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["% Expense/Revenue: ",e.jsx("span",{className:"font-semibold",children:Mn(w>0?(m+g)/w*100:0)})]})]})]}),e.jsxs(xe,{children:[e.jsx(ge,{className:"py-2",children:e.jsx(ve,{className:"text-base",children:"PRODUCTS"})}),e.jsx(ye,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/40",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Product"}),a.map(v=>{const N=et(v,a,t);return e.jsx("th",{className:`py-1.5 px-1 text-right text-xs font-medium uppercase tracking-wide ${N==="current"?"italic text-foreground":"text-muted-foreground"} ${N==="closed"?"bg-green-50 dark:bg-green-950/20 font-bold":""}`,children:Ae(v)},v)}),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+2,className:"py-6 text-center text-muted-foreground",children:"No products found. Configure Sort Order in Admin."})}):e.jsxs(e.Fragment,{children:[y.map(v=>e.jsxs("tr",{className:v.isGroup?"bg-muted/30":"hover:bg-muted/20",children:[e.jsx("td",{className:`py-1.5 px-2 ${v.isGroup?"font-semibold":"font-medium"}`,children:v.label}),a.map(N=>{const R=et(N,a,t);return e.jsx("td",{className:`py-1.5 px-1 text-right tabular-nums ${R==="current"?"italic":""} ${R==="closed"?"bg-green-50 dark:bg-green-950/20 font-bold":""}`,children:v.byMonth[N]?k(v.byMonth[N]):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},N)}),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:v.total>0?k(v.total):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})})]},v.key)),e.jsxs("tr",{className:"border-t-2 border-border bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2 font-bold text-sm",children:"TOTAL"}),a.map(v=>{const N=y.reduce((E,L)=>E+(L.byMonth[v]||0),0),R=et(v,a,t);return e.jsx("td",{className:`py-2 px-1 text-right font-bold tabular-nums ${R==="current"?"italic":""} ${R==="closed"?"bg-green-50 dark:bg-green-950/20":""}`,children:N>0?k(N):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},v)}),e.jsx("td",{className:"py-2 px-2 text-right font-bold tabular-nums",children:k(w)})]})]})})]})})})]}),e.jsxs(xe,{children:[e.jsxs(ge,{className:"py-0 h-12 flex flex-row items-center justify-between space-y-0",children:[e.jsx(ve,{className:"text-base",children:"EXPENSES"}),e.jsxs(q,{size:"sm",variant:"outline",onClick:n,children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Add"]})]}),e.jsx(ye,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/40 border-b",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase",children:"Name"}),a.map(v=>e.jsx("th",{className:"py-1.5 px-1 text-right text-xs font-medium text-muted-foreground uppercase",children:Ae(v)},v)),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase",children:"Total"}),e.jsx("th",{className:"py-1.5 px-1 w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:Object.keys(f).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+3,className:"py-4 text-center text-muted-foreground text-xs",children:"No expenses."})}):Object.entries(f).map(([v,N])=>{const R=T.find(E=>E.name===v);return e.jsxs("tr",{className:"hover:bg-muted/20",children:[e.jsx("td",{className:"py-1.5 px-2 font-medium",children:v.toUpperCase()}),a.map(E=>e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:N.byMonth[E]?k(N.byMonth[E]):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},E)),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:k(N.yearTotal)}),e.jsx("td",{className:"py-1.5 px-1",children:R&&e.jsxs("div",{className:"flex items-center gap-0.5 justify-end",children:[e.jsx(q,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>r(R),children:e.jsx(Rt,{className:"h-3 w-3"})}),e.jsx(q,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>s(R.id),children:e.jsx(wt,{className:"h-3 w-3"})})]})})]},v)})})]})})})]}),e.jsxs(xe,{children:[e.jsxs(ge,{className:"py-2 flex flex-row items-center justify-between space-y-0",children:[e.jsx(ve,{className:"text-base",children:"WITHDRAWALS"}),e.jsxs(q,{size:"sm",variant:"outline",onClick:i,children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Add"]})]}),e.jsx(ye,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/40",children:[e.jsx("th",{className:"py-1.5 px-2 text-xs font-medium text-muted-foreground uppercase",children:"Partner"}),a.map(v=>e.jsx("th",{className:"py-1.5 px-1 text-right text-xs font-medium text-muted-foreground uppercase",children:Ae(v)},v)),e.jsx("th",{className:"py-1.5 px-2 text-right text-xs font-medium text-muted-foreground uppercase",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-border/50",children:j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length+2,className:"py-4 text-center text-muted-foreground text-xs",children:"No partners configured."})}):j.map(v=>{const N=h[v.id]||{byMonth:{},idsByMonth:{},yearTotal:0};return e.jsxs("tr",{className:"hover:bg-muted/20",children:[e.jsx("td",{className:"py-1.5 px-2 font-medium",children:v.name.toUpperCase()}),a.map(R=>{const E=N.byMonth[R],L=N.idsByMonth[R]||[];if(!E)return e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:e.jsx("span",{className:"text-muted-foreground/40",children:"—"})},R);const H=L.length>0?b.find(D=>D.id===L[0]):null;return e.jsx("td",{className:"py-1.5 px-1 text-right tabular-nums",children:e.jsxs(Mr,{openDelay:100,closeDelay:100,children:[e.jsx(Or,{asChild:!0,children:e.jsx("span",{className:"cursor-pointer hover:text-primary hover:underline transition-colors",children:k(E)})}),e.jsx(_n,{className:"w-auto p-2",align:"center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground mr-2",children:[Ae(R),": ",k(E)]}),H&&e.jsxs(e.Fragment,{children:[e.jsxs(q,{variant:"outline",size:"sm",className:"h-7 px-2",onClick:()=>c(H),children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),"Edit"]}),e.jsxs(q,{variant:"destructive",size:"sm",className:"h-7 px-2",onClick:()=>d(H.id),children:[e.jsx(wt,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})})]})},R)}),e.jsx("td",{className:"py-1.5 px-2 text-right font-semibold tabular-nums",children:N.yearTotal>0?k(N.yearTotal):e.jsx("span",{className:"text-muted-foreground/40",children:"—"})})]},v.id)})})]})})})]})]})}var Ue="Collapsible",[Vr,Dn]=Se(Ue),[Hr,mt]=Vr(Ue),kn=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,open:r,defaultOpen:s,disabled:i,onOpenChange:c,...d}=t,[a,u]=oe({prop:r,defaultProp:s??!1,onChange:c,caller:Ue});return e.jsx(Hr,{scope:n,disabled:i,contentId:Te(),open:a,onOpenToggle:l.useCallback(()=>u(p=>!p),[u]),children:e.jsx(O.div,{"data-state":ft(a),"data-disabled":i?"":void 0,...d,ref:o})})});kn.displayName=Ue;var Ln="CollapsibleTrigger",Fn=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,...r}=t,s=mt(Ln,n);return e.jsx(O.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":ft(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:o,onClick:A(t.onClick,s.onOpenToggle)})});Fn.displayName=Ln;var ht="CollapsibleContent",Bn=l.forwardRef((t,o)=>{const{forceMount:n,...r}=t,s=mt(ht,t.__scopeCollapsible);return e.jsx(Bt,{present:n||s.open,children:({present:i})=>e.jsx($r,{...r,ref:o,present:i})})});Bn.displayName=ht;var $r=l.forwardRef((t,o)=>{const{__scopeCollapsible:n,present:r,children:s,...i}=t,c=mt(ht,n),[d,a]=l.useState(r),u=l.useRef(null),p=z(o,u),b=l.useRef(0),j=b.current,T=l.useRef(0),f=T.current,h=c.open||d,y=l.useRef(h),w=l.useRef(void 0);return l.useEffect(()=>{const m=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(m)},[]),re(()=>{const m=u.current;if(m){w.current=w.current||{transitionDuration:m.style.transitionDuration,animationName:m.style.animationName},m.style.transitionDuration="0s",m.style.animationName="none";const g=m.getBoundingClientRect();b.current=g.height,T.current=g.width,y.current||(m.style.transitionDuration=w.current.transitionDuration,m.style.animationName=w.current.animationName),a(r)}},[c.open,r]),e.jsx(O.div,{"data-state":ft(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!h,...i,ref:p,style:{"--radix-collapsible-content-height":j?`${j}px`:void 0,"--radix-collapsible-content-width":f?`${f}px`:void 0,...t.style},children:h&&s})});function ft(t){return t?"open":"closed"}var Gr=kn,Wr=Fn,Ur=Bn,ee="Accordion",zr=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[xt,Kr,Yr]=Mt(ee),[ze]=Se(ee,[Yr,Dn]),gt=Dn(),Vn=P.forwardRef((t,o)=>{const{type:n,...r}=t,s=r,i=r;return e.jsx(xt.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?e.jsx(Zr,{...i,ref:o}):e.jsx(Xr,{...s,ref:o})})});Vn.displayName=ee;var[Hn,qr]=ze(ee),[$n,Jr]=ze(ee,{collapsible:!1}),Xr=P.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...c}=t,[d,a]=oe({prop:n,defaultProp:r??"",onChange:s,caller:ee});return e.jsx(Hn,{scope:t.__scopeAccordion,value:P.useMemo(()=>d?[d]:[],[d]),onItemOpen:a,onItemClose:P.useCallback(()=>i&&a(""),[i,a]),children:e.jsx($n,{scope:t.__scopeAccordion,collapsible:i,children:e.jsx(Gn,{...c,ref:o})})})}),Zr=P.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=oe({prop:n,defaultProp:r??[],onChange:s,caller:ee}),a=P.useCallback(p=>d((b=[])=>[...b,p]),[d]),u=P.useCallback(p=>d((b=[])=>b.filter(j=>j!==p)),[d]);return e.jsx(Hn,{scope:t.__scopeAccordion,value:c,onItemOpen:a,onItemClose:u,children:e.jsx($n,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(Gn,{...i,ref:o})})})}),[Qr,Ke]=ze(ee),Gn=P.forwardRef((t,o)=>{const{__scopeAccordion:n,disabled:r,dir:s,orientation:i="vertical",...c}=t,d=P.useRef(null),a=z(d,o),u=Kr(n),b=ct(s)==="ltr",j=A(t.onKeyDown,T=>{if(!zr.includes(T.key))return;const f=T.target,h=u().filter(R=>!R.ref.current?.disabled),y=h.findIndex(R=>R.ref.current===f),w=h.length;if(y===-1)return;T.preventDefault();let m=y;const g=0,I=w-1,C=()=>{m=y+1,m>I&&(m=g)},v=()=>{m=y-1,m<g&&(m=I)};switch(T.key){case"Home":m=g;break;case"End":m=I;break;case"ArrowRight":i==="horizontal"&&(b?C():v());break;case"ArrowDown":i==="vertical"&&C();break;case"ArrowLeft":i==="horizontal"&&(b?v():C());break;case"ArrowUp":i==="vertical"&&v();break}const N=m%w;h[N].ref.current?.focus()});return e.jsx(Qr,{scope:n,disabled:r,direction:s,orientation:i,children:e.jsx(xt.Slot,{scope:n,children:e.jsx(O.div,{...c,"data-orientation":i,ref:a,onKeyDown:r?void 0:j})})})}),Le="AccordionItem",[es,vt]=ze(Le),Wn=P.forwardRef((t,o)=>{const{__scopeAccordion:n,value:r,...s}=t,i=Ke(Le,n),c=qr(Le,n),d=gt(n),a=Te(),u=r&&c.value.includes(r)||!1,p=i.disabled||t.disabled;return e.jsx(es,{scope:n,open:u,disabled:p,triggerId:a,children:e.jsx(Gr,{"data-orientation":i.orientation,"data-state":Jn(u),...d,...s,ref:o,disabled:p,open:u,onOpenChange:b=>{b?c.onItemOpen(r):c.onItemClose(r)}})})});Wn.displayName=Le;var Un="AccordionHeader",zn=P.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=vt(Un,n);return e.jsx(O.h3,{"data-orientation":s.orientation,"data-state":Jn(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:o})});zn.displayName=Un;var lt="AccordionTrigger",Kn=P.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=vt(lt,n),c=Jr(lt,n),d=gt(n);return e.jsx(xt.ItemSlot,{scope:n,children:e.jsx(Wr,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...r,ref:o})})});Kn.displayName=lt;var Yn="AccordionContent",qn=P.forwardRef((t,o)=>{const{__scopeAccordion:n,...r}=t,s=Ke(ee,n),i=vt(Yn,n),c=gt(n);return e.jsx(Ur,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...r,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});qn.displayName=Yn;function Jn(t){return t?"open":"closed"}var ts=Vn,ns=Wn,os=zn,Xn=Kn,Zn=qn;const rs=ts,Pe=l.forwardRef(({className:t,...o},n)=>e.jsx(ns,{ref:n,className:G("border-b",t),...o}));Pe.displayName="AccordionItem";const Ie=l.forwardRef(({className:t,children:o,...n},r)=>e.jsx(os,{className:"flex",children:e.jsxs(Xn,{ref:r,className:G("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[o,e.jsx(dt,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Ie.displayName=Xn.displayName;const _e=l.forwardRef(({className:t,children:o,...n},r)=>e.jsx(Zn,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:e.jsx("div",{className:G("pb-4 pt-0",t),children:o})}));_e.displayName=Zn.displayName;var Qn="Toggle",yt=l.forwardRef((t,o)=>{const{pressed:n,defaultPressed:r,onPressedChange:s,...i}=t,[c,d]=oe({prop:n,onChange:s,defaultProp:r??!1,caller:Qn});return e.jsx(O.button,{type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":t.disabled?"":void 0,...i,ref:o,onClick:A(t.onClick,()=>{t.disabled||d(!c)})})});yt.displayName=Qn;var eo=yt,ie="ToggleGroup",[to]=Se(ie,[Vt]),no=Vt(),bt=P.forwardRef((t,o)=>{const{type:n,...r}=t;if(n==="single"){const s=r;return e.jsx(ss,{...s,ref:o})}if(n==="multiple"){const s=r;return e.jsx(as,{...s,ref:o})}throw new Error(`Missing prop \`type\` expected on \`${ie}\``)});bt.displayName=ie;var[oo,ro]=to(ie),ss=P.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=oe({prop:n,defaultProp:r??"",onChange:s,caller:ie});return e.jsx(oo,{scope:t.__scopeToggleGroup,type:"single",value:P.useMemo(()=>c?[c]:[],[c]),onItemActivate:d,onItemDeactivate:P.useCallback(()=>d(""),[d]),children:e.jsx(so,{...i,ref:o})})}),as=P.forwardRef((t,o)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=t,[c,d]=oe({prop:n,defaultProp:r??[],onChange:s,caller:ie}),a=P.useCallback(p=>d((b=[])=>[...b,p]),[d]),u=P.useCallback(p=>d((b=[])=>b.filter(j=>j!==p)),[d]);return e.jsx(oo,{scope:t.__scopeToggleGroup,type:"multiple",value:c,onItemActivate:a,onItemDeactivate:u,children:e.jsx(so,{...i,ref:o})})});bt.displayName=ie;var[ls,is]=to(ie),so=P.forwardRef((t,o)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:s=!0,orientation:i,dir:c,loop:d=!0,...a}=t,u=no(n),p=ct(c),b={role:"group",dir:p,...a};return e.jsx(ls,{scope:n,rovingFocus:s,disabled:r,children:s?e.jsx(Do,{asChild:!0,...u,orientation:i,dir:p,loop:d,children:e.jsx(O.div,{...b,ref:o})}):e.jsx(O.div,{...b,ref:o})})}),Fe="ToggleGroupItem",ao=P.forwardRef((t,o)=>{const n=ro(Fe,t.__scopeToggleGroup),r=is(Fe,t.__scopeToggleGroup),s=no(t.__scopeToggleGroup),i=n.value.includes(t.value),c=r.disabled||t.disabled,d={...t,pressed:i,disabled:c},a=P.useRef(null);return r.rovingFocus?e.jsx(Oo,{asChild:!0,...s,focusable:!c,active:i,ref:a,children:e.jsx(Pt,{...d,ref:o})}):e.jsx(Pt,{...d,ref:o})});ao.displayName=Fe;var Pt=P.forwardRef((t,o)=>{const{__scopeToggleGroup:n,value:r,...s}=t,i=ro(Fe,n),c={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},d=i.type==="single"?c:void 0;return e.jsx(yt,{...d,...s,ref:o,onPressedChange:a=>{a?i.onItemActivate(r):i.onItemDeactivate(r)}})}),lo=bt,io=ao;const co=vo("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),cs=l.forwardRef(({className:t,variant:o,size:n,...r},s)=>e.jsx(eo,{ref:s,className:G(co({variant:o,size:n,className:t})),...r}));cs.displayName=eo.displayName;const uo=l.createContext({size:"default",variant:"default"}),po=l.forwardRef(({className:t,variant:o,size:n,children:r,...s},i)=>e.jsx(lo,{ref:i,className:G("flex items-center justify-center gap-1",t),...s,children:e.jsx(uo.Provider,{value:{variant:o,size:n},children:r})}));po.displayName=lo.displayName;const mo=l.forwardRef(({className:t,children:o,variant:n,size:r,...s},i)=>{const c=l.useContext(uo);return e.jsx(io,{ref:i,className:G(co({variant:c.variant||n,size:c.size||r}),t),...s,children:o})});mo.displayName=io.displayName;function ds(t){const o=Dr(t);return o===null?t:On[o]}function tt(t){const o={};for(const n of t)o[n.year_month]=(o[n.year_month]??0)+Number(n.amount??0);return o}function us(t,o){const n=Array.isArray(t.autoRevenue?.byLine)?t.autoRevenue.byLine:[],r=Array.isArray(o?.value)?o.value:[],s=new Map;for(const a of n)s.set(a.key,a);const i=[],c=new Set;for(const a of r){const u=String(a??"").trim();if(!u||c.has(u))continue;const p=s.get(u);p&&(i.push({key:u,label:u.toUpperCase(),byMonth:p.byMonth||{},total:p.yearTotal||0,isGroup:p.type==="Group"}),c.add(u))}const d=n.filter(a=>!c.has(a.key)).sort((a,u)=>(u.yearTotal||0)-(a.yearTotal||0));for(const a of d)i.push({key:a.key,label:a.key.toUpperCase(),byMonth:a.byMonth||{},total:a.yearTotal||0,isGroup:a.type==="Group"});return i}function ps({data:t,sortOrder:o,activeMonth:n,onChangeMonth:r,onAddExpense:s,onAddWithdrawal:i}){const c=Array.isArray(t.months)?t.months:[],d=Array.isArray(t.fixedExpenses)?t.fixedExpenses:[],a=Array.isArray(t.variableExpenses)?t.variableExpenses:[],u=Array.isArray(t.withdrawals)?t.withdrawals:[],p=Array.isArray(t.partners)?t.partners:[],b=[...c,"TOTAL"],j=us(t,o),T=tt(d),f=tt(a),h=n==="TOTAL",y=j.reduce((C,v)=>C+v.total,0),w=t.computed?.yearTotals?.totalExpenses||0,m=t.computed?.yearTotals?.totalWithdrawals||0,g=t.initialCash||0,I=g+y-w-m;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(xe,{children:[e.jsx(ge,{className:"py-2",children:e.jsx(ve,{className:"text-sm",children:"MONTH"})}),e.jsx(ye,{className:"py-2",children:e.jsx(po,{type:"single",value:n,onValueChange:C=>C&&r(C),className:"flex flex-wrap justify-start gap-1",children:b.map(C=>e.jsx(mo,{value:C,className:"h-8 px-2 text-xs",children:C==="TOTAL"?"TOTAL":ds(C)},C))})})]}),e.jsxs(xe,{className:"bg-gradient-to-br from-card to-muted/20",children:[e.jsx(ge,{className:"py-2",children:e.jsx(ve,{className:"text-sm",children:"SUMMARY"})}),e.jsxs(ye,{className:"py-2 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"INITIAL CASH"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(g)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"REVENUE"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(y)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"EXPENSES"}),e.jsx("p",{className:"text-sm font-bold tabular-nums",children:k(w+m)})]}),e.jsxs("div",{className:"p-2 rounded bg-card border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"NET"}),e.jsx("p",{className:`text-sm font-bold tabular-nums ${I>=0?"text-green-600":"text-red-600"}`,children:k(I)})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["% Expense/Revenue: ",e.jsx("span",{className:"font-semibold",children:Mn(y>0?(w+m)/y*100:0)})]})]})]}),e.jsxs(rs,{type:"multiple",defaultValue:["products"],className:"w-full",children:[e.jsxs(Pe,{value:"products",children:[e.jsx(Ie,{className:"py-2 text-sm",children:"PRODUCTS"}),e.jsx(_e,{children:e.jsx("div",{className:"space-y-1",children:j.length===0?e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:"No products. Configure Sort Order."}):j.map(C=>{const v=h?C.total:C.byMonth[n]||0;return e.jsxs("div",{className:`flex items-center justify-between py-1.5 border-b border-border/30 ${C.isGroup?"bg-muted/30":""}`,children:[e.jsx("span",{className:`text-xs ${C.isGroup?"font-semibold":"font-medium"}`,children:C.label}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:v>0?k(v):e.jsx("span",{className:"text-muted-foreground/50",children:"—"})})]},C.key)})})})]}),e.jsxs(Pe,{value:"expenses",children:[e.jsx(Ie,{className:"py-2 text-sm",children:"EXPENSES"}),e.jsxs(_e,{children:[e.jsxs(q,{size:"sm",onClick:s,className:"h-8 mb-2 w-full",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),"Add Expense"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"FIXED"}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:k(h?Object.values(T).reduce((C,v)=>C+v,0):T[n]||0)})]}),e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"VARIABLE"}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:k(h?Object.values(f).reduce((C,v)=>C+v,0):f[n]||0)})]})]})]})]}),e.jsxs(Pe,{value:"withdrawals",children:[e.jsx(Ie,{className:"py-2 text-sm",children:"WITHDRAWALS"}),e.jsxs(_e,{children:[e.jsxs(q,{size:"sm",onClick:i,className:"h-8 mb-2 w-full",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),"Add Withdrawal"]}),e.jsx("div",{className:"space-y-1",children:p.length===0?e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:"No partners."}):p.map(C=>{const v=u.filter(E=>E.partner_id===C.id),N=tt(v),R=h?Object.values(N).reduce((E,L)=>E+L,0):N[n]||0;return e.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30",children:[e.jsx("span",{className:"text-xs font-medium",children:C.name.toUpperCase()}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:R>0?k(R):e.jsx("span",{className:"text-muted-foreground/50",children:"—"})})]},C.id)})})]})]})]})]})}function ms({data:t,sortOrder:o,mobileMonth:n,onChangeMobileMonth:r,onAddExpense:s,onEditExpense:i,onDeleteExpense:c,onAddWithdrawal:d,onEditWithdrawal:a,onDeleteWithdrawal:u}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"block lg:hidden",children:e.jsx(ps,{data:t,sortOrder:o,activeMonth:n,onChangeMonth:r,onAddExpense:s,onAddWithdrawal:d})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(Br,{data:t,sortOrder:o,onAddExpense:s,onEditExpense:i,onDeleteExpense:c,onAddWithdrawal:d,onEditWithdrawal:a,onDeleteWithdrawal:u})})]})}const It=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];function ys(){const[t,o]=l.useState([]),[n,r]=l.useState(new Date().getFullYear()),[s,i]=l.useState(null),[c,d]=l.useState(null),[a,u]=l.useState("TOTAL"),[p,b]=l.useState(!0),[j,T]=l.useState(null),{toast:f}=yo(),[h,y]=l.useState(!1),[w,m]=l.useState(null),[g,I]=l.useState({yearMonth:"",category:"fixed",name:"",amount:""}),[C,v]=l.useState(!1),[N,R]=l.useState(null),[E,L]=l.useState({yearMonth:"",amount:"",note:""}),H=l.useCallback(async()=>{try{const[x,F]=await Promise.all([bo(),wo()]);d(x??null);const W=Array.isArray(F?.years)?F.years:[];if(o(W),W.length){const ne=W[W.length-1];r(ne)}}catch(x){console.warn("Balance static load failed",x)}},[]),D=l.useCallback(async x=>{b(!0),T(null);try{const W=await No(x??n);i(W);const ne=Array.isArray(W?.months)?W.months:[];ne.length&&a!=="TOTAL"&&!ne.includes(a)&&u("TOTAL")}catch(F){T(F instanceof Error?F.message:"Failed to load balance")}finally{b(!1)}},[n,a]);l.useEffect(()=>{H()},[H]),l.useEffect(()=>{D(n)},[D,n]);const te=async()=>{try{await Co({yearMonth:g.yearMonth,category:g.category,name:g.name,amount:parseFloat(g.amount)}),f({title:"Expense created successfully"}),y(!1),Y(),D()}catch(x){f({title:"Error",description:x instanceof Error?x.message:"Failed to create expense",variant:"destructive"})}},J=async()=>{if(w)try{await So({id:w.id,yearMonth:g.yearMonth,category:g.category,name:g.name,amount:parseFloat(g.amount)}),f({title:"Expense updated successfully"}),y(!1),m(null),Y(),D()}catch(x){f({title:"Error",description:x instanceof Error?x.message:"Failed to update expense",variant:"destructive"})}},X=async x=>{if(confirm("Are you sure you want to delete this expense?"))try{await To(x),f({title:"Expense deleted successfully"}),D()}catch(F){f({title:"Error",description:F instanceof Error?F.message:"Failed to delete expense",variant:"destructive"})}},$=async()=>{try{await Eo({yearMonth:E.yearMonth,amount:parseFloat(E.amount),note:E.note||void 0}),f({title:"Withdrawal created successfully"}),v(!1),ce(),D()}catch(x){f({title:"Error",description:x instanceof Error?x.message:"Failed to create withdrawal",variant:"destructive"})}},K=async()=>{if(N)try{await Ro({id:N.id,yearMonth:E.yearMonth,amount:parseFloat(E.amount),note:E.note||void 0}),f({title:"Withdrawal updated successfully"}),v(!1),R(null),ce(),D()}catch(x){f({title:"Error",description:x instanceof Error?x.message:"Failed to update withdrawal",variant:"destructive"})}},Z=async x=>{if(confirm("Are you sure you want to delete this withdrawal?"))try{await Ao(x),f({title:"Withdrawal deleted successfully"}),D()}catch(F){f({title:"Error",description:F instanceof Error?F.message:"Failed to delete withdrawal",variant:"destructive"})}},Y=()=>{I({yearMonth:"",category:"fixed",name:"",amount:""}),m(null)},ce=()=>{L({yearMonth:"",amount:"",note:""}),R(null)},he=x=>{m(x),I({yearMonth:x.year_month,category:x.category,name:x.name,amount:x.amount.toString()}),y(!0)},we=x=>{R(x),L({yearMonth:x.year_month,amount:x.amount.toString(),note:x.note||""}),v(!0)};return j?e.jsx(jo,{message:j,onRetry:D}):p||!s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Xe,{className:"h-8 w-48"}),e.jsx(Xe,{className:"h-10 w-32"})]}),e.jsx(Xe,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Balance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly revenue, expenses, withdrawals, and totals."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{htmlFor:"year-select",className:"text-xs text-muted-foreground",children:"Year"}),e.jsxs(Ee,{value:n.toString(),onValueChange:x=>r(parseInt(x,10)),disabled:t.length===0,children:[e.jsx(je,{id:"year-select",className:"w-28",children:e.jsx(Re,{placeholder:t.length?"Select":"No data"})}),e.jsx(Ce,{children:t.map(x=>e.jsx(fe,{value:x.toString(),children:x},x))})]})]})]}),e.jsx(ms,{data:s,sortOrder:c,mobileMonth:a,onChangeMobileMonth:u,onAddExpense:()=>{Y(),y(!0)},onEditExpense:he,onDeleteExpense:X,onAddWithdrawal:()=>{ce(),v(!0)},onEditWithdrawal:we,onDeleteWithdrawal:Z}),e.jsx(Nt,{open:h,onOpenChange:y,children:e.jsxs(jt,{children:[e.jsxs(Ct,{children:[e.jsx(St,{children:w?"Edit Expense":"Add Expense"}),e.jsx(Tt,{children:"Add or edit an expense for a specific month."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-month",children:"Month"}),e.jsxs(Ee,{value:g.yearMonth,onValueChange:x=>I({...g,yearMonth:x}),children:[e.jsx(je,{id:"exp-month",children:e.jsx(Re,{placeholder:"Select month"})}),e.jsx(Ce,{children:s.months.map(x=>e.jsxs(fe,{value:x,children:[It[parseInt(x.split("-")[1],10)-1]," ",x.split("-")[0]]},x))})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-category",children:"Category"}),e.jsxs(Ee,{value:g.category,onValueChange:x=>I({...g,category:x}),children:[e.jsx(je,{id:"exp-category",children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(fe,{value:"fixed",children:"Fixed"}),e.jsx(fe,{value:"variable",children:"Variable"})]})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-name",children:"Name"}),e.jsx(Ze,{id:"exp-name",value:g.name,onChange:x=>I({...g,name:x.target.value}),placeholder:"Expense name"})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"exp-amount",children:"Amount"}),e.jsx(Ze,{id:"exp-amount",type:"number",step:"0.01",value:g.amount,onChange:x=>I({...g,amount:x.target.value}),placeholder:"0.00"})]})]}),e.jsxs(Et,{children:[e.jsx(q,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(q,{onClick:w?J:te,disabled:!g.yearMonth||!g.name||!g.amount,children:w?"Update":"Create"})]})]})}),e.jsx(Nt,{open:C,onOpenChange:v,children:e.jsxs(jt,{children:[e.jsxs(Ct,{children:[e.jsx(St,{children:N?"Edit Withdrawal":"Add Withdrawal"}),e.jsx(Tt,{children:"Add or edit a shared withdrawal for both partners for a specific month."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-month",children:"Month"}),e.jsxs(Ee,{value:E.yearMonth,onValueChange:x=>L({...E,yearMonth:x}),children:[e.jsx(je,{id:"with-month",children:e.jsx(Re,{placeholder:"Select month"})}),e.jsx(Ce,{children:s.months.map(x=>e.jsxs(fe,{value:x,children:[It[parseInt(x.split("-")[1],10)-1]," ",x.split("-")[0]]},x))})]})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-amount",children:"Amount"}),e.jsx(Ze,{id:"with-amount",type:"number",step:"0.01",value:E.amount,onChange:x=>L({...E,amount:x.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"with-note",children:"Note (optional)"}),e.jsx(Sn,{id:"with-note",value:E.note,onChange:x=>L({...E,note:x.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs(Et,{children:[e.jsx(q,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(q,{onClick:N?K:$,disabled:!E.yearMonth||!E.amount,children:N?"Update":"Create"})]})]})})]})}export{ys as default};

import{c as A,r,u as Ts,j as e,a as je,P as Q,b as Z,d as Ps,e as T,f as Ne,g as B,h as Es,X as te,W as $s}from"./index-Cq-jti8V.js";import{u as Is,a as Rs,c as ye,R as Ms,I as Ls,b as be,d as Fs,T as Os,P as zs,W as Vs,C as Gs,e as Us,D as qs,f as we,O as Bs,g as me,h as ne,i as Hs,j as Ce,k as ke,l as Se,m as _e,n as De,o as Ys}from"./dialog-YGZ-RHeF.js";import{S as E,d as Ae,E as ee,C as L,e as F,g as O,h as H,a as z,L as $,I,B as b,i as Te,j as Pe,k as Ws,l as Zs,T as ie,u as Ks,m as Xs,n as Js,s as Qs,o as ea,t as xe,p as pe,R as sa,q as aa,r as ta,v as W,w as ra,x as na}from"./partnerApi-C2kaexa2.js";import{C as K}from"./check--JfdwnBW.js";const ia=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],la=A("calendar",ia);const oa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ca=A("circle-alert",oa);const da=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ua=A("circle-check",da);const ma=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],xa=A("file-up",ma);const pa=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],ha=A("file",pa);const fa=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ga=A("grip-vertical",fa);const va=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],ja=A("list-ordered",va);const Na=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ya=A("package",Na);const ba=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],wa=A("rotate-ccw",ba);const Ca=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ee=A("save",Ca);const ka=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],$e=A("search",ka);const Sa=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_a=A("square-check-big",Sa);const Da=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Aa=A("square",Da);const Ta=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ie=A("upload",Ta);const Pa=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],re=A("users",Pa);var se="Tabs",[Ea]=je(se,[ye]),Re=ye(),[$a,le]=Ea(se),Me=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,onValueChange:n,defaultValue:d,orientation:l="horizontal",dir:u,activationMode:o="automatic",...f}=s,g=Is(u),[h,m]=Ts({prop:i,onChange:n,defaultProp:d??"",caller:se});return e.jsx($a,{scope:t,baseId:Rs(),value:h,onValueChange:m,orientation:l,dir:g,activationMode:o,children:e.jsx(Q.div,{dir:g,"data-orientation":l,...f,ref:a})})});Me.displayName=se;var Le="TabsList",Fe=r.forwardRef((s,a)=>{const{__scopeTabs:t,loop:i=!0,...n}=s,d=le(Le,t),l=Re(t);return e.jsx(Ms,{asChild:!0,...l,orientation:d.orientation,dir:d.dir,loop:i,children:e.jsx(Q.div,{role:"tablist","aria-orientation":d.orientation,...n,ref:a})})});Fe.displayName=Le;var Oe="TabsTrigger",ze=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,disabled:n=!1,...d}=s,l=le(Oe,t),u=Re(t),o=Ue(l.baseId,i),f=qe(l.baseId,i),g=i===l.value;return e.jsx(Ls,{asChild:!0,...u,focusable:!n,active:g,children:e.jsx(Q.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":f,"data-state":g?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:o,...d,ref:a,onMouseDown:Z(s.onMouseDown,h=>{!n&&h.button===0&&h.ctrlKey===!1?l.onValueChange(i):h.preventDefault()}),onKeyDown:Z(s.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&l.onValueChange(i)}),onFocus:Z(s.onFocus,()=>{const h=l.activationMode!=="manual";!g&&!n&&h&&l.onValueChange(i)})})})});ze.displayName=Oe;var Ve="TabsContent",Ge=r.forwardRef((s,a)=>{const{__scopeTabs:t,value:i,forceMount:n,children:d,...l}=s,u=le(Ve,t),o=Ue(u.baseId,i),f=qe(u.baseId,i),g=i===u.value,h=r.useRef(g);return r.useEffect(()=>{const m=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(m)},[]),e.jsx(Ps,{present:n||g,children:({present:m})=>e.jsx(Q.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":o,hidden:!m,id:f,tabIndex:0,...l,ref:a,style:{...s.style,animationDuration:h.current?"0s":void 0},children:m&&d})})});Ge.displayName=Ve;function Ue(s,a){return`${s}-trigger-${a}`}function qe(s,a){return`${s}-content-${a}`}var Ia=Me,Be=Fe,He=ze,Ye=Ge;const Ra=Ia,We=r.forwardRef(({className:s,...a},t)=>e.jsx(Be,{ref:t,className:T("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a}));We.displayName=Be.displayName;const G=r.forwardRef(({className:s,...a},t)=>e.jsx(He,{ref:t,className:T("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...a}));G.displayName=He.displayName;const U=r.forwardRef(({className:s,...a},t)=>e.jsx(Ye,{ref:t,className:T("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));U.displayName=Ye.displayName;const X=r.forwardRef(({className:s,checked:a,onCheckedChange:t,...i},n)=>e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",ref:n,checked:a,onChange:d=>t?.(d.target.checked),className:"sr-only peer",...i}),e.jsx("div",{className:T("h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 peer-checked:bg-primary peer-checked:text-primary-foreground flex items-center justify-center",s),children:a&&e.jsx(K,{className:"h-3 w-3"})})]}));X.displayName="Checkbox";function ae({message:s="Loading...",variant:a="page",count:t=4}){return a==="inline"?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),e.jsx("span",{className:"text-sm",children:s})]}):a==="cards"?e.jsx("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4 animate-fade-in",children:Array.from({length:t}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsx(E,{className:"h-4 w-1/2"}),e.jsx(E,{className:"h-8 w-3/4"})]},n))}):a==="list"?e.jsx("div",{className:"space-y-3 animate-fade-in",children:Array.from({length:t}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 flex items-center gap-4",children:[e.jsx(E,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(E,{className:"h-4 w-1/3"}),e.jsx(E,{className:"h-3 w-1/2"})]}),e.jsx(E,{className:"h-8 w-16"})]},n))}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{className:"h-8 w-48"}),e.jsx(E,{className:"h-4 w-64"})]}),e.jsx("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((i,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-3",children:[e.jsx(E,{className:"h-4 w-1/2"}),e.jsx(E,{className:"h-8 w-3/4"})]},n))}),e.jsx("div",{className:"rounded-lg border bg-card p-4",children:e.jsx(E,{className:"h-64 w-full"})})]})}var Ma=Symbol("radix.slottable");function La(s){const a=({children:t})=>e.jsx(e.Fragment,{children:t});return a.displayName=`${s}.Slottable`,a.__radixId=Ma,a}var Ze="AlertDialog",[Fa]=je(Ze,[be]),R=be(),Ke=s=>{const{__scopeAlertDialog:a,...t}=s,i=R(a);return e.jsx(Fs,{...i,...t,modal:!0})};Ke.displayName=Ze;var Oa="AlertDialogTrigger",Xe=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=R(t);return e.jsx(Os,{...n,...i,ref:a})});Xe.displayName=Oa;var za="AlertDialogPortal",Je=s=>{const{__scopeAlertDialog:a,...t}=s,i=R(a);return e.jsx(zs,{...i,...t})};Je.displayName=za;var Va="AlertDialogOverlay",Qe=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=R(t);return e.jsx(Bs,{...n,...i,ref:a})});Qe.displayName=Va;var q="AlertDialogContent",[Ga,Ua]=Fa(q),qa=La("AlertDialogContent"),es=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,children:i,...n}=s,d=R(t),l=r.useRef(null),u=Ne(a,l),o=r.useRef(null);return e.jsx(Vs,{contentName:q,titleName:ss,docsSlug:"alert-dialog",children:e.jsx(Ga,{scope:t,cancelRef:o,children:e.jsxs(Gs,{role:"alertdialog",...d,...n,ref:u,onOpenAutoFocus:Z(n.onOpenAutoFocus,f=>{f.preventDefault(),o.current?.focus({preventScroll:!0})}),onPointerDownOutside:f=>f.preventDefault(),onInteractOutside:f=>f.preventDefault(),children:[e.jsx(qa,{children:i}),e.jsx(Ha,{contentRef:l})]})})})});es.displayName=q;var ss="AlertDialogTitle",as=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=R(t);return e.jsx(Us,{...n,...i,ref:a})});as.displayName=ss;var ts="AlertDialogDescription",rs=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=R(t);return e.jsx(qs,{...n,...i,ref:a})});rs.displayName=ts;var Ba="AlertDialogAction",ns=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,n=R(t);return e.jsx(we,{...n,...i,ref:a})});ns.displayName=Ba;var is="AlertDialogCancel",ls=r.forwardRef((s,a)=>{const{__scopeAlertDialog:t,...i}=s,{cancelRef:n}=Ua(is,t),d=R(t),l=Ne(a,n);return e.jsx(we,{...d,...i,ref:l})});ls.displayName=is;var Ha=({contentRef:s})=>{const a=`\`${q}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${q}\` by passing a \`${ts}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${q}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,s]),null},Ya=Ke,Wa=Xe,Za=Je,os=Qe,cs=es,ds=ns,us=ls,ms=as,xs=rs;const Ka=Ya,Xa=Wa,Ja=Za,ps=r.forwardRef(({className:s,...a},t)=>e.jsx(os,{className:T("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));ps.displayName=os.displayName;const hs=r.forwardRef(({className:s,...a},t)=>e.jsxs(Ja,{children:[e.jsx(ps,{}),e.jsx(cs,{ref:t,className:T("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));hs.displayName=cs.displayName;const fs=({className:s,...a})=>e.jsx("div",{className:T("flex flex-col space-y-2 text-center sm:text-left",s),...a});fs.displayName="AlertDialogHeader";const gs=({className:s,...a})=>e.jsx("div",{className:T("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});gs.displayName="AlertDialogFooter";const vs=r.forwardRef(({className:s,...a},t)=>e.jsx(ms,{ref:t,className:T("text-lg font-semibold",s),...a}));vs.displayName=ms.displayName;const js=r.forwardRef(({className:s,...a},t)=>e.jsx(xs,{ref:t,className:T("text-sm text-muted-foreground",s),...a}));js.displayName=xs.displayName;const Ns=r.forwardRef(({className:s,...a},t)=>e.jsx(ds,{ref:t,className:T(Ae(),s),...a}));Ns.displayName=ds.displayName;const ys=r.forwardRef(({className:s,...a},t)=>e.jsx(us,{ref:t,className:T(Ae({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));ys.displayName=us.displayName;function Qa(){const[s,a]=r.useState([]),[t,i]=r.useState([]),[n,d]=r.useState(!0),[l,u]=r.useState(null),[o,f]=r.useState(""),[g,h]=r.useState(new Set),[m,N]=r.useState(!1),[j,w]=r.useState(""),{toast:v}=B(),y=async()=>{d(!0),u(null);try{const[p,k]=await Promise.all([Te(),Pe()]);a(p),i(k)}catch(p){u(p instanceof Error?p.message:"Failed to load data")}finally{d(!1)}};r.useEffect(()=>{y()},[]);const x=p=>{h(k=>{const S=new Set(k);return S.has(p)?S.delete(p):S.add(p),S})},C=async()=>{if(!o.trim()){v({variant:"destructive",title:"Error",description:"Please enter a group name"});return}const p=Array.from(g);if(p.length<2){v({variant:"destructive",title:"Error",description:`Select at least 2 products (currently ${p.length} selected)`});return}N(!0);try{await Ws(o.trim(),p),v({title:"Success",description:`Group "${o}" created with ${p.length} products`}),f(""),h(new Set),await y()}catch(k){v({variant:"destructive",title:"Error",description:k instanceof Error?k.message:"Failed to create group"})}finally{N(!1)}},P=s.filter(p=>p.group_id===null).filter(p=>p.product_name.toLowerCase().includes(j.toLowerCase())||p.label&&p.label.toLowerCase().includes(j.toLowerCase())||p.product_id.toLowerCase().includes(j.toLowerCase()));return n?e.jsx(ae,{message:"Loading products and groups..."}):l?e.jsx(ee,{message:l,onRetry:y}):e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(L,{className:"h-fit",children:[e.jsxs(F,{className:"pb-3",children:[e.jsxs(O,{className:"text-lg flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Create New Group"]}),e.jsx(H,{children:"Select at least 2 ungrouped products to create a group"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"groupName",children:"Group Name"}),e.jsx(I,{id:"groupName",value:o,onChange:p=>f(p.target.value),placeholder:"Enter group name..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{children:["Select Products (",g.size," selected)"]}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search products...",value:j,onChange:p=>w(p.target.value),className:"pl-9"})]}),e.jsx("div",{className:"max-h-[250px] overflow-auto rounded-md border p-2 space-y-1",children:P.length>0?P.map(p=>{const k=`grp-cb-${p.id}`,S=g.has(p.product_id);return e.jsxs("div",{className:`flex items-center space-x-3 rounded-md p-2 cursor-pointer transition-colors ${S?"bg-primary/10":"hover:bg-accent/50"}`,onClick:()=>x(p.product_id),children:[e.jsx(X,{id:k,checked:S,onCheckedChange:()=>x(p.product_id)}),e.jsxs("label",{htmlFor:k,className:"flex-1 cursor-pointer text-sm",children:[e.jsx("span",{className:"font-medium",children:p.label||p.product_name}),p.lever&&e.jsxs("span",{className:"ml-2 text-muted-foreground text-xs",children:["(",p.lever,")"]})]})]},p.id)}):e.jsx("p",{className:"py-4 text-center text-muted-foreground text-sm",children:j?"No products found":"All products are already grouped"})})]}),e.jsxs(b,{onClick:C,disabled:m||g.size<2||!o.trim(),className:"w-full",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),m?"Creating...":`Create Group (${g.size} products)`]})]})]}),e.jsxs(L,{className:"h-fit",children:[e.jsx(F,{className:"pb-3",children:e.jsxs(O,{className:"text-lg flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Existing Groups (",t.length,")"]})}),e.jsx(z,{children:t.length>0?e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto",children:t.map(p=>{const k=s.filter(S=>S.group_id===p.id);return e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3 hover:bg-accent/30 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:p.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[k.length," product",k.length!==1?"s":""]}),k.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:k.map(S=>S.label||S.product_name).join(", ")})]}),e.jsxs(Ka,{children:[e.jsx(Xa,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon",className:"ml-2 shrink-0",children:e.jsx(ne,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(hs,{children:[e.jsxs(fs,{children:[e.jsx(vs,{children:"Delete Group"}),e.jsxs(js,{children:['Are you sure you want to delete "',p.name,'"? Products in this group will become ungrouped.']})]}),e.jsxs(gs,{children:[e.jsx(ys,{children:"Cancel"}),e.jsx(Ns,{onClick:async()=>{try{v({title:"Info",description:"Delete functionality coming soon"})}catch{v({variant:"destructive",title:"Error",description:"Failed to delete group"})}},children:"Delete"})]})]})]})]},p.id)})}):e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(re,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No groups created yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select products on the left to create your first group"})]})})]})]})}function et(s,a=[]){let t=[];function i(d,l){const u=r.createContext(l);u.displayName=d+"Context";const o=t.length;t=[...t,l];const f=h=>{const{scope:m,children:N,...j}=h,w=m?.[s]?.[o]||u,v=r.useMemo(()=>j,Object.values(j));return e.jsx(w.Provider,{value:v,children:N})};f.displayName=d+"Provider";function g(h,m){const N=m?.[s]?.[o]||u,j=r.useContext(N);if(j)return j;if(l!==void 0)return l;throw new Error(`\`${h}\` must be used within \`${d}\``)}return[f,g]}const n=()=>{const d=t.map(l=>r.createContext(l));return function(u){const o=u?.[s]||d;return r.useMemo(()=>({[`__scope${s}`]:{...u,[s]:o}}),[u,o])}};return n.scopeName=s,[i,st(n,...a)]}function st(...s){const a=s[0];if(s.length===1)return a;const t=()=>{const i=s.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(d){const l=i.reduce((u,{useScope:o,scopeName:f})=>{const h=o(d)[`__scope${f}`];return{...u,...h}},{});return r.useMemo(()=>({[`__scope${a.scopeName}`]:l}),[l])}};return t.scopeName=a.scopeName,t}var at=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bs=at.reduce((s,a)=>{const t=Zs(`Primitive.${a}`),i=r.forwardRef((n,d)=>{const{asChild:l,...u}=n,o=l?t:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(o,{...u,ref:d})});return i.displayName=`Primitive.${a}`,{...s,[a]:i}},{}),oe="Progress",ce=100,[tt]=et(oe),[rt,nt]=tt(oe),ws=r.forwardRef((s,a)=>{const{__scopeProgress:t,value:i=null,max:n,getValueLabel:d=it,...l}=s;(n||n===0)&&!he(n)&&console.error(lt(`${n}`,"Progress"));const u=he(n)?n:ce;i!==null&&!fe(i,u)&&console.error(ot(`${i}`,"Progress"));const o=fe(i,u)?i:null,f=J(o)?d(o,u):void 0;return e.jsx(rt,{scope:t,value:o,max:u,children:e.jsx(bs.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":J(o)?o:void 0,"aria-valuetext":f,role:"progressbar","data-state":Ss(o,u),"data-value":o??void 0,"data-max":u,...l,ref:a})})});ws.displayName=oe;var Cs="ProgressIndicator",ks=r.forwardRef((s,a)=>{const{__scopeProgress:t,...i}=s,n=nt(Cs,t);return e.jsx(bs.div,{"data-state":Ss(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...i,ref:a})});ks.displayName=Cs;function it(s,a){return`${Math.round(s/a*100)}%`}function Ss(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function J(s){return typeof s=="number"}function he(s){return J(s)&&!isNaN(s)&&s>0}function fe(s,a){return J(s)&&!isNaN(s)&&s<=a&&s>=0}function lt(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ce}\`.`}function ot(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ce} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var _s=ws,ct=ks;const Ds=r.forwardRef(({className:s,value:a,...t},i)=>e.jsx(_s,{ref:i,className:T("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:e.jsx(ct,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));Ds.displayName=_s.displayName;function dt(){const[s,a]=r.useState(null),[t,i]=r.useState(!1),[n,d]=r.useState(0),[l,u]=r.useState(null),o=r.useRef(null),{toast:f}=B(),g=N=>{const j=N.target.files?.[0];if(j){const w=[".csv",".zip"],v=j.name.toLowerCase().slice(j.name.lastIndexOf("."));if(!w.includes(v)){f({variant:"destructive",title:"Invalid file type",description:"Please upload a CSV or ZIP file"});return}a(j),u(null),d(0)}},h=async()=>{if(s){i(!0),u(null),d(0);try{const N=await Ks(s,j=>{d(j)});u(N),f({title:"Upload Complete",description:`Rows ${N.rows_read}, inserted ${N.transactions_inserted}, discovered ${N.products_discovered}`})}catch(N){f({variant:"destructive",title:"Upload Failed",description:N instanceof Error?N.message:"Failed to upload file"})}finally{i(!1)}}},m=()=>{a(null),u(null),d(0),o.current&&(o.current.value="")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Upload Transactions"}),e.jsx(H,{children:"Upload CSV or ZIP files containing transaction data"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("input",{type:"file",ref:o,onChange:g,accept:".csv,.zip",className:"hidden"}),s?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ha,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(s.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:m,disabled:t,children:"Remove"}),e.jsxs(b,{size:"sm",onClick:h,disabled:t,children:[e.jsx(xa,{className:"mr-2 h-4 w-4"}),t?"Uploading...":"Upload"]})]})]}),t&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Uploading..."}),e.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),e.jsx(Ds,{value:n,className:"h-2"}),n===100&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Processing file on server..."})]})]}):e.jsxs("div",{onClick:()=>o.current?.click(),className:"flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-border p-12 transition-colors hover:border-primary/50 hover:bg-accent/50",children:[e.jsx(Ie,{className:"h-10 w-10 text-muted-foreground"}),e.jsx("p",{className:"mt-4 font-medium",children:"Click to upload"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"CSV or ZIP files (max 50MB)"})]})]})]}),l&&e.jsxs(L,{children:[e.jsx(F,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[l.transactions_skipped>0?e.jsx(ie,{className:"h-5 w-5 text-warning"}):e.jsx(ua,{className:"h-5 w-5 text-primary"}),"Upload Result"]})}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Processed"}),e.jsx("p",{className:"text-2xl font-bold",children:l.rows_read})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Products Discovered"}),e.jsx("p",{className:"text-2xl font-bold",children:l.products_discovered})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inserted"}),e.jsx("p",{className:"text-2xl font-bold",children:l.transactions_inserted})]}),e.jsxs("div",{className:"rounded-lg bg-accent/50 p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Untracked"}),e.jsx("p",{className:"text-2xl font-bold",children:l.transactions_untracked})]})]})})]})]})}function ge(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(s)}function ut(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(!1),[l,u]=r.useState(null),{toast:o}=B(),[f,g]=r.useState(new Date().getFullYear().toString()),[h,m]=r.useState(""),[N,j]=r.useState(""),w=async()=>{i(!0),u(null);try{const x=await Xs();a(Array.isArray(x)?x:[])}catch(x){u(x instanceof Error?x.message:"Failed to load initial cash data")}finally{i(!1)}};r.useEffect(()=>{w()},[]);const v=async()=>{const x=parseInt(f,10),C=parseFloat(h);if(isNaN(x)||x<2e3||x>2100){o({variant:"destructive",title:"Invalid year"});return}if(isNaN(C)){o({variant:"destructive",title:"Invalid amount"});return}d(!0);try{await Qs(x,C,N||void 0),o({title:"Saved",description:`Initial cash for ${x} set to ${ge(C)}`}),m(""),j(""),w()}catch(M){o({variant:"destructive",title:"Error",description:M instanceof Error?M.message:"Failed to save"})}finally{d(!1)}},y=async x=>{if(confirm(`Delete initial cash for ${x}?`))try{await Js(x),o({title:"Deleted",description:`Initial cash for ${x} removed`}),w()}catch(C){o({variant:"destructive",title:"Error",description:C instanceof Error?C.message:"Failed to delete"})}};return t?e.jsx(ae,{message:"Loading balance settings..."}):l?e.jsx(ee,{message:l,onRetry:w}):e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Initial Cash (Caixa Inicial)"}),e.jsx(H,{children:"Define the starting cash balance for each year. This is added to the first month's revenue in Balance calculations."})]}),e.jsxs(z,{className:"space-y-6",children:[s.length>0&&e.jsx("div",{className:"rounded-lg border divide-y",children:s.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:x.year}),e.jsx("span",{className:"ml-4 text-lg font-mono",children:ge(x.amount)}),x.note&&e.jsxs("span",{className:"ml-4 text-sm text-muted-foreground",children:["(",x.note,")"]})]}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>y(x.year),children:e.jsx(ne,{className:"h-4 w-4 text-destructive"})})]},x.year))}),s.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground py-4 text-center",children:"No initial cash defined yet. Add one below."}),e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Add or Update Initial Cash"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx($,{htmlFor:"ic-year",children:"Year"}),e.jsx(I,{id:"ic-year",type:"number",min:"2000",max:"2100",value:f,onChange:x=>g(x.target.value)})]}),e.jsxs("div",{children:[e.jsx($,{htmlFor:"ic-amount",children:"Amount ($)"}),e.jsx(I,{id:"ic-amount",type:"number",step:"0.01",placeholder:"0.00",value:h,onChange:x=>m(x.target.value)})]}),e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx($,{htmlFor:"ic-note",children:"Note (optional)"}),e.jsx(I,{id:"ic-note",placeholder:"e.g. Carried from 2025",value:N,onChange:x=>j(x.target.value)})]}),e.jsx("div",{children:e.jsxs(b,{onClick:v,disabled:n,className:"w-full",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),n?"Saving...":"Save"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"If a year already exists, it will be updated with the new value."})]})]})]})})}const mt=Es("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ve({className:s,variant:a,...t}){return e.jsx("div",{className:T(mt({variant:a}),s),...t})}function xt(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(null),[l,u]=r.useState(""),[o,f]=r.useState(new Set),[g,h]=r.useState(new Set),[m,N]=r.useState(!1),[j,w]=r.useState(null),[v,y]=r.useState(""),{toast:x}=B(),C=async()=>{i(!0),d(null);try{const c=await ea();a(c),h(new Set)}catch(c){d(c instanceof Error?c.message:"Failed to load products")}finally{i(!1)}};r.useEffect(()=>{C()},[]);const M=async c=>{f(_=>new Set(_).add(c.product_id));try{c.is_tracked?(await pe(c.product_id),x({title:"Success",description:`"${c.product_name}" is no longer tracked`})):(await xe(c.product_id),x({title:"Success",description:`"${c.product_name}" is now being tracked`})),await C()}catch(_){x({variant:"destructive",title:"Error",description:_ instanceof Error?_.message:"Failed to update tracking"})}finally{f(_=>{const D=new Set(_);return D.delete(c.product_id),D})}},P=c=>{h(_=>{const D=new Set(_);return D.has(c)?D.delete(c):D.add(c),D})},p=r.useMemo(()=>s.filter(c=>c.product_name.toLowerCase().includes(l.toLowerCase())||c.lever&&c.lever.toLowerCase().includes(l.toLowerCase())||c.product_id.toLowerCase().includes(l.toLowerCase())),[s,l]),k=()=>{h(new Set(p.map(c=>c.product_id)))},S=()=>{h(new Set)},de=async c=>{if(g.size===0)return;N(!0);const _=s.filter(Y=>g.has(Y.product_id));let D=0,V=0;for(const Y of _){if(Y.is_tracked===c){D++;continue}try{c?await xe(Y.product_id):await pe(Y.product_id),D++}catch{V++}}x({title:V>0?"Partial Success":"Success",description:`${D} product${D!==1?"s":""} ${c?"tracked":"untracked"}${V>0?`, ${V} failed`:""}`,variant:V>0?"destructive":"default"}),await C(),N(!1)},ue=s.filter(c=>c.is_tracked).length,As=s.length-ue;return t?e.jsx(ae,{message:"Loading products..."}):n?e.jsx(ee,{message:n,onRetry:C}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(F,{className:"pb-3",children:[e.jsx(O,{children:"Product Tracking"}),e.jsx(H,{children:"Manage which products are tracked in reports and analytics. Products are automatically discovered when you upload CSV files."})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"font-medium",children:[ue," Tracked"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"font-medium",children:[As," Not Tracked"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ca,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium",children:[s.length," Total"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($e,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search by product name, lever, or ID...",value:l,onChange:c=>u(c.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:k,disabled:m,className:"whitespace-nowrap",children:[e.jsx(_a,{className:"h-4 w-4 mr-1"}),"Select All"]}),g.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:S,disabled:m,children:[e.jsx(Aa,{className:"h-4 w-4 mr-1"}),"Clear"]}),e.jsxs(b,{variant:"default",size:"sm",onClick:()=>de(!0),disabled:m,className:"whitespace-nowrap",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Track (",g.size,")"]}),e.jsxs(b,{variant:"secondary",size:"sm",onClick:()=>de(!1),disabled:m,className:"whitespace-nowrap",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Untrack (",g.size,")"]})]})]})]}),e.jsx("div",{className:"max-h-[calc(100vh-350px)] min-h-[200px] overflow-auto rounded-md border scrollbar-thin",children:p.length>0?e.jsx("div",{className:"divide-y",children:p.map(c=>{const _=o.has(c.product_id),D=g.has(c.product_id),V=`prod-sel-${c.id}`;return e.jsxs("div",{className:`flex items-center gap-3 p-3 transition-colors ${D?"bg-primary/5":"hover:bg-accent/50"}`,children:[e.jsx(X,{id:V,checked:D,onCheckedChange:()=>P(c.product_id),disabled:m}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(X,{id:`track-${c.id}`,checked:c.is_tracked,disabled:_||m,onCheckedChange:()=>M(c)})}),e.jsxs("div",{className:"flex-1 cursor-pointer min-w-0",onClick:()=>P(c.product_id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:c.product_name}),c.is_tracked?e.jsx(ve,{variant:"default",className:"text-xs bg-green-600 shrink-0",children:"Tracked"}):e.jsx(ve,{variant:"secondary",className:"text-xs shrink-0",children:"Not Tracked"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Lever:"})," ",c.lever||"N/A"]}),e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",c.product_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Last seen:"})," ",new Date(c.last_seen_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(b,{size:"sm",variant:"ghost",disabled:_||m,onClick:()=>{w(c),y(c.product_name)},title:"Edit label",children:e.jsx(Hs,{className:"h-3 w-3"})}),e.jsx(b,{size:"sm",variant:c.is_tracked?"outline":"default",disabled:_||m,onClick:()=>M(c),children:_?"...":c.is_tracked?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"Stop"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Track"]})})]})]},c.id)})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:l?"No products found matching search":"No products discovered yet. Upload a CSV to discover products."})})})]})]}),e.jsx(Ce,{open:!!j,onOpenChange:c=>!c&&w(null),children:e.jsxs(ke,{children:[e.jsx(Se,{children:e.jsx(_e,{children:"Edit Product Label"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Original Name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j?.product_name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"edit-label",children:"Display Label"}),e.jsx(I,{id:"edit-label",value:v,onChange:c=>y(c.target.value),placeholder:"Enter custom label..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This label will be shown in reports and dashboards instead of the original name."})]})]}),e.jsxs(De,{children:[e.jsx(b,{variant:"outline",onClick:()=>w(null),children:"Cancel"}),e.jsx(b,{onClick:async()=>{j&&(x({title:"Info",description:j.is_tracked?"Label editing will be available after tracking the product.":"Track this product first to set a custom label."}),w(null))},children:"Save Label"})]})]})})]})}function pt(){const[s,a]=r.useState([]),[t,i]=r.useState(!0),[n,d]=r.useState(!1),[l,u]=r.useState(null),[o,f]=r.useState(null),{toast:g}=B(),h=async()=>{i(!0),u(null);try{const[v,y,x]=await Promise.all([aa(),Te(),Pe()]);if(v.value&&v.value.length>0)a(v.value);else{const C=x.map(P=>P.name),M=y.filter(P=>!P.group_id).map(P=>P.label||P.product_name);a([...C,...M])}}catch(v){u(v instanceof Error?v.message:"Failed to load sort order")}finally{i(!1)}};r.useEffect(()=>{h()},[]);const m=v=>{f(v)},N=(v,y)=>{if(v.preventDefault(),o===null||o===y)return;const x=[...s],[C]=x.splice(o,1);x.splice(y,0,C),a(x),f(y)},j=()=>{f(null)},w=async()=>{d(!0);try{await ta(s),g({title:"Success",description:"Sort order saved"})}catch(v){g({variant:"destructive",title:"Error",description:v instanceof Error?v.message:"Failed to save sort order"})}finally{d(!1)}};return t?e.jsx(ae,{message:"Loading sort order..."}):l?e.jsx(ee,{message:l,onRetry:h}):e.jsxs(L,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"Sort Order"}),e.jsx(H,{children:"Drag items to reorder how they appear in reports"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border divide-y",children:s.map((v,y)=>e.jsxs("div",{draggable:!0,onDragStart:()=>m(y),onDragOver:x=>N(x,y),onDragEnd:j,className:`flex items-center gap-3 p-3 cursor-move transition-colors ${o===y?"bg-accent":"hover:bg-accent/50"}`,children:[e.jsx(ga,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-sm text-muted-foreground w-6",children:y+1}),e.jsx("span",{className:"flex-1 font-medium",children:v})]},`${v}-${y}`))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:w,disabled:n,children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),n?"Saving...":"Save Order"]}),e.jsxs(b,{variant:"outline",onClick:h,children:[e.jsx(sa,{className:"mr-2 h-4 w-4"}),"Reset"]})]})]})]})}function ht({open:s,onOpenChange:a,title:t,description:i,children:n,footer:d}){return e.jsx(Ce,{open:s,onOpenChange:a,children:e.jsxs(ke,{className:"sm:max-w-[500px]",children:[e.jsxs(Se,{children:[e.jsx(_e,{children:t}),i&&e.jsx(Ys,{children:i})]}),e.jsx("div",{className:"py-4",children:n}),d&&e.jsx(De,{children:d})]})})}function ft(){const[s,a]=r.useState(null),[t,i]=r.useState(""),[n,d]=r.useState(""),[l,u]=r.useState(!1),{toast:o}=B(),f=[{id:"clear_transactions",title:"Clear All Transactions",description:"Delete ALL transaction records from the database. This cannot be undone.",confirmText:"DELETE",action:async()=>{await W("transactions")}},{id:"clear_transactions_by_date",title:"Clear Transactions by Date",description:"Delete all transactions from a specific date onwards. Useful for re-importing data.",confirmText:"DELETE",requiresDate:!0,action:async()=>{if(!n)throw new Error("Date is required");await ra(n)}},{id:"clear_products",title:"Clear All Products",description:"Delete all discovered products from the database. You will need to re-import CSVs to discover them again.",confirmText:"DELETE",action:async()=>{await W("products"),await W("all_products")}},{id:"clear_groups",title:"Clear All Groups",description:"Delete all product groups. Products will be ungrouped but remain in the system.",confirmText:"DELETE",action:async()=>{await W("product_groups")}},{id:"reset_all",title:"Reset Entire Database",description:"Delete ALL data: transactions, products, groups, balance data, and import history. Complete factory reset.",confirmText:"RESET",action:async()=>{await na()}}],g=async()=>{if(s){if(t!==s.confirmText){o({variant:"destructive",title:"Confirmation failed",description:`Please type "${s.confirmText}" to confirm`});return}if(s.requiresDate&&!n){o({variant:"destructive",title:"Date required",description:"Please select a date"});return}u(!0);try{await s.action(),o({title:"Success",description:`${s.title} completed`}),h()}catch(m){o({variant:"destructive",title:"Error",description:m instanceof Error?m.message:"Action failed"})}finally{u(!1)}}},h=()=>{a(null),i(""),d("")};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{className:"border-destructive/30",children:[e.jsxs(F,{children:[e.jsxs(O,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ie,{className:"h-5 w-5"}),"Danger Zone"]}),e.jsx(H,{children:"Irreversible actions that affect your data. Use with extreme caution."})]}),e.jsx(z,{className:"space-y-4",children:f.map(m=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-destructive/20 bg-destructive/5 p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description})]}),e.jsxs(b,{variant:"destructive",size:"sm",onClick:()=>a(m),children:[m.id==="reset_all"?e.jsx(wa,{className:"mr-2 h-4 w-4"}):m.requiresDate?e.jsx(la,{className:"mr-2 h-4 w-4"}):e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Execute"]})]},m.id))})]}),e.jsx(ht,{open:!!s,onOpenChange:m=>!m&&h(),title:`Confirm: ${s?.title}`,description:"This action cannot be undone. Please read carefully.",footer:e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:h,disabled:l,children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:g,disabled:l||t!==s?.confirmText||s?.requiresDate&&!n,children:l?"Executing...":"Confirm"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg bg-destructive/10 p-4",children:e.jsxs("p",{className:"text-sm text-destructive",children:[e.jsx("strong",{children:"Warning:"})," ",s?.description]})}),s?.requiresDate&&e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:"date-input",children:"Delete transactions from this date onwards"}),e.jsx(I,{id:"date-input",type:"date",value:n,onChange:m=>d(m.target.value),className:"font-mono"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"confirm",children:["Type ",e.jsx("strong",{children:s?.confirmText})," to confirm"]}),e.jsx(I,{id:"confirm",value:t,onChange:m=>i(m.target.value),placeholder:s?.confirmText,className:"font-mono"})]})]})})]})}function yt(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage groups, upload data, and configure settings"})]}),e.jsxs(Ra,{defaultValue:"groups",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(We,{className:"inline-flex w-auto min-w-full sm:grid sm:w-full sm:max-w-[900px] sm:grid-cols-6",children:[e.jsxs(G,{value:"groups",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(re,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Groups"})]}),e.jsxs(G,{value:"products",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(ya,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Products"})]}),e.jsxs(G,{value:"upload",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(Ie,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload"})]}),e.jsxs(G,{value:"balance",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx($s,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Balance"})]}),e.jsxs(G,{value:"sort",className:"flex items-center gap-2 px-3 sm:px-4",children:[e.jsx(ja,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Sort"})]}),e.jsxs(G,{value:"danger",className:"flex items-center gap-2 px-3 sm:px-4 text-destructive data-[state=active]:text-destructive",children:[e.jsx(ie,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Danger"})]})]})}),e.jsx(U,{value:"groups",className:"mt-6",children:e.jsx(Qa,{})}),e.jsx(U,{value:"products",className:"mt-6",children:e.jsx(xt,{})}),e.jsx(U,{value:"upload",className:"mt-6",children:e.jsx(dt,{})}),e.jsx(U,{value:"balance",className:"mt-6",children:e.jsx(ut,{})}),e.jsx(U,{value:"sort",className:"mt-6",children:e.jsx(pt,{})}),e.jsx(U,{value:"danger",className:"mt-6",children:e.jsx(ft,{})})]})]})}export{yt as default};

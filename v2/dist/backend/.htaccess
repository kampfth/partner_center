# Backend Security
RewriteEngine On

# Only allow access to index.php
<FilesMatch "^(?!index\.php$).*\.php$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect .env files
<FilesMatch "^\.env">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect src directory from direct access
<IfModule mod_rewrite.c>
    RewriteRule ^src/ - [F,L]
    RewriteRule ^var/ - [F,L]
    RewriteRule ^tests/ - [F,L]
</IfModule>

# Disable directory listing
Options -Indexes
